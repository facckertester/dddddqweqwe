var je=Object.defineProperty,we=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var le=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable;var ae=(t,o,l)=>o in t?je(t,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[o]=l,O=(t,o)=>{for(var l in o||(o={}))Ce.call(o,l)&&ae(t,l,o[l]);if(le)for(var l of le(o))Se.call(o,l)&&ae(t,l,o[l]);return t},H=(t,o)=>we(t,ke(o));var $=(t,o,l)=>new Promise((c,i)=>{var r=y=>{try{n(l.next(y))}catch(a){i(a)}},u=y=>{try{n(l.throw(y))}catch(a){i(a)}},n=y=>y.done?c(y.value):Promise.resolve(y.value).then(r,u);n((l=l.apply(t,o)).next())});import{r as T,j as e,R as Z}from"./vendor-react-CUeQczFW.js";import{t as s,f as w,T as Re,C as de,B as K,W as Ne,A as Te,P as oe,a as te,N as Be,b as We,M as ce,c as Ae,d as ze,e as xe,i as ee,j as pe}from"./core-BR814W9x.js";import{a as Q}from"./components-ui-BCK3Jg1B.js";import{A as Ee}from"./components-achievements-grga0VIe.js";import{i as Fe,g as Me,s as V,d as q,a as X,q as he,c as ge,o as me,l as fe,b as be}from"./vendor-firebase-IMiYFFvY.js";import{a as G}from"./vendor-DdgGw12P.js";const re=({currentBet:t,maxGold:o,onBetChange:l,numberFormat:c})=>{const[i,r]=T.useState(t===0?"":t.toString());T.useEffect(()=>{var g,h;t===0&&((g=document.activeElement)==null?void 0:g.tagName)!=="INPUT"?r(""):Math.abs(parseFloat(i)-t)>1e-4&&((h=document.activeElement)==null?void 0:h.tagName)!=="INPUT"&&r(t>1e9?t.toExponential(2).replace("+",""):t.toString())},[t]);const u=g=>{try{if(g.trim()===""){l(0),r("");return}let h=parseFloat(g);const d=g.toLowerCase().trim(),v={k:1e3,m:1e6,b:1e9,t:1e12,qa:1e15,qi:1e18,sx:1e21,sp:1e24,oc:1e27,no:1e30,dc:1e33,ud:1e36,dd:1e39,td:1e42,qd:1e45,qn:1e48};for(const k of Object.keys(v))if(d.endsWith(k)){const m=parseFloat(d.slice(0,-k.length));isNaN(m)||(h=m*v[k]);break}(isNaN(h)||h<0)&&(h=0);const p=o.toNumber();isFinite(p)&&h>p?h=p:!isFinite(p)&&s(h).gt(o)&&(h=Number.MAX_VALUE),l(h),h===0?r(""):h>=1e6?r(h.toExponential(2).replace("+","")):r(Math.floor(h).toString())}catch(h){r(t===0?"":t.toString())}},n=()=>{u(i)},y=g=>{g.key==="Enter"&&(u(i),g.target.blur())},a=g=>{let d=o.times(g).floor().toNumber();isFinite(d)||(d=Number.MAX_VALUE),d<1&&o.gt(0)&&(d=1),l(d),d>=1e6?r(d.toExponential(2).replace("+","")):r(d.toString())};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",width:"100%"},children:[e.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[e.jsx("span",{style:{position:"absolute",left:"10px",pointerEvents:"none",fontSize:"1.2rem"},children:"üí∞"}),e.jsx("input",{type:"text",value:i,onChange:g=>r(g.target.value),onBlur:n,onKeyDown:y,style:{width:"100%",padding:"10px 30px 10px 35px",fontSize:"1.1rem",border:"2px solid var(--border-color)",borderRadius:"4px",fontFamily:"monospace",background:"#fff",color:"#000",outline:"none",fontWeight:"bold"},placeholder:"Wager (100, 1k, 2.5m, 1b, 2e13)..."}),t>0&&e.jsx("button",{onClick:()=>{l(0),r("")},style:{position:"absolute",right:"5px",top:"50%",transform:"translateY(-50%)",background:"transparent",border:"none",color:"#999",fontSize:"1.2rem",cursor:"pointer",padding:"0 5px"},title:"Clear",children:"‚úï"})]}),e.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"space-between"},children:[e.jsx("button",{className:"btn",style:{padding:"4px 8px",fontSize:"0.7rem",flex:1,background:"rgba(0,0,0,0.1)",color:"var(--text-color)",border:"1px solid var(--border-color)"},onClick:()=>a(.1),children:"10%"}),e.jsx("button",{className:"btn",style:{padding:"4px 8px",fontSize:"0.7rem",flex:1,background:"rgba(0,0,0,0.1)",color:"var(--text-color)",border:"1px solid var(--border-color)"},onClick:()=>a(.5),children:"50%"}),e.jsx("button",{className:"btn",style:{padding:"4px 8px",fontSize:"0.7rem",flex:1,background:"var(--gold-color)",color:"#000",border:"1px solid #b8860b"},onClick:()=>a(1),children:"MAX"}),e.jsx("div",{style:{width:"4px"}}),e.jsx("button",{className:"btn",style:{padding:"4px 8px",fontSize:"0.7rem",flex:1,background:"rgba(0,0,0,0.1)",color:"var(--text-color)",border:"1px solid var(--border-color)"},onClick:()=>u(Math.floor(t/2).toString()),children:"¬Ω"}),e.jsx("button",{className:"btn",style:{padding:"4px 8px",fontSize:"0.7rem",flex:1,background:"rgba(0,0,0,0.1)",color:"var(--text-color)",border:"1px solid var(--border-color)"},onClick:()=>u((t*2).toString()),children:"x2"})]})]})},Le=["Shadowfax","Roach","Bucephalus","Pegasus","Sleipnir","Epona","Agro","Artax","Rapidash","Spirit","Bullseye","Maximus","Khan","Buckbeak","Chestnut","Midnight","Storm","Blaze","Comet","Dakota"],Ie=["#d32f2f","#1976d2","#388e3c","#fbc02d","#8e24aa","#ef6c00"],Pe=50,De=({gameState:t,onGamble:o,onLeave:l})=>{const[c,i]=T.useState([]),[r,u]=T.useState(null),[n,y]=T.useState(0),[a,g]=T.useState("betting"),[h,d]=T.useState(""),[v,p]=T.useState(null),k=T.useRef(null),m=T.useRef([]);T.useEffect(()=>{C()},[]);const C=()=>{const f=[],A=[...Le].sort(()=>.5-Math.random());for(let R=0;R<6;R++){const F=Math.random()*5+5,x=Math.random()*5+5;let z=25-(F+x);z=z+(Math.random()*4-2),z<1.5&&(z=1.5),z>20&&(z=20),f.push({id:R,name:A[R],color:Ie[R],icon:"üêé",odds:parseFloat(z.toFixed(1)),progress:0,finished:!1,rank:0,speedRating:F,staminaRating:x})}i(f),u(null),p(null),m.current=[],d("Select a horse and place your bet!")},S=()=>{if(r===null){d("Select a horse first!");return}if(n<=0){d("Place a valid bet!");return}if(t.gold.lt(s(n))){d("Not enough gold!");return}g("racing"),d("And they're off!");let f=0;const A=400;k.current=setInterval(()=>{f++,i(R=>R.map(x=>{if(x.finished)return x;const B=Math.random()<.05?1:0,z=Math.random()<.05?-.5:0,I=.15,D=x.speedRating/10*.15,b=Math.random()*.2;let W=I+D+b+B+z,j=x.progress+W;return j>=100&&(j=100,!m.current.includes(x.id))?(m.current.push(x.id),H(O({},x),{progress:100,finished:!0,rank:m.current.length})):H(O({},x),{progress:j})}).slice(0,6)),(m.current.length===6||f>=A)&&(m.current.length<6&&i(R=>(R.filter(x=>!x.finished).sort((x,B)=>B.progress-x.progress).forEach(x=>{m.current.includes(x.id)||m.current.push(x.id)}),R.map(x=>{const B=m.current.indexOf(x.id);return B!==-1?H(O({},x),{rank:B+1,finished:!0,progress:100}):x}))),E())},Pe)},E=()=>{k.current&&clearInterval(k.current);const f=c.map(x=>{const B=m.current.indexOf(x.id);return B!==-1?H(O({},x),{rank:B+1,finished:!0}):x});i(f);const A=m.current[0],R=f.find(x=>x.id===A);if(!R)return;if(g("finished"),A===r){const x=f.find(I=>I.id===r),B=(x==null?void 0:x.odds)||1,z=Math.max(1,Math.floor(n*(B-1)));o(z,!0),p({won:!0,amount:z,winnerName:R.name})}else o(n,!1),p({won:!1,amount:n,winnerName:R.name})};T.useEffect(()=>()=>{k.current&&clearInterval(k.current)},[]);const N=()=>{g("betting"),y(0),C()};return v&&(v.won,v.won,v.won,v.won,v.won,v.winnerName,v.won?(e.Fragment,w(s(v.amount),t.numberFormat)):(e.Fragment,w(s(v.amount),t.numberFormat))),e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"5px",textAlign:"center",background:"#e0cda9",borderBottom:"1px solid #5d4037",color:"#5d4037",fontWeight:"bold"},children:h}),e.jsxs("div",{style:{flex:1,background:"#e0cda9",padding:"10px 0",overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"space-between",position:"relative"},children:[e.jsx("div",{style:{position:"absolute",right:"40px",top:0,bottom:0,width:"10px",background:"repeating-linear-gradient(45deg, #000, #000 10px, #fff 10px, #fff 20px)",zIndex:0,borderLeft:"2px solid rgba(0,0,0,0.2)",borderRight:"2px solid rgba(0,0,0,0.2)",height:"100%"}}),c.map(f=>e.jsxs("div",{onClick:()=>a==="betting"&&u(f.id),style:{position:"relative",flex:1,minHeight:"30px",borderBottom:"1px dashed rgba(93, 64, 55, 0.3)",display:"flex",alignItems:"center",cursor:a==="betting"?"pointer":"default",background:r===f.id?"rgba(255, 215, 0, 0.3)":"rgba(255,255,255,0.1)",transition:"background 0.2s"},children:[e.jsxs("div",{style:{width:"100px",padding:"0 10px",borderRight:"1px solid var(--border-color)",display:"flex",flexDirection:"column",justifyContent:"center",zIndex:2,background:"var(--panel-bg)",height:"100%"},children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.8rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"var(--text-color)"},children:f.name}),e.jsxs("div",{style:{fontSize:"0.9rem",color:r===f.id?"var(--accent-color)":"var(--text-secondary)",fontWeight:"bold"},children:[f.odds.toFixed(1),"x"]})]}),e.jsx("div",{style:{position:"absolute",left:`calc(100px + ${f.progress}% - ${f.progress*.8}px)`,transition:a==="racing"?"left 0.05s linear":"left 0.3s ease",fontSize:"2rem",zIndex:1,transform:"scaleX(-1) translateY(-5px)",filter:r===f.id?"drop-shadow(0 0 5px gold)":"drop-shadow(0 2px 2px rgba(0,0,0,0.3))",color:f.color},children:e.jsx("div",{style:{fontSize:"2rem"},children:f.icon})}),f.finished&&e.jsx("div",{style:{position:"absolute",right:"10px",fontWeight:"bold",fontSize:"1.2rem",zIndex:5,color:"#000",textShadow:"0 0 2px rgba(0,0,0,0.3)"},children:f.rank===1?"ü•á":f.rank===2?"ü•à":f.rank===3?"ü•â":f.rank?`#${f.rank}`:"?"})]},f.id))]}),e.jsxs("div",{style:{padding:"15px 20px",background:"var(--panel-bg)",borderTop:"2px solid var(--border-color)",flexShrink:0,display:"flex",flexDirection:"row",gap:"15px",alignItems:"flex-end"},children:[e.jsx("div",{style:{flex:1},children:e.jsx(re,{currentBet:n,maxGold:t.gold,onBetChange:y,numberFormat:t.numberFormat})}),e.jsxs("div",{style:{flexShrink:0},children:[a==="betting"&&e.jsx("button",{className:"btn",onClick:S,disabled:r===null||n<=0,style:{opacity:r===null||n<=0?.5:1,fontSize:"1.2rem",padding:"0 30px",height:"60px",background:"var(--accent-color)",boxShadow:"0 4px 0 rgba(0,0,0,0.2)",fontWeight:"bold"},children:"START"}),a==="finished"&&e.jsx("button",{className:"btn",onClick:N,style:{fontSize:"1.2rem",padding:"0 30px",height:"60px",background:"var(--accent-color)",boxShadow:"0 4px 0 rgba(0,0,0,0.2)",fontWeight:"bold"},children:"RACE AGAIN"}),a==="racing"&&e.jsx("div",{style:{width:"100%",height:"60px"}})]})]}),e.jsxs("div",{style:{padding:"10px 20px",background:"var(--panel-bg)",borderTop:"1px solid var(--border-color)",textAlign:"center",fontSize:"1rem",fontWeight:"bold"},children:[e.jsx("span",{style:{marginRight:"10px",color:"var(--text-secondary)"},children:"Result:"}),v?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{marginRight:"10px"},children:v.won?"üèá":"üê¢"}),e.jsx("span",{style:{color:v.won?"#4caf50":"#f44336",marginRight:"10px"},children:v.won?"Winner!":"Better luck next time"}),e.jsxs("span",{style:{color:"var(--accent-color)",marginRight:"10px"},children:["Winner: ",v.winnerName]}),e.jsxs("span",{style:{color:v.won?"gold":"#ef5350"},children:[v.won?"+":"-",w(s(v.amount),t.numberFormat)," Gold"]})]}):e.jsx("span",{style:{color:"var(--text-secondary)",fontStyle:"italic"},children:"No results yet"})]})]})},Ge=({gameState:t,onGamble:o,onLeave:l})=>{const[c,i]=T.useState(0),[r,u]=T.useState(null),[n,y]=T.useState(!1),[a,g]=T.useState(0),[h,d]=T.useState(null),[v,p]=T.useState("Select a side and place your wager.");h&&(h.won,h.won,h.won,h.won,h.won,h.side,h.won?(e.Fragment,w(s(h.amount),t.numberFormat)):(e.Fragment,w(s(h.amount),t.numberFormat)));const k=()=>{if(!r){p("Please select Heads or Tails!");return}if(c<=0){p("Please enter a valid bet amount.");return}if(t.gold.lt(s(c))){p("Not enough gold!");return}y(!0),p("");const m=Math.random()>.5,C=Math.random()<.65,S=C?r==="heads"?"tails":"heads":m?"heads":"tails",E=!C,N=a,A=360*5;let R=N+A;const F=R%360;S==="heads"?R+=360-F:R+=180-F+360,g(R),setTimeout(()=>{y(!1),E?(o(c,!0),p("Victory!")):(o(c,!1),p("Defeat!")),setTimeout(()=>{d({won:E,amount:c,side:S})},500)},3e3)};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[e.jsx("style",{children:`
            .coin-container {
                perspective: 1000px;
                width: 180px;
                height: 180px;
                margin: 0 auto;
            }
            .coin {
                width: 100%;
                height: 100%;
                position: relative;
                transform-style: preserve-3d;
                transition: transform 3s cubic-bezier(0.1, 0.7, 0.1, 1);
            }
            .coin-face {
                position: absolute;
                width: 100%;
                height: 100%;
                backface-visibility: hidden;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 5rem;
                box-shadow: inset 0 0 30px rgba(0,0,0,0.5), 0 10px 20px rgba(0,0,0,0.3);
                border: 10px solid #b8860b;
            }
            .coin-front {
                background: radial-gradient(#ffd700, #daa520);
                color: #5d4037;
                transform: rotateY(0deg);
            }
            .coin-back {
                background: radial-gradient(#e6c200, #b8860b);
                color: #5d4037;
                transform: rotateY(180deg);
            }
            .coin-text {
                font-family: 'Cinzel', serif;
                font-weight: bold;
                text-shadow: 2px 2px 0 rgba(255,255,255,0.4);
            }
        `}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative",background:"var(--bg-color)",overflow:"hidden"},children:[e.jsx("div",{className:"coin-container",children:e.jsxs("div",{className:"coin",style:{transform:`rotateY(${a}deg)`},children:[e.jsx("div",{className:"coin-face coin-front",children:e.jsx("span",{className:"coin-text",children:"üëë"})}),e.jsx("div",{className:"coin-face coin-back",children:e.jsx("span",{className:"coin-text",children:"1"})})]})}),e.jsx("div",{style:{fontSize:"1.4rem",fontWeight:"bold",marginTop:"20px",minHeight:"30px",color:"var(--accent-color)",textAlign:"center",padding:"0 20px"},children:v}),e.jsxs("div",{style:{display:"flex",gap:"20px",marginTop:"20px"},children:[e.jsxs("button",{onClick:()=>u("heads"),disabled:n,style:{padding:"10px 20px",border:`3px solid ${r==="heads"?"var(--gold-color)":"transparent"}`,background:r==="heads"?"rgba(255, 215, 0, 0.2)":"var(--bg-color)",color:"var(--text-color)",borderRadius:"8px",cursor:n?"not-allowed":"pointer",transition:"all 0.2s",display:"flex",flexDirection:"column",alignItems:"center",minWidth:"100px",transform:n?"none":"scale(1)",boxShadow:n?"none":"0 4px 8px rgba(0,0,0,0.15)",opacity:n?.6:1},onMouseEnter:m=>{!n&&r!=="heads"&&(m.currentTarget.style.transform="scale(1.1)",m.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.3)",m.currentTarget.style.border="3px solid var(--accent-color)",m.currentTarget.style.background="rgba(33, 150, 243, 0.2)")},onMouseLeave:m=>{!n&&r!=="heads"&&(m.currentTarget.style.transform="scale(1)",m.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)",m.currentTarget.style.border="3px solid transparent",m.currentTarget.style.background="var(--bg-color)")},children:[e.jsx("div",{style:{fontSize:"1.5rem"},children:"üëë"}),e.jsx("div",{style:{fontWeight:"bold"},children:"Heads"})]}),e.jsxs("button",{onClick:()=>u("tails"),disabled:n,style:{padding:"10px 20px",border:`3px solid ${r==="tails"?"var(--gold-color)":"transparent"}`,background:r==="tails"?"rgba(255, 215, 0, 0.2)":"var(--bg-color)",color:"var(--text-color)",borderRadius:"8px",cursor:n?"not-allowed":"pointer",transition:"all 0.2s",display:"flex",flexDirection:"column",alignItems:"center",minWidth:"100px",transform:n?"none":"scale(1)",boxShadow:n?"none":"0 4px 8px rgba(0,0,0,0.15)",opacity:n?.6:1},onMouseEnter:m=>{!n&&r!=="tails"&&(m.currentTarget.style.transform="scale(1.1)",m.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.3)",m.currentTarget.style.border="3px solid var(--accent-color)",m.currentTarget.style.background="rgba(33, 150, 243, 0.2)")},onMouseLeave:m=>{!n&&r!=="tails"&&(m.currentTarget.style.transform="scale(1)",m.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)",m.currentTarget.style.border="3px solid transparent",m.currentTarget.style.background="var(--bg-color)")},children:[e.jsx("div",{style:{fontSize:"1.5rem"},children:"1"}),e.jsx("div",{style:{fontWeight:"bold"},children:"Tails"})]})]})]}),e.jsxs("div",{style:{padding:"15px 20px",background:"var(--panel-bg)",borderTop:"2px solid var(--border-color)",flexShrink:0,display:"flex",flexDirection:"row",gap:"15px",alignItems:"flex-end"},children:[e.jsx("div",{style:{flex:1},children:e.jsx(re,{currentBet:c,maxGold:t.gold,onBetChange:i,numberFormat:t.numberFormat})}),e.jsx("button",{className:"btn",onClick:k,disabled:!r||c<=0||n,style:{opacity:!r||c<=0||n?.5:1,fontSize:"1.2rem",padding:"0 30px",height:"60px",background:"var(--accent-color)",boxShadow:"0 4px 0 rgba(0,0,0,0.2)",flexShrink:0,fontWeight:"bold"},children:"FLIP"})]}),e.jsxs("div",{style:{padding:"10px 20px",background:"var(--panel-bg)",borderTop:"1px solid var(--border-color)",textAlign:"center",fontSize:"1rem",fontWeight:"bold"},children:[e.jsx("span",{style:{marginRight:"10px",color:"var(--text-secondary)"},children:"Result:"}),h?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{marginRight:"10px"},children:h.won?"‚ú®":"üí∏"}),e.jsx("span",{style:{color:h.won?"#4caf50":"#f44336",marginRight:"10px"},children:h.won?"Victory!":"Defeat!"}),e.jsxs("span",{style:{color:"var(--accent-color)",marginRight:"10px"},children:["Result: ",h.side]}),e.jsxs("span",{style:{color:h.won?"gold":"#ef5350"},children:[h.won?"+":"-",w(s(h.amount),t.numberFormat)," Gold"]})]}):e.jsx("span",{style:{color:"var(--text-secondary)",fontStyle:"italic"},children:"No results yet"})]})]})},ue=({value:t,size:o=80,color:l="#3e2723"})=>{const c=o*.18,i=o*.25,r=o*.5,u=o*.75,n=[];return(t===1||t===3||t===5)&&n.push({cx:r,cy:r}),t>1&&(n.push({cx:i,cy:i}),n.push({cx:u,cy:u})),t>3&&(n.push({cx:u,cy:i}),n.push({cx:i,cy:u})),t===6&&(n.push({cx:i,cy:r}),n.push({cx:u,cy:r})),e.jsx("div",{style:{width:o,height:o,backgroundColor:"#fff",borderRadius:o*.15,boxShadow:"0 4px 8px rgba(0,0,0,0.2), inset 0 -4px 4px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #ccc"},children:e.jsx("svg",{width:o,height:o,viewBox:`0 0 ${o} ${o}`,children:n.map((y,a)=>e.jsx("circle",{cx:y.cx,cy:y.cy,r:c/2,fill:l},a))})})},Oe=({gameState:t,onGamble:o,onLeave:l})=>{const[c,i]=T.useState(0),[r,u]=T.useState(!1),[n,y]=T.useState([1,1]),[a,g]=T.useState(null),[h,d]=T.useState("Place your wager and roll!"),v=()=>{if(c<=0){d("Please enter a valid bet amount.");return}if(t.gold.lt(s(c))){d("Not enough gold!");return}u(!0),d("Rolling..."),g(null);let k=0;const m=10,C=setInterval(()=>{y([Math.floor(Math.random()*6)+1,Math.floor(Math.random()*6)+1]),k++,k>=m&&(clearInterval(C),p())},100)},p=()=>{const k=Math.floor(Math.random()*6)+1,m=Math.floor(Math.random()*6)+1,C=k+m;y([k,m]),u(!1);let S=0,E=!1,N="";if(C===2?(S=10,E=!0,N="Snake Eyes! JACKPOT (x10)!"):C===3?(S=2,E=!0,N="Low Triple! (x2)"):C>=4&&C<=9?(S=0,E=!1,N="House wins..."):C>=10&&C<=11?(S=1.5,E=!0,N="Good roll! (x1.5)"):C===12&&(S=5,E=!0,N="Boxcars! Nice Win (x5)!"),E){const f=Math.max(1,Math.floor(c*(S-1)));o(f,!0),d(N),g({won:!0,amount:f,sum:C})}else o(c,!1),d(N),g({won:!1,amount:c,sum:C})};return a&&(a.won,a.won,a.won,a.won,a.won,a.sum,a.won?(e.Fragment,w(s(a.amount),t.numberFormat)):(e.Fragment,w(s(a.amount),t.numberFormat))),e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-evenly",alignItems:"center",background:"var(--bg-color)",overflow:"hidden",padding:"10px"},children:[e.jsxs("div",{style:{background:"var(--panel-bg)",padding:"10px",borderRadius:"8px",fontSize:"0.8rem",border:"1px solid var(--border-color)",width:"100%",maxWidth:"400px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[e.jsx("span",{style:{color:"var(--text-color)"},children:"Sum 2 (Snake Eyes)"}),e.jsx("span",{style:{color:"var(--gold-color)",fontWeight:"bold"},children:"x10"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[e.jsx("span",{style:{color:"var(--text-color)"},children:"Sum 3"}),e.jsx("span",{style:{color:"var(--success-color)",fontWeight:"bold"},children:"x2"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[e.jsx("span",{style:{color:"var(--text-color)"},children:"Sum 10-11"}),e.jsx("span",{style:{color:"var(--success-color)",fontWeight:"bold"},children:"x1.5"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-color)"},children:"Sum 12 (Boxcars)"}),e.jsx("span",{style:{color:"var(--gold-color)",fontWeight:"bold"},children:"x5"})]}),e.jsx("div",{style:{textAlign:"center",color:"var(--danger-color)",marginTop:"15px",fontSize:"0.9rem",fontWeight:"bold"},children:"Sum 4-9: House Wins"})]}),e.jsxs("div",{style:{display:"flex",gap:"30px",transform:"scale(1.2)"},children:[e.jsx(ue,{value:n[0],size:100}),e.jsx(ue,{value:n[1],size:100})]}),e.jsx("div",{style:{fontSize:"1.8rem",fontWeight:"bold",minHeight:"40px",color:"var(--accent-color)"},children:r?"":`Sum: ${n[0]+n[1]}`}),e.jsx("div",{style:{fontSize:"1rem",minHeight:"20px",color:"var(--text-color)"},children:h})]}),e.jsxs("div",{style:{padding:"15px 20px",background:"var(--panel-bg)",borderTop:"2px solid var(--border-color)",flexShrink:0,display:"flex",flexDirection:"row",gap:"15px",alignItems:"flex-end"},children:[e.jsx("div",{style:{flex:1},children:e.jsx(re,{currentBet:c,maxGold:t.gold,onBetChange:i,numberFormat:t.numberFormat})}),e.jsx("button",{className:"btn",onClick:v,disabled:c<=0||r,style:{fontSize:"1.2rem",padding:"0 30px",height:"60px",background:"var(--accent-color)",opacity:c<=0||r?.5:1,boxShadow:"0 4px 0 rgba(0,0,0,0.2)",flexShrink:0,fontWeight:"bold"},children:"ROLL"})]}),e.jsxs("div",{style:{padding:"10px 20px",background:"var(--panel-bg)",borderTop:"1px solid var(--border-color)",textAlign:"center",fontSize:"1rem",fontWeight:"bold"},children:[e.jsx("span",{style:{marginRight:"10px",color:"var(--text-secondary)"},children:"Result:"}),a?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{marginRight:"10px"},children:a.won?"üé≤":"üìâ"}),e.jsx("span",{style:{color:a.won?"#4caf50":"#f44336",marginRight:"10px"},children:a.won?"You Won!":"You Lost"}),e.jsxs("span",{style:{color:"var(--accent-color)",marginRight:"10px"},children:["Rolled: ",a.sum]}),e.jsxs("span",{style:{color:a.won?"gold":"#ef5350"},children:[a.won?"+":"-",w(s(a.amount),t.numberFormat)," Gold"]})]}):e.jsx("span",{style:{color:"var(--text-secondary)",fontStyle:"italic"},children:"No results yet"})]})]})},rt=({gameState:t,onGamble:o,onClose:l})=>{const[c,i]=T.useState("racing");return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{height:"95vh",maxWidth:"1000px",width:"98%",padding:"0",display:"flex",flexDirection:"column",overflow:"hidden",borderRadius:"12px",border:"4px double var(--border-color)"},children:[e.jsxs("div",{style:{padding:"10px 20px",borderBottom:"2px solid var(--border-color)",background:"var(--accent-color)",color:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h2",{style:{borderBottom:"none",margin:0,fontSize:"1.4rem",textShadow:"1px 1px 0 rgba(0,0,0,0.3)"},children:"üç∫ The Rusty Tankard"}),e.jsxs("div",{style:{fontSize:"0.9rem",background:"rgba(0,0,0,0.2)",padding:"4px 10px",borderRadius:"4px"},children:["Gold: ",e.jsx("span",{style:{color:"var(--gold-color)",fontWeight:"bold"},children:w(t.gold,t.numberFormat)})]})]}),e.jsxs("div",{style:{display:"flex",background:"var(--bg-color)",borderBottom:"2px solid var(--border-color)",overflowX:"auto"},children:[e.jsx("button",{onClick:()=>i("racing"),style:{flex:1,minWidth:"90px",padding:"12px 10px",border:"none",background:c==="racing"?"var(--panel-bg)":"transparent",fontWeight:"bold",color:c==="racing"?"var(--accent-color)":"var(--text-secondary)",cursor:"pointer",borderBottom:c==="racing"?"3px solid var(--accent-color)":"3px solid transparent",transition:"all 0.2s"},children:"üèá Racing"}),e.jsx("button",{onClick:()=>i("coin"),style:{flex:1,minWidth:"90px",padding:"12px 10px",border:"none",background:c==="coin"?"var(--panel-bg)":"transparent",fontWeight:"bold",color:c==="coin"?"var(--accent-color)":"var(--text-secondary)",cursor:"pointer",borderBottom:c==="coin"?"3px solid var(--accent-color)":"3px solid transparent",transition:"all 0.2s"},children:"üü° Coin"}),e.jsx("button",{onClick:()=>i("dice"),style:{flex:1,minWidth:"90px",padding:"12px 10px",border:"none",background:c==="dice"?"var(--panel-bg)":"transparent",fontWeight:"bold",color:c==="dice"?"var(--accent-color)":"var(--text-secondary)",cursor:"pointer",borderBottom:c==="dice"?"3px solid var(--accent-color)":"3px solid transparent",transition:"all 0.2s"},children:"üé≤ Dice"})]}),e.jsxs("div",{style:{background:"var(--bg-color)",flex:1,overflow:"hidden",position:"relative",display:"flex",flexDirection:"column"},children:[c==="racing"&&e.jsx(De,{gameState:t,onGamble:(r,u)=>o(r,u),onLeave:l}),c==="coin"&&e.jsx(Ge,{gameState:t,onGamble:(r,u)=>o(r,u),onLeave:l}),c==="dice"&&e.jsx(Oe,{gameState:t,onGamble:(r,u)=>o(r,u),onLeave:l})]}),e.jsx("div",{style:{padding:"8px",borderTop:"2px solid var(--border-color)",background:"var(--panel-bg)",textAlign:"center",flexShrink:0},children:e.jsx("button",{className:"btn",onClick:l,style:{background:"#5d4037",padding:"8px 20px",fontSize:"0.9rem",width:"auto"},children:"Exit Tavern"})})]})})},nt=({gameState:t,onPrestige:o,onClose:l})=>{var C;const i=s(1e12),r=t.totalGold;let u=s(0),n=!1,y=i.minus(r);if(r.gte(i)){const S=r.dividedBy(i);u=s(Math.floor(Math.pow(S.toNumber(),.33))).times(1).minus(t.renown),u.lt(0)&&(u=s(0)),n=u.gt(0)}const a=t.renown.plus(u),g=i.times(Math.pow(Math.floor(a.dividedBy(1).toNumber()+1),1/.33)),h=g.minus(r),v=Q(t.totalRenownEarned).minus(s(1)).times(s(100)),k=Q(t.totalRenownEarned.plus(u)).minus(s(1)).times(s(100)),m=Object.values(t.nationalProjects||{}).some(S=>S==null?void 0:S.active);return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{border:"4px solid #673ab7",maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[e.jsx("h2",{style:{color:"#673ab7"},children:"üëë Abdication"}),e.jsx("p",{children:"Are you ready to pass the crown to your heir?"}),e.jsxs("div",{style:{flex:1,overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:[!((C=t.playerProfile)!=null&&C.hasChosenName)&&e.jsxs("div",{style:{background:"rgba(255, 235, 59, 0.1)",border:"1px solid #ffc107",padding:"10px",borderRadius:"4px",marginBottom:"15px",fontSize:"0.9rem"},children:["üí° ",e.jsx("strong",{children:"Tip:"})," You can abdicate without choosing a ruler name. Choose a name only if you want to appear in the leaderboard."]}),e.jsxs("div",{style:{textAlign:"left",margin:"20px 0",background:"rgba(243, 229, 245, 0.5)",padding:"15px",borderRadius:"4px"},children:[e.jsx("div",{children:e.jsx("strong",{children:"You will lose:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"All Gold & Treasury"}),e.jsx("li",{children:"All Estates (Buildings)"}),e.jsx("li",{children:"Workforce (Laborers & Specialists)"}),e.jsx("li",{children:"Royal Scepter Levels"}),e.jsxs("li",{children:[e.jsx("strong",{children:"Unfinished National Projects"})," (Progress & Resources)"]})]}),e.jsx("div",{children:e.jsx("strong",{children:"You will keep:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"Achievements"}),e.jsxs("li",{children:["Current Renown (",w(t.renown,t.numberFormat),")"]}),e.jsx("li",{children:"Completed National Project Levels"}),e.jsx("li",{children:"Lifetime Stats & Leaderboard Rank"})]})]}),m&&e.jsx("div",{style:{marginBottom:"20px",padding:"10px",background:"rgba(255, 0, 0, 0.1)",border:"1px solid red",borderRadius:"4px",color:"#d32f2f",fontSize:"0.9rem",fontWeight:"bold",textAlign:"center"},children:"‚ö†Ô∏è WARNING: You have a National Project under construction! Abdication will cancel the construction. All progress and resources invested in the pending level will be lost."}),e.jsxs("div",{style:{fontSize:"1.2rem",marginBottom:"20px"},children:[e.jsxs("div",{style:{marginBottom:"5px",fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Current Renown: ",w(t.renown,t.numberFormat)]}),e.jsxs("div",{style:{marginBottom:"5px",fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Total Renown: ",w(t.totalRenownEarned,t.numberFormat)," (+",v.toNumber().toFixed(1),"%)"]}),e.jsx("hr",{style:{margin:"15px 0",borderTop:"1px dashed #ccc",borderBottom:"none"}}),e.jsxs("div",{style:{marginBottom:"5px",fontSize:"0.9rem",color:"var(--text-secondary)"},children:[e.jsx("strong",{children:"Renown Gain:"})," +",w(u,t.numberFormat)]}),e.jsxs("div",{style:{marginBottom:"5px",fontSize:"0.9rem",color:"var(--text-secondary)"},children:[e.jsx("strong",{children:"Total After Prestige:"})," ",w(t.totalRenownEarned.plus(u),t.numberFormat)," (+",k.toNumber().toFixed(1),"% bonus)"]}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"10px",background:"rgba(0,0,0,0.05)",padding:"5px",borderRadius:"4px"},children:[e.jsxs("div",{children:["Next Renown at: ",e.jsx("strong",{children:w(g,t.numberFormat)})," Lifetime Gold"]}),e.jsxs("div",{style:{color:h.gt(0)?"#cc0000":"var(--success-color)",fontWeight:"bold"},children:["(Need ",w(h.gt(0)?h:s(0),t.numberFormat)," more)"]})]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"20px"},children:[e.jsx("button",{className:"btn",style:{background:"#666"},onClick:l,children:"Cancel"}),e.jsx("button",{className:"btn",style:{background:"#673ab7"},onClick:o,disabled:!n,children:n?"Abdicate":r.lt(i)?`Need ${w(y,t.numberFormat)} more Gold`:"Prestige Unavailable"})]})]})})},st=({gameState:t,onClose:o,onHardReset:l,onSave:c,onSetTheme:i,onSetNumberFormat:r,onToggleIdleMode:u,onUpdateInterface:n,onOpenPromoCodes:y,onChangeName:a})=>{var N,f,A,R,F;const[g,h]=Z.useState(!1),d=t.interface||{density:"normal",showFloatingText:!0,showWeatherWidget:!0,reduceMotion:!1,crownAnimations:!0,layout:{left:s(1),center:s(1),right:s(1)}},v=(N=d.layout.left)!=null&&N.toNumber?d.layout.left.toNumber():Number(d.layout.left),p=(f=d.layout.center)!=null&&f.toNumber?d.layout.center.toNumber():Number(d.layout.center),k=(A=d.layout.right)!=null&&A.toNumber?d.layout.right.toNumber():Number(d.layout.right),m=()=>{g?l():h(!0)},C=(x,B)=>{n({layout:H(O({},d.layout),{[x]:s(B)})})},S={marginBottom:"8px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px",background:"rgba(0,0,0,0.03)",borderRadius:"4px"},E={width:"100%",marginBottom:"5px"};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[e.jsx("h2",{children:"‚öôÔ∏è Royal Settings"}),t.playerProfile&&e.jsxs("div",{style:{backgroundColor:"rgba(191, 144, 0, 0.1)",border:"2px solid var(--gold-color)",borderRadius:"4px",padding:"12px",marginBottom:"20px",textAlign:"center"},children:[e.jsxs("div",{style:{color:"var(--gold-color)",fontSize:"16px",fontWeight:"bold"},children:["üëë Your Ruler: ",t.playerProfile.rulerName," ",t.playerProfile.rulerId,t.playerProfile.specialIcon&&e.jsx("span",{style:{marginLeft:"5px"},children:t.playerProfile.specialIcon}),t.playerProfile.specialTitle&&e.jsx("span",{style:{marginLeft:"5px",color:"var(--accent-color)",fontSize:"14px"},children:t.playerProfile.specialTitle})]}),e.jsx("div",{style:{color:"var(--text-secondary)",fontSize:"12px",marginTop:"5px"},children:"Registered in Leaderboard System"})]}),e.jsxs("div",{style:{textAlign:"left",marginBottom:"20px",maxHeight:"60vh",overflowY:"auto",paddingRight:"5px",flex:1,overflowX:"hidden",WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:[e.jsx("h3",{style:{marginBottom:"10px"},children:"Layout Configuration"}),e.jsxs("div",{style:{marginBottom:"15px",background:"rgba(0,0,0,0.03)",padding:"10px",borderRadius:"4px"},children:[e.jsx("div",{style:{fontSize:"0.9rem",marginBottom:"5px",fontWeight:"bold"},children:"Column Widths (Ratio)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr auto",gap:"10px",alignItems:"center",marginBottom:"5px"},children:[e.jsx("span",{style:{fontSize:"0.8rem"},children:"Left"}),e.jsx("input",{type:"range",min:"1",max:"5",step:"0.5",value:v,onChange:x=>C("left",parseFloat(x.target.value)),style:E}),e.jsx("span",{style:{fontSize:"0.8rem"},children:v})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr auto",gap:"10px",alignItems:"center",marginBottom:"5px"},children:[e.jsx("span",{style:{fontSize:"0.8rem"},children:"Center"}),e.jsx("input",{type:"range",min:"1",max:"5",step:"0.5",value:p,onChange:x=>C("center",parseFloat(x.target.value)),style:E}),e.jsx("span",{style:{fontSize:"0.8rem"},children:p})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr auto",gap:"10px",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"0.8rem"},children:"Right"}),e.jsx("input",{type:"range",min:"1",max:"5",step:"0.5",value:k,onChange:x=>C("right",parseFloat(x.target.value)),style:E}),e.jsx("span",{style:{fontSize:"0.8rem"},children:k})]})]}),e.jsx("div",{style:{borderTop:"1px dashed #ccc",margin:"15px 0"}}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("div",{style:{fontSize:"0.9rem",marginBottom:"5px",fontWeight:"bold"},children:"Preset Themes"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"5px",justifyContent:"center"},children:Object.values(Re).map(x=>e.jsx("button",{className:"btn",style:{background:t.theme===x.id?"var(--accent-color)":"var(--panel-bg)",color:t.theme===x.id?"var(--text-on-accent)":"var(--text-color)",border:"1px solid var(--border-color)",fontSize:"0.8rem",padding:"5px 10px",minWidth:"120px",textAlign:"center"},onClick:()=>i(x.id),children:x.name},x.id))})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("div",{style:{fontSize:"0.9rem",marginBottom:"5px",fontWeight:"bold"},children:"Layout Density"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"5px",justifyContent:"center"},children:["compact","normal","spacious"].map(x=>e.jsx("button",{className:"btn",style:{background:d.density===x?"var(--accent-color)":"var(--panel-bg)",color:d.density===x?"var(--text-on-accent)":"var(--text-color)",border:"1px solid var(--border-color)",fontSize:"0.8rem",textTransform:"capitalize",minWidth:"120px",textAlign:"center",padding:"5px 10px"},onClick:()=>n({density:x}),children:x},x))})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("div",{style:{fontSize:"0.9rem",marginBottom:"5px",fontWeight:"bold"},children:"Number Format"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"5px",justifyContent:"center"},children:["standard","scientific","plain"].map(x=>e.jsx("button",{className:"btn",style:{background:t.numberFormat===x?"var(--accent-color)":"var(--panel-bg)",color:t.numberFormat===x?"var(--text-on-accent)":"var(--text-color)",border:"1px solid var(--border-color)",fontSize:"0.8rem",padding:"5px 10px",textTransform:"capitalize",minWidth:"120px",textAlign:"center"},onClick:()=>r(x),children:x},x))})]}),e.jsx("div",{style:{borderTop:"1px dashed #ccc",margin:"15px 0"}}),e.jsxs("div",{style:S,children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem"},children:"Cinematic Idle Mode"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Show landscape when inactive. Wait 30 seconds after enabling."})]}),e.jsx("button",{className:"btn",style:{background:t.idleModeEnabled?"var(--success-color)":"#9e9e9e",minWidth:"60px"},onClick:u,children:t.idleModeEnabled?"ON":"OFF"})]}),e.jsxs("div",{style:S,children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem"},children:"Click Text"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Show floating numbers on click."})]}),e.jsx("button",{className:"btn",style:{background:d.showFloatingText?"var(--success-color)":"#9e9e9e",minWidth:"60px"},onClick:()=>n({showFloatingText:!d.showFloatingText}),children:d.showFloatingText?"ON":"OFF"})]}),e.jsxs("div",{style:S,children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem"},children:"Weather Widget"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Show weather info in top left."})]}),e.jsx("button",{className:"btn",style:{background:d.showWeatherWidget?"var(--success-color)":"#9e9e9e",minWidth:"60px"},onClick:()=>n({showWeatherWidget:!d.showWeatherWidget}),children:d.showWeatherWidget?"ON":"OFF"})]}),e.jsxs("div",{style:S,children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem"},children:"Crown Animations"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Show crown effects and animations."})]}),e.jsx("button",{className:"btn",style:{background:d.crownAnimations?"var(--success-color)":"#9e9e9e",minWidth:"60px"},onClick:()=>n({crownAnimations:!d.crownAnimations}),children:d.crownAnimations?"ON":"OFF"})]}),e.jsxs("div",{style:S,children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem"},children:"Animations"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Enable visual effects and animations."})]}),e.jsx("button",{className:"btn",style:{background:d.reduceMotion?"#9e9e9e":"var(--success-color)",minWidth:"60px"},onClick:()=>n({reduceMotion:!d.reduceMotion}),children:d.reduceMotion?"OFF":"ON"})]})]}),e.jsxs("div",{style:{borderTop:"2px solid #ccc",paddingTop:"15px",marginTop:"15px",flexShrink:0},children:[e.jsx("h3",{children:"System"}),e.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn",onClick:c,children:"Force Save"}),e.jsx("button",{className:"btn",onClick:a,style:{background:"#2e7d32"},disabled:!((R=t.playerProfile)!=null&&R.hasChosenName),title:(F=t.playerProfile)!=null&&F.hasChosenName?"Change your ruler name":"Choose a ruler name first!",children:"Change Name"}),e.jsx("button",{className:"btn",onClick:y,style:{background:"#9c27b0"},children:"Promo Codes"}),e.jsx("button",{className:"btn",style:{backgroundColor:g?"red":"#d32f2f"},onClick:m,children:g?"CONFIRM WIPE?":"Hard Reset"})]}),g&&e.jsx("div",{style:{color:"red",fontSize:"0.8rem",marginTop:"5px"},children:"Warning: This will delete all progress permanently!"})]}),e.jsx("button",{className:"btn",style:{marginTop:"20px",background:"#5d4037",width:"100%",flexShrink:0},onClick:o,children:"Return to Game"}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-secondary)",marginTop:"10px",flexShrink:0},children:"v2.3.0 - Kingdom Clicker"})]})})},it=({onClose:t})=>e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{maxWidth:"600px",maxHeight:"80vh",display:"flex",flexDirection:"column"},children:[e.jsx("h2",{children:"üìú Royal Chronicles"}),e.jsx("div",{style:{overflowY:"auto",textAlign:"left",padding:"0 20px",flex:1},children:de.map((o,l)=>e.jsxs("div",{style:{marginBottom:"20px",borderBottom:l<de.length-1?"1px dashed #ccc":"none",paddingBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[e.jsxs("span",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"var(--accent-color)"},children:["v",o.version]}),e.jsx("span",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:o.date})]}),e.jsx("ul",{style:{margin:"5px 0",paddingLeft:"20px"},children:o.changes.map((c,i)=>e.jsx("li",{style:{marginBottom:"3px"},children:c},i))})]},o.version))}),e.jsx("button",{className:"btn",style:{marginTop:"20px",alignSelf:"center"},onClick:t,children:"Close Chronicles"})]})}),lt=({gameState:t,currentGps:o,onClose:l})=>{var C,S,E;const c=Object.values(t.buildings).reduce((N,f)=>N.plus(f),s(0)),i=t.achievements.length,r=Te.length;let u="None",n="None",y=-1,a=s(0);K.forEach((N,f)=>{const A=t.buildings[N.id]||s(0);A.gt(s(0))&&f>y&&(y=f,u=N.name),A.gt(a)&&(a=A,n=N.name)});const h=(()=>{var D;const N=s(1),f=t.clickUpgradeLevel||0,A=Math.min(f,15),R=s(2).pow(A),F=N.times(R),x=Q(t.totalRenownEarned);let B=F;x.gt(s(1))&&(B=F.times(x));const z=te(f);if(z>0){let b=s(0);K.forEach(L=>{const J=t.buildings[L.id]||s(0);J.gt(0)&&(b=b.plus(J.times(L.baseProduction)))});let W=b;x.gt(s(1))&&(W=b.times(x));let j=0;t.nationalProjects&&Object.values(t.nationalProjects).forEach(L=>j+=L.level||0);const M=s(1).plus(s(j*oe));W=W.times(M);const P=((D=t.weather)==null?void 0:D.current)||"clear";let U=s(0);K.forEach(L=>{const J=t.buildings[L.id]||s(0);if(J.gt(0)){let Y=s(1);P==="sunny"?(L.id==="peasant"||L.id==="field"||L.id==="stable"||L.id==="cathedral")&&(Y=s(1.2)):P==="rainy"?(L.id==="silver_mine"||L.id==="alchemist"||L.id==="market"||L.id==="tavern")&&(Y=s(1.2)):P==="stormy"?((L.id==="blacksmith"||L.id==="void_portal")&&(Y=s(1.3)),(L.id==="field"||L.id==="stable")&&(Y=s(.8))):P==="windy"&&(L.id==="market"||L.id==="castle"||L.id==="time_chamber")&&(Y=s(1.15));const ie=J.times(L.baseProduction);x.gt(s(1))?U=U.plus(ie.times(x).times(M).times(Y.minus(s(1)))):U=U.plus(ie.times(M).times(Y.minus(s(1))))}});const ye=W.plus(U),ve=s(1).plus(s(t.achievements.length*.02)),ne=ye.times(ve);let se=ne;t.globalIncomeMultiplier&&(se=ne.times(s(t.globalIncomeMultiplier))),B=B.plus(se.times(z))}const I=s(1).plus(s(t.achievements.length*.02));return B=B.times(I),t.globalIncomeMultiplier&&(B=B.times(s(t.globalIncomeMultiplier))),B})(),[d,v]=T.useState("");T.useEffect(()=>{const N=()=>{const A=s(Date.now()).minus(t.startTime),R=A.dividedBy(s(1e3)),F=R.minus(R.dividedBy(s(60)).floor().times(s(60))).floor(),x=A.dividedBy(s(6e4)),B=x.minus(x.dividedBy(s(60)).floor().times(s(60))).floor(),z=A.dividedBy(s(36e5)),I=z.minus(z.dividedBy(s(24)).floor().times(s(24))).floor(),D=A.dividedBy(s(864e5)).floor();let b="";D.gt(s(0))&&(b+=`${D.toString()}d `),I.gt(s(0))&&(b+=`${I.toString()}h `),b+=`${B.toString()}m ${F.toString()}s`,v(b)};N();const f=setInterval(N,1e3);return()=>clearInterval(f)},[t.startTime]);const p={display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px dashed rgba(0,0,0,0.1)",fontSize:"0.9rem"},k={fontSize:"1rem",color:"var(--accent-color)",marginTop:"15px",borderBottom:"2px solid var(--border-color)",paddingBottom:"2px",marginBottom:"5px"},m=(C=t.weather)!=null&&C.current&&((S=Ne[t.weather.current])==null?void 0:S.name)||"Unknown";return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{maxWidth:"500px",maxHeight:"90vh",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsx("h2",{style:{flexShrink:0},children:"üìä Royal Records"}),e.jsxs("div",{style:{textAlign:"left",marginBottom:"20px",overflowY:"auto",paddingRight:"10px",flex:1,minHeight:0},children:[e.jsx("h3",{style:k,children:"‚ö° Current Status"}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Gold Per Second:"}),e.jsxs("strong",{style:{color:"var(--success-color)"},children:[w(o,t.numberFormat)," / sec"]})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Click Power:"}),e.jsxs("strong",{style:{color:"var(--success-color)"},children:[w(h,t.numberFormat)," / click"]})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Current Weather:"}),e.jsx("strong",{children:m})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Current Renown:"}),e.jsx("strong",{style:{color:"#673ab7"},children:w(t.renown,t.numberFormat)})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Total Renown Earned:"}),e.jsx("strong",{style:{color:"#9575cd"},children:w(t.totalRenownEarned,t.numberFormat)})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Renown Bonus:"}),e.jsxs("strong",{style:{color:"#9575cd"},children:["+",Q(t.totalRenownEarned).minus(s(1)).times(s(100)).toNumber().toString(),"%"]})]}),e.jsx("h3",{style:k,children:"‚è≥ Time & Legacy"}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Time Played:"}),e.jsx("strong",{children:d})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Kingdom Founded:"}),e.jsx("span",{children:new Date(t.startTime.toNumber()).toLocaleDateString()})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Total Renown:"}),e.jsx("strong",{children:w(t.renown,t.numberFormat)})]}),e.jsx("h3",{style:k,children:"üí∞ Economy Summary"}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Current Gold:"}),e.jsx("strong",{children:w(t.gold,t.numberFormat)})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Lifetime Gold:"}),e.jsx("strong",{children:w(t.totalGold,t.numberFormat)})]}),e.jsx("h3",{style:k,children:"üè∞ Dominion"}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Total Buildings:"}),e.jsx("strong",{children:w(c,t.numberFormat)})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Highest Tech Building:"}),e.jsx("strong",{children:u})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Most Numerous:"}),e.jsxs("strong",{children:[n," (",w(a,t.numberFormat),")"]})]}),e.jsx("h3",{style:k,children:"üìà Player Stats"}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Total Clicks:"}),e.jsx("span",{children:w(t.stats.totalClicks,t.numberFormat)})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Current Prestige Clicks:"}),e.jsx("span",{children:w(t.stats.currentPrestigeClicks,t.numberFormat)})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Dragons Slain:"}),e.jsx("span",{children:w(t.stats.dragonsKilled,t.numberFormat)})]}),((E=t.buildings.tavern)==null?void 0:E.gt(s(0)))&&e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Tavern Games:"}),e.jsx("span",{children:w(t.stats.tavernGamesPlayed,t.numberFormat)})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Buildings Purchased:"}),e.jsx("span",{children:w(t.stats.totalBuildingsPurchased,t.numberFormat)})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Total Gold Spent:"}),e.jsx("span",{children:w(t.stats.totalGoldSpent,t.numberFormat)})]}),t.totalGold.gte(s(1e12))&&e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Times Prestiged:"}),e.jsx("span",{children:t.stats.prestigeCount})]}),(t.stats.clickUpgradeLevel>0||t.stats.offlineUpgradeLevel>0||t.totalGold.gte(s(1e18)))&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{style:k,children:"‚öîÔ∏è Upgrades & Power"}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Royal Scepter Level:"}),e.jsx("span",{children:t.stats.clickUpgradeLevel})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Passive Income Level:"}),e.jsx("span",{children:t.stats.offlineUpgradeLevel})]}),t.totalGold.gte(s(1e18))&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Infinite Tower Level:"}),e.jsx("span",{children:t.stats.infiniteTowerLevel})]}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Dark Matter Gold:"}),e.jsx("span",{style:{color:"#673ab7"},children:w(t.stats.darkMatterGold,t.numberFormat)})]})]})]}),e.jsx("h3",{style:k,children:"üéñÔ∏è Completion"}),e.jsxs("div",{style:p,children:[e.jsx("span",{children:"Achievements:"}),e.jsxs("span",{children:[i," / ",r," (",Math.floor(i/r*100),"%)"]})]}),e.jsx("h3",{style:k,children:"üèÜ Achievements"}),e.jsx(Ee,{gameState:t})]}),e.jsx("button",{className:"btn",style:{background:"#5d4037",width:"100%",flexShrink:0},onClick:l,children:"Close Records"})]})})},He=[0,10,25,50,100,150,200,250,300,350,400,450,500,550,550,600],at=({gameState:t,onStartProject:o,onUpgradeClickPower:l,onUpgradeOffline:c,onClose:i})=>{const[r,u]=T.useState("royalScepter"),n=d=>{var f;const v=s(1),p=Math.min(d,15),k=s(2).pow(p),m=v.times(k),C=Q(t.totalRenownEarned);let S=m;C.gt(s(1))&&(S=m.times(C));const E=te(d);if(E>0){let A=s(0);K.forEach(j=>{const M=t.buildings[j.id]||s(0);M.gt(0)&&(A=A.plus(M.times(j.baseProduction)))});let R=A;C.gt(s(1))&&(R=A.times(C));let F=0;t.nationalProjects&&Object.values(t.nationalProjects).forEach(j=>F+=j.level||0);const x=s(1).plus(s(F*oe));R=R.times(x);const B=((f=t.weather)==null?void 0:f.current)||"clear";let z=s(0);K.forEach(j=>{const M=t.buildings[j.id]||s(0);if(M.gt(0)){let P=s(1);B==="sunny"?(j.id==="peasant"||j.id==="field"||j.id==="stable"||j.id==="cathedral")&&(P=s(1.2)):B==="rainy"?(j.id==="silver_mine"||j.id==="alchemist"||j.id==="market"||j.id==="tavern")&&(P=s(1.2)):B==="stormy"?((j.id==="blacksmith"||j.id==="void_portal")&&(P=s(1.3)),(j.id==="field"||j.id==="stable")&&(P=s(.8))):B==="windy"&&(j.id==="market"||j.id==="castle"||j.id==="time_chamber")&&(P=s(1.15));const U=M.times(j.baseProduction);C.gt(s(1))?z=z.plus(U.times(C).times(x).times(P.minus(s(1)))):z=z.plus(U.times(x).times(P.minus(s(1))))}});const I=R.plus(z),D=s(1).plus(s(t.achievements.length*.02)),b=I.times(D);let W=b;t.globalIncomeMultiplier&&(W=b.times(s(t.globalIncomeMultiplier))),S=S.plus(W.times(E))}const N=s(1).plus(s(t.achievements.length*.02));return S=S.times(N),t.globalIncomeMultiplier&&(S=S.times(s(t.globalIncomeMultiplier))),S};if(!(t.buildings.field||s(0)).gt(0))return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("h2",{children:"üèóÔ∏è National Projects"}),e.jsxs("div",{style:{padding:"20px",color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"10px"},children:"üîí"}),e.jsx("p",{children:"You must establish a functioning economy before launching national projects."}),e.jsx("p",{style:{fontWeight:"bold",color:"var(--accent-color)"},children:"Requirement: Build a Wheat Field."})]}),e.jsx("button",{className:"btn",onClick:i,children:"Close"})]})});const g=()=>e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"15px"},children:Be.map(d=>{var z;const v=t.buildings[d.id]||s(0);if(v.lt(10))return null;const p=t.nationalProjects[d.id]||{level:0,active:!1,startTime:0,endTime:0},k=p.level,m=k>=ce,C=p.active,S=k+1,E=We(d.id,S),N=He[S]||0,f=v.gte(N),A=t.gold.gte(E.gold),R=A&&f;let F=0,x=0;if(C){const I=Date.now(),D=p.endTime-p.startTime,b=I-p.startTime;F=Math.min(100,b/D*100),x=Math.max(0,Math.ceil((p.endTime-I)/1e3))}const B=((z=K.find(I=>I.id===d.id))==null?void 0:z.name)||"Building";return e.jsxs("div",{style:{border:"2px solid var(--border-color)",borderRadius:"8px",background:C?"#fff8e1":"var(--bg-color)",overflow:"hidden",position:"relative"},children:[e.jsxs("div",{style:{padding:"10px",background:C?"var(--accent-color)":"rgba(0,0,0,0.05)",color:C?"#fff":"var(--text-color)",fontWeight:"bold",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:d.name.replace(" Infrastructure","")}),e.jsxs("span",{children:["Lvl ",k," / ",ce]})]}),e.jsxs("div",{style:{padding:"15px"},children:[e.jsx("div",{style:{fontSize:"0.85rem",color:C?"#000000":"var(--text-color)",marginBottom:"10px",fontStyle:"italic"},children:d.description}),e.jsxs("div",{style:{marginBottom:"10px",fontSize:"0.9rem",color:"var(--success-color)",fontWeight:"bold"},children:["Current Bonus: +",(k*oe*100).toFixed(0),"% Global"]}),C?e.jsxs("div",{children:[e.jsx("div",{style:{width:"100%",height:"10px",background:"#ccc",borderRadius:"5px",overflow:"hidden",marginBottom:"5px"},children:e.jsx("div",{style:{width:`${F}%`,height:"100%",background:"var(--success-color)",transition:"width 1s linear"}})}),e.jsxs("div",{style:{textAlign:"center",fontSize:"0.8rem",color:"#3e2723"},children:["Under Construction... ",x,"s remaining"]})]}):m?e.jsx("div",{style:{textAlign:"center",padding:"10px",color:"var(--gold-color)",fontWeight:"bold",border:"1px solid var(--gold-color)",borderRadius:"4px",background:"rgba(255, 215, 0, 0.1)"},children:"MAXIMUM LEVEL REACHED"}):e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.85rem",marginBottom:"10px",background:"rgba(255,255,255,0.5)",padding:"5px",borderRadius:"4px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:"Next Level Requirements:"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"5px"},children:[e.jsxs("span",{style:{color:A?"green":"red"},children:["üí∞ ",w(E.gold)," Gold"]}),e.jsxs("span",{style:{color:f?"green":"red"},children:["üè† ",w(s(N))," ",B,"s"]})]}),e.jsx("div",{style:{marginTop:"5px",fontSize:"0.8rem"},children:"‚è≥ Duration: 5 seconds"})]}),e.jsx("button",{className:"btn",style:{width:"100%",background:R?"var(--accent-color)":"var(--border-color)",cursor:R?"pointer":"not-allowed"},disabled:!R,onClick:()=>o(d.id),children:"Start Project (Units Consumed)"})]})]})]},d.id)})}),h=()=>{const d=t.clickUpgradeLevel||0,v=d>=xe,p=d+1,k=Ae(p),m=t.gold.gte(k),C=s(2).pow(Math.min(d,15)),S=te(d),E=n(d);S>0?`${w(C)}${(S*100).toFixed(1)}`:w(C);const N=s(2).pow(Math.min(p,15)),f=te(p),A=n(p);f>0?`${w(N)}${(f*100).toFixed(1)}`:w(N);const R=t.offlineUpgradeLevel||0,F=R>=ee,x=R+1,B=ze(x),z=t.renown.gte(B),{efficiency:I,duration:D}=pe(R),{efficiency:b,duration:W}=pe(x),j=M=>{const P=Math.floor(M/3600),U=Math.floor(M%3600/60);return P>0?`${P}h ${U}m`:`${U}m`};return e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"15px"},children:[e.jsxs("div",{style:{border:"2px solid var(--border-color)",borderRadius:"8px",background:"var(--bg-color)",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"10px",background:"rgba(0,0,0,0.05)",color:"var(--text-color)",fontWeight:"bold",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"üëë Royal Scepter"}),e.jsxs("span",{children:["Lvl ",d," / ",xe]})]}),e.jsxs("div",{style:{padding:"15px"},children:[e.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginBottom:"10px",fontStyle:"italic"},children:"Enhance your royal authority to increase click power."}),e.jsxs("div",{style:{marginBottom:"10px",fontSize:"0.9rem",color:"var(--success-color)",fontWeight:"bold"},children:["Current Power: ",w(E)]}),v?e.jsx("div",{style:{textAlign:"center",padding:"10px",color:"var(--gold-color)",fontWeight:"bold",border:"1px solid var(--gold-color)",borderRadius:"4px",background:"rgba(255, 215, 0, 0.1)"},children:"MAXIMUM LEVEL REACHED"}):e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.85rem",marginBottom:"10px",background:"rgba(255,255,255,0.5)",padding:"5px",borderRadius:"4px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:"Next Level:"}),e.jsxs("div",{style:{marginBottom:"5px"},children:["Power: ",w(A)]}),e.jsxs("div",{style:{color:m?"green":"red",fontWeight:"bold"},children:["üí∞ ",w(k)," Gold"]})]}),e.jsx("button",{className:"btn",style:{width:"100%",background:m?"var(--accent-color)":"var(--border-color)",cursor:m?"pointer":"not-allowed"},disabled:!m,onClick:l,children:"Upgrade Scepter"})]})]})]}),e.jsxs("div",{style:{border:"2px solid var(--border-color)",borderRadius:"8px",background:"var(--bg-color)",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"10px",background:"rgba(0,0,0,0.05)",color:"var(--text-color)",fontWeight:"bold",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"üí§ Offline Production"}),e.jsxs("span",{children:["Lvl ",R," / ",ee]})]}),e.jsxs("div",{style:{padding:"15px"},children:[e.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginBottom:"10px",fontStyle:"italic"},children:["Improve the efficiency of your kingdom while you are away.",e.jsx("br",{}),"‚è±Ô∏è Higher levels increase both efficiency % and maximum production time."]}),e.jsxs("div",{style:{marginBottom:"10px",fontSize:"0.9rem",color:"var(--success-color)",fontWeight:"bold"},children:["Current: ",(I*100).toFixed(0),"% for ",j(D)]}),!F&&e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("div",{style:{width:"100%",height:"8px",background:"#ccc",borderRadius:"4px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${R/ee*100}%`,height:"100%",background:"var(--success-color)",transition:"width 0.3s ease"}})}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"2px"},children:[ee-R," levels to max"]})]}),F?e.jsx("div",{style:{textAlign:"center",padding:"10px",color:"var(--gold-color)",fontWeight:"bold",border:"1px solid var(--gold-color)",borderRadius:"4px",background:"rgba(255, 215, 0, 0.1)"},children:"MAXIMUM LEVEL REACHED"}):e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.85rem",marginBottom:"10px",background:"rgba(255,255,255,0.5)",padding:"5px",borderRadius:"4px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:"Next Level:"}),e.jsxs("div",{style:{marginBottom:"5px"},children:["Effect: ",(b*100).toFixed(0),"% for ",j(W)]}),e.jsxs("div",{style:{color:z?"#673ab7":"red",fontWeight:"bold"},children:["üëë ",w(B)," Renown"]})]}),e.jsx("button",{className:"btn",style:{width:"100%",background:z?"#673ab7":"var(--border-color)",cursor:z?"pointer":"not-allowed"},disabled:!z,onClick:c,children:"Upgrade Passive Income"})]})]})]})]})};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{maxWidth:"1000px",width:"95%",height:"85vh",display:"flex",flexDirection:"column",padding:"0"},children:[e.jsxs("div",{style:{padding:"20px",background:"var(--accent-color)",color:"var(--text-on-accent)"},children:[e.jsx("h2",{style:{margin:0,border:"none",color:"var(--gold-color)"},children:"üèõÔ∏è National Projects"}),e.jsx("p",{style:{margin:"5px 0 0 0",fontSize:"0.9rem",opacity:.9},children:"Invest resources to permanently improve your kingdom's power. All improvements persist through prestige."})]}),e.jsxs("div",{style:{display:"flex",background:"var(--bg-color)",borderBottom:"2px solid var(--border-color)",padding:"0 20px"},children:[e.jsx("button",{className:"btn",style:{background:r==="infrastructure"?"var(--accent-color)":"transparent",border:"none",borderBottom:r==="infrastructure"?"3px solid var(--gold-color)":"3px solid transparent",borderRadius:"0",padding:"15px 20px",margin:"0",fontWeight:"bold",color:r==="infrastructure"?"var(--text-on-accent)":"var(--text-color)"},onClick:()=>u("infrastructure"),children:"üèóÔ∏è Infrastructure"}),e.jsx("button",{className:"btn",style:{background:r==="royalScepter"?"var(--accent-color)":"transparent",border:"none",borderBottom:r==="royalScepter"?"3px solid var(--gold-color)":"3px solid transparent",borderRadius:"0",padding:"15px 20px",margin:"0",fontWeight:"bold",color:r==="royalScepter"?"var(--text-on-accent)":"var(--text-color)"},onClick:()=>u("royalScepter"),children:"üëë Royal Scepter"})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px",background:"var(--panel-bg)"},children:[r==="infrastructure"&&g(),r==="royalScepter"&&h()]}),e.jsx("div",{style:{padding:"15px",borderTop:"1px solid var(--border-color)",textAlign:"right",background:"var(--bg-color)"},children:e.jsx("button",{className:"btn",onClick:i,children:"Return to Kingdom"})})]})})},Ue={apiKey:"AIzaSyA1Dw5M2Zk8bpTCjlU2Tuifvx0ZI3IeRv0",authDomain:"kingdomclicker-156dc.firebaseapp.com",projectId:"kingdomclicker-156dc",storageBucket:"kingdomclicker-156dc.firebasestorage.app",messagingSenderId:"496461589742",appId:"1:496461589742:web:e6413dfa2d1bbabd3ad7ff"},$e=Fe(Ue),_=Me($e);function _e(){return`#${Math.floor(Math.random()*99999).toString().padStart(5,"0")}`}function Ye(){const t=new Date,o=t.getDay(),l=t.getDate()-o+(o===0?-6:1);return new Date(t.setDate(l))}function dt(t){return $(this,null,function*(){var o,l,c;try{console.log("üöÄ Starting leaderboard submission for:",t.rulerName),console.log("üìä Data to submit:",{rulerName:t.rulerName,rulerId:t.rulerId,gold:(o=t.gold)==null?void 0:o.toString(),renown:(l=t.renown)==null?void 0:l.toString(),achievements:t.achievements,totalClicks:(c=t.totalClicks)==null?void 0:c.toString(),period:t.period});const i=H(O({},t),{period:"alltime"}),r=H(O({},t),{period:"weekly"}),u=q(_,"leaderboard_alltime",t.rulerId),n=H(O({},i),{gold:Number(i.gold.toString()),achievements:Number(i.achievements),renown:Number(i.renown.toString()),totalClicks:i.totalClicks.toString(),timestamp:V()});i.buildings!==void 0&&(n.buildings=Number(i.buildings)),console.log("üì§ Submitting alltime data:",n),yield X(u,n),console.log("‚úÖ Alltime data submitted successfully");const y=q(_,"leaderboard_weekly",t.rulerId),a=H(O({},r),{gold:Number(r.gold.toString()),achievements:Number(r.achievements),renown:Number(r.renown.toString()),totalClicks:r.totalClicks.toString(),timestamp:V()});return r.buildings!==void 0&&(a.buildings=Number(r.buildings)),console.log("üì§ Submitting weekly data:",a),yield X(y,a),console.log("‚úÖ Weekly data submitted successfully"),{allTimeId:t.rulerId,weeklyId:t.rulerId}}catch(i){throw console.error("‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ –ª–∏–¥–µ—Ä–±–æ—Ä–¥:"),console.error("–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:",i),i instanceof Error&&(console.error("–°–æ–æ–±—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏:",i.message),console.error("–°—Ç–µ–∫ –æ—à–∏–±–∫–∏:",i.stack)),"code"in i&&(console.error("–ö–æ–¥ –æ—à–∏–±–∫–∏ Firebase:",i.code),console.error("–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:",i.customData)),i}})}function Ve(t=100){return $(this,null,function*(){try{console.log("üîç –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö all-time –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞...");const o=he(ge(_,"leaderboard_alltime"),me("gold","desc"),fe(t));console.log("üì° –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∫ Firestore...");const l=yield be(o);console.log("üìä –ü–æ–ª—É—á–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:",l.docs.length);const c=l.docs.map(i=>{const r=i.data();return H(O({id:i.id},r),{gold:r.gold instanceof G?r.gold:new G(r.gold),renown:r.renown instanceof G?r.renown:new G(r.renown),totalClicks:r.totalClicks instanceof G?r.totalClicks:typeof r.totalClicks=="string"?new G(r.totalClicks):new G(r.totalClicks),timestamp:r.timestamp})});return console.log("‚úÖ All-time –ª–∏–¥–µ—Ä–±–æ—Ä–¥ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω, –∑–∞–ø–∏—Å–µ–π:",c.length),c}catch(o){throw console.error("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ all-time –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞:"),console.error("–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:",o),o instanceof Error&&(console.error("–°–æ–æ–±—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏:",o.message),console.error("–°—Ç–µ–∫ –æ—à–∏–±–∫–∏:",o.stack)),"code"in o&&console.error("–ö–æ–¥ –æ—à–∏–±–∫–∏ Firebase:",o.code),o}})}function Ke(t=100){return $(this,null,function*(){try{console.log("üîç –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö weekly –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞...");const o=Ye();console.log("üìÖ –ù–∞—á–∞–ª–æ –Ω–µ–¥–µ–ª–∏:",o.toISOString());const l=he(ge(_,"leaderboard_weekly"),me("gold","desc"),fe(t));console.log("üì° –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∫ Firestore...");const c=yield be(l);console.log("üìä –ü–æ–ª—É—á–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:",c.docs.length);const r=c.docs.map(u=>{const n=u.data();return H(O({id:u.id},n),{gold:n.gold instanceof G?n.gold:new G(n.gold),renown:n.renown instanceof G?n.renown:new G(n.renown),totalClicks:n.totalClicks instanceof G?n.totalClicks:typeof n.totalClicks=="string"?new G(n.totalClicks):new G(n.totalClicks),timestamp:n.timestamp})}).filter(u=>{var a,g;const n=((g=(a=u.timestamp)==null?void 0:a.toDate)==null?void 0:g.call(a))||new Date(u.timestamp),y=n>=o;return y||console.log("üóëÔ∏è –ó–∞–ø–∏—Å—å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–∞ (—Å—Ç–∞—Ä–∞—è –¥–∞—Ç–∞):",n.toISOString()),y});return console.log("‚úÖ Weekly –ª–∏–¥–µ—Ä–±–æ—Ä–¥ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω, –∑–∞–ø–∏—Å–µ–π –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:",r.length),r}catch(o){throw console.error("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ weekly –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞:"),console.error("–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:",o),o instanceof Error&&(console.error("–°–æ–æ–±—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏:",o.message),console.error("–°—Ç–µ–∫ –æ—à–∏–±–∫–∏:",o.stack)),"code"in o&&console.error("–ö–æ–¥ –æ—à–∏–±–∫–∏ Firebase:",o.code),o}})}function ct(t,o,l){return $(this,null,function*(){try{const c=`lastStatsSave_${o}`,i=localStorage.getItem(c),r=Date.now(),u=3600*1e3;if(i&&r-parseInt(i)<u)return;let n=0;const y={};Object.keys(t.buildings).forEach(d=>{const v=Number(t.buildings[d].toString());y[d]=v,n+=v});const a=Math.floor((Date.now()-Number(t.startTime.toString()))/1e3),g={rulerId:o,rulerName:l,totalBuildings:y,totalBuildingsPurchased:n,totalGoldSpent:t.totalGoldSpent||new G(0),totalGoldEarned:t.totalGold,totalClicks:t.stats.totalClicks,currentPrestigeClicks:t.stats.currentPrestigeClicks,prestigeCount:t.prestigeCount||0,totalRenownEarned:t.totalRenownEarned,nationalProjects:Object.keys(t.nationalProjects||{}).reduce((d,v)=>(d[v]=t.nationalProjects[v].level||0,d),{}),clickUpgradeLevel:t.clickUpgradeLevel||0,offlineUpgradeLevel:t.offlineUpgradeLevel||0,tavernGamesPlayed:Number(t.stats.tavernGamesPlayed.toString()),dragonsKilled:Number(t.stats.dragonsKilled.toString()),achievements:t.achievements,playTime:a,lastUpdated:V(),createdAt:V()},h=q(_,"playerStats",o);yield X(h,{rulerId:o,rulerName:l,totalBuildings:y,totalBuildingsPurchased:n,totalGoldSpent:g.totalGoldSpent.toString(),totalGoldEarned:g.totalGoldEarned.toString(),totalClicks:g.totalClicks.toString(),currentPrestigeClicks:g.currentPrestigeClicks.toString(),prestigeCount:g.prestigeCount,totalRenownEarned:g.totalRenownEarned.toString(),nationalProjects:g.nationalProjects,clickUpgradeLevel:g.clickUpgradeLevel,offlineUpgradeLevel:g.offlineUpgradeLevel,tavernGamesPlayed:g.tavernGamesPlayed,dragonsKilled:g.dragonsKilled,achievements:g.achievements,playTime:g.playTime,lastUpdated:V(),createdAt:V()}),localStorage.setItem(`lastStatsSave_${o}`,Date.now().toString()),console.log("‚úÖ Player stats successfully saved")}catch(c){throw console.error("‚ùå Error saving player stats:",c),c}})}function xt(t,o){return $(this,null,function*(){try{const l=q(_,"players",t);yield X(l,{rulerName:o},{merge:!0});const c=q(_,"leaderboard_alltime",t);yield X(c,{rulerName:o},{merge:!0});const i=q(_,"leaderboard_weekly",t);yield X(i,{rulerName:o},{merge:!0}),console.log("‚úÖ Ruler name successfully updated")}catch(l){throw console.error("‚ùå Error updating ruler name:",l),l}})}const pt=({isOpen:t,onClose:o,onConfirm:l,gameState:c})=>{const[i,r]=T.useState(""),[u,n]=T.useState(!1);if(!t)return null;const y=()=>$(null,null,function*(){if(i.trim().length<3){alert("Ruler name must contain at least 3 characters!");return}if(i.trim().length>20){alert("Ruler name must not exceed 20 characters!");return}n(!0);try{const g={id:`player_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,rulerName:i.trim(),rulerId:_e(),lastLeaderboardView:0,lastLeaderboardSubmit:0,hasChosenName:!0,usedPromoCodes:[]};l(g),o()}catch(a){alert("An error occurred while creating profile. Please try again.")}finally{n(!1)}});return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{backgroundColor:"#fdf6e3",border:"4px solid #8d6e63",borderRadius:"8px",padding:"32px",maxWidth:"500px",width:"90%",textAlign:"center",fontFamily:"Georgia, serif"},children:[e.jsx("h2",{style:{color:"#3e2723",marginBottom:"16px"},children:"üëë Royal Coronation! üëë"}),e.jsxs("p",{style:{color:"#5d4037",marginBottom:"24px",lineHeight:"1.5"},children:["Congratulations! Your kingdom has reached ",e.jsx("strong",{children:qe(c.gold)})," gold!",e.jsx("br",{}),"It's time to choose a name for your ruler and enter the history books!"]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("label",{style:{display:"block",color:"#3e2723",marginBottom:"8px",fontWeight:"bold"},children:"Ruler Name:"}),e.jsx("input",{type:"text",value:i,onChange:a=>r(a.target.value),placeholder:"Enter your name...",maxLength:20,style:{width:"100%",padding:"12px",border:"2px solid #a1887f",borderRadius:"4px",fontSize:"16px",fontFamily:"Arial, sans-serif",backgroundColor:"#fff",color:"#3e2723"},onKeyPress:a=>a.key==="Enter"&&y()}),e.jsxs("div",{style:{fontSize:"12px",color:"#8d6e63",marginTop:"4px",textAlign:"left"},children:[i.length,"/20 characters"]})]}),e.jsx("div",{style:{backgroundColor:"#fff3e0",border:"2px solid #bf9000",borderRadius:"4px",padding:"12px",marginBottom:"24px"},children:e.jsx("p",{style:{color:"#bf9000",margin:0,fontSize:"14px",fontWeight:"bold"},children:"‚ö†Ô∏è Important: You'll be able to join the leaderboard and compete with players from around the world!"})}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[e.jsx("button",{type:"button",onClick:y,disabled:u||i.trim().length<3,style:{padding:"12px 24px",backgroundColor:u||i.trim().length<3?"#cccccc":"#2e7d32",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",fontWeight:"bold",cursor:u||i.trim().length<3?"not-allowed":"pointer",fontFamily:"Georgia, serif"},children:u?"Creating profile...":"Ascend the Throne"}),e.jsx("button",{type:"button",onClick:o,style:{padding:"12px 24px",backgroundColor:"#c62828",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",cursor:"pointer",fontFamily:"Georgia, serif",transition:"background-color 0.2s"},onMouseOver:a=>{a.currentTarget.style.backgroundColor="#d32f2f"},onMouseOut:a=>{a.currentTarget.style.backgroundColor="#c62828"},children:"Later"})]})]})})};function qe(t){return t.lt(1e3)?t.toFixed(0):t.lt(1e6)?t.toNumber().toLocaleString():t.toExponential(2)}const ut=({isOpen:t,onClose:o,playerProfile:l,onOpenRulerNameModal:c,gameState:i,onForceSubmit:r,addToast:u})=>{const[n,y]=T.useState([]),[a,g]=T.useState([]),[h,d]=T.useState("alltime"),[v,p]=T.useState(!1),[k,m]=T.useState(null),[C,S]=T.useState(0),[E,N]=T.useState(0),f=()=>{const b=localStorage.getItem("leaderboardCache");if(b)try{const{data:W,timestamp:j}=JSON.parse(b),M=Date.now(),P=3600*1e3;if(M-j<P&&W&&W.allTime&&W.weekly)return W}catch(W){console.error("Cache parse error:",W)}return null},A=b=>{const W={data:b,timestamp:Date.now()};localStorage.setItem("leaderboardCache",JSON.stringify(W)),N(Date.now())},R=()=>{const b=localStorage.getItem("leaderboardCache");if(b){const{timestamp:W}=JSON.parse(b),j=Date.now(),M=3600*1e3;return j-W<M}return!1};T.useEffect(()=>{if(t){if(R())try{const b=f();if(b){y(b.allTime),g(b.weekly);const W=JSON.parse(localStorage.getItem("leaderboardCache"));N(W.timestamp);return}}catch(b){console.error("Cache read error:",b)}F()}},[t]);const F=()=>$(null,null,function*(){p(!0),m(null);try{const b=new Promise((M,P)=>setTimeout(()=>P(new Error("Loading timeout")),1e4)),[W,j]=yield Promise.all([Promise.race([Ve(50),b]),Promise.race([Ke(50),b])]);y(W),g(j),A({allTime:W,weekly:j})}catch(b){console.error("Error loading leaderboard:",b),m("Failed to load leaderboard. Please check your internet connection and try again.")}finally{p(!1)}}),x=b=>{switch(b){case 1:return"ü•á";case 2:return"ü•à";case 3:return"ü•â";default:return`#${b}`}},B=()=>l?(h==="alltime"?n:a).findIndex(W=>W.rulerId===l.rulerId)+1:-1,z=()=>{const b=h==="alltime"?n:a;if(b.length>0){let W=0;if(b.forEach(j=>{if(j.timestamp){let M=0;typeof j.timestamp=="object"&&j.timestamp.toDate?M=j.timestamp.toDate().getTime():typeof j.timestamp=="number"?M=j.timestamp:typeof j.timestamp=="string"&&(M=new Date(j.timestamp).getTime()),M>W&&(W=M)}}),W>0)return W}return E},I=h==="alltime"?n:a,D=I.length>0;return t?e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{maxWidth:"800px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h2",{children:"üèÜ Leaderboard üèÜ"}),e.jsx("button",{className:"btn",onClick:o,children:"Close"})]}),!l&&e.jsxs("div",{style:{backgroundColor:"rgba(191, 144, 0, 0.1)",border:"2px solid var(--gold-color)",borderRadius:"4px",padding:"15px",marginBottom:"16px",textAlign:"center"},children:[e.jsx("h4",{style:{color:"var(--gold-color)",margin:"0 0 8px 0",fontSize:"14px"},children:"üëÅ View Only Mode"}),e.jsxs("p",{style:{color:"var(--text-secondary)",margin:"0",fontSize:"12px",lineHeight:"1.4"},children:[e.jsx("strong",{children:"Anyone can view leaderboard!"})," Choose a name at 10M gold to participate."]}),c&&i&&i.gold&&i.gold.gte(1e7)&&e.jsx("button",{className:"btn",onClick:()=>{o(),c()},style:{backgroundColor:"var(--accent-color)",padding:"6px 12px",fontSize:"12px",marginTop:"8px"},children:"üëë Choose Ruler Name"})]}),D&&e.jsx("div",{style:{backgroundColor:"rgba(191, 144, 0, 0.1)",border:"2px solid var(--gold-color)",borderRadius:"4px",padding:"12px",marginBottom:"16px",textAlign:"center",fontSize:"12px"},children:e.jsxs("span",{style:{color:"var(--gold-color)"},children:["üìä Data updated ",Math.floor((Date.now()-z())/6e4)," minutes ago"]})}),v&&e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"var(--text-secondary)"},children:"Loading leaderboard data..."}),k&&e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"var(--danger-color)"},children:k}),l&&D&&e.jsxs("div",{style:{backgroundColor:"rgba(191, 144, 0, 0.1)",border:"2px solid var(--gold-color)",borderRadius:"4px",padding:"12px",marginBottom:"16px",textAlign:"center"},children:[e.jsxs("div",{style:{color:"var(--gold-color)",fontSize:"14px",fontWeight:"bold"},children:["üëë You are playing as: ",l.rulerName," ",l.rulerId,l.specialIcon&&e.jsx("span",{style:{marginLeft:"5px"},children:l.specialIcon}),l.specialTitle&&e.jsx("span",{style:{marginLeft:"5px",color:"var(--accent-color)",fontSize:"12px"},children:l.specialTitle})]}),I.length>0&&e.jsxs("div",{style:{color:"var(--text-secondary)",fontSize:"12px",marginTop:"5px"},children:["Your Rank: ",B()>0?`#${B()}`:"Not ranked yet"," in ",h==="alltime"?"All Time":"Weekly"]})]}),D&&e.jsxs("div",{style:{display:"flex",marginBottom:"16px",borderBottom:"2px solid var(--border-color)"},children:[e.jsx("button",{onClick:()=>d("alltime"),className:h==="alltime"?"tab-btn active":"tab-btn",children:"All Time"}),e.jsx("button",{onClick:()=>d("weekly"),className:h==="weekly"?"tab-btn active":"tab-btn",children:"This Week"})]}),D&&!v&&!k&&e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto",border:"2px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--panel-bg)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{style:{backgroundColor:"var(--accent-color)",color:"white",position:"sticky",top:0},children:e.jsxs("tr",{children:[e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Rank"}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Ruler"}),e.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Gold"}),e.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Renown"}),e.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Clicks"}),e.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Achievements"})]})}),e.jsx("tbody",{children:I.map((b,W)=>e.jsxs("tr",{style:{backgroundColor:(l==null?void 0:l.rulerId)===b.rulerId?"rgba(191, 144, 0, 0.1)":W%2===0?"rgba(0, 0, 0, 0.02)":"transparent",borderBottom:"1px solid var(--border-color)"},children:[e.jsx("td",{style:{padding:"10px",fontWeight:"bold",color:"var(--text-color)"},children:x(W+1)}),e.jsx("td",{style:{padding:"10px",color:"var(--text-color)"},children:e.jsxs("div",{children:[e.jsxs("strong",{children:[b.rulerName,(l==null?void 0:l.specialIcon)&&l.rulerId===b.rulerId&&e.jsx("span",{style:{marginLeft:"5px"},children:l.specialIcon})]}),e.jsxs("div",{style:{fontSize:"12px",color:"var(--text-secondary)"},children:[b.rulerId,(l==null?void 0:l.specialTitle)&&l.rulerId===b.rulerId&&e.jsx("span",{style:{marginLeft:"5px",color:"var(--accent-color)"},children:l.specialTitle})]})]})}),e.jsx("td",{style:{padding:"10px",textAlign:"right",color:"var(--gold-color)",fontWeight:"bold"},children:w(b.gold,"standard")}),e.jsx("td",{style:{padding:"10px",textAlign:"right",color:"var(--text-secondary)"},children:w(b.renown,"standard")}),e.jsx("td",{style:{padding:"10px",textAlign:"right",color:"var(--text-secondary)"},children:w(b.totalClicks,"standard")}),e.jsx("td",{style:{padding:"10px",textAlign:"right",color:"var(--text-secondary)"},children:b.achievements})]},b.id))})]})}),e.jsx("div",{style:{marginTop:"16px",fontSize:"12px",color:"var(--text-secondary)",textAlign:"center"},children:"üí° Leaderboard updates automatically every hour. Data is cached for performance."})]})}):null},ht=({gained:t,effectiveTime:o,totalTime:l,efficiency:c,completedProjects:i,currentLevel:r,maxDuration:u,onClose:n,numberFormat:y})=>{const a=g=>{const h=Math.floor(g/3600),d=Math.floor(g%3600/60),v=Math.floor(g%60),p=[];return h>0&&p.push(`${h}h`),d>0&&p.push(`${d}m`),(v>0||p.length===0)&&p.push(`${v}s`),p.join(" ")};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{border:"4px solid var(--accent-color)"},children:[e.jsx("h2",{children:"üåô Welcome Back, Ruler!"}),e.jsxs("div",{style:{padding:"20px",textAlign:"left"},children:[e.jsx("p",{children:"Your kingdom continued to operate while you were away."}),e.jsxs("div",{style:{background:"var(--panel-bg)",border:"1px solid var(--border-color)",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[e.jsx("span",{children:"Time Away:"}),e.jsx("strong",{children:a(l.toNumber())})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[e.jsx("span",{children:"Effective Production Time:"}),e.jsx("strong",{children:a(o.toNumber())})]}),o.toNumber()<l.toNumber()&&e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",fontStyle:"italic",marginBottom:"5px",textAlign:"center"},children:["‚ö†Ô∏è Production time limited by upgrade level (max ",a(u),")"]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[e.jsx("span",{children:"Efficiency:"}),e.jsxs("strong",{children:[(c*100).toFixed(0),"% (Level ",r,"/20)"]})]}),e.jsx("div",{style:{borderTop:"1px dashed var(--border-color)",margin:"10px 0"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"1.2rem",color:"var(--gold-color)"},children:[e.jsx("span",{children:"Gold Earned:"}),e.jsxs("strong",{children:["+",w(t,y)]})]})]}),i.length>0&&e.jsxs("div",{children:[e.jsx("h3",{children:"‚úÖ Projects Completed"}),e.jsx("ul",{style:{paddingLeft:"20px",maxHeight:"150px",overflowY:"auto"},children:i.map((g,h)=>e.jsx("li",{style:{color:"var(--success-color)",marginBottom:"5px"},children:g},h))})]})]}),e.jsx("button",{className:"btn",onClick:n,style:{width:"100%",padding:"15px",fontSize:"1.1rem"},children:"Collect & Continue"})]})})},gt=({gameState:t,onClose:o,onRedeemPromoCode:l,onBackToSettings:c})=>{const[i,r]=Z.useState(""),[u,n]=Z.useState(""),[y,a]=Z.useState("info"),[g,h]=Z.useState(!1),d=N=>$(null,null,function*(){if(N.preventDefault(),!i.trim()){n("Please enter a promo code"),a("error");return}h(!0),n("");try{yield l(i),r(""),n("Promo code redeemed successfully!"),a("success")}catch(f){n("Error redeeming promo code"),a("error")}finally{h(!1)}}),v={position:"fixed",top:"0",left:"0",right:"0",bottom:"0",backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},p={backgroundColor:"#2c2416",border:"3px solid #8b7355",borderRadius:"12px",padding:"30px",maxWidth:"500px",width:"100%",color:"#f4e4c1",fontFamily:"Georgia, serif",boxShadow:"0 0 30px rgba(0, 0, 0, 0.8)",maxHeight:"80vh",overflowY:"auto"},k={textAlign:"center",fontSize:"2rem",marginBottom:"20px",color:"#d4af37",textShadow:"2px 2px 4px rgba(0, 0, 0, 0.5)"},m={width:"100%",padding:"12px",fontSize:"1rem",backgroundColor:"#1a1611",border:"2px solid #8b7355",borderRadius:"6px",color:"#f4e4c1",fontFamily:"Georgia, serif",textTransform:"uppercase",letterSpacing:"1px",marginBottom:"15px"},C={background:"#9c27b0",color:"white",border:"none",padding:"12px 24px",fontSize:"1rem",borderRadius:"6px",cursor:"pointer",fontFamily:"Georgia, serif",fontWeight:"bold",width:"100%",marginBottom:"10px",opacity:g?.7:1},S={background:"#5d4037",color:"white",border:"none",padding:"12px 24px",fontSize:"1rem",borderRadius:"6px",cursor:"pointer",fontFamily:"Georgia, serif",width:"100%"},E={padding:"10px",borderRadius:"6px",marginBottom:"15px",textAlign:"center",fontSize:"0.9rem",backgroundColor:y==="success"?"#2e7d32":y==="error"?"#c62828":"#1565c0",border:`1px solid ${y==="success"?"#4caf50":y==="error"?"#f44336":"#2196f3"}`};return e.jsx("div",{style:v,onClick:o,children:e.jsxs("div",{style:p,onClick:N=>N.stopPropagation(),children:[e.jsx("h2",{style:k,children:"üé´ Promo Codes"}),e.jsxs("form",{onSubmit:d,children:[e.jsx("input",{type:"text",value:i,onChange:N=>r(N.target.value),placeholder:"Enter promo code...",style:m,maxLength:50,disabled:g}),e.jsx("button",{type:"submit",style:C,disabled:g,children:g?"Redeeming...":"Redeem Code"})]}),u&&e.jsx("div",{style:E,children:u}),e.jsx("div",{style:{fontSize:"0.8rem",color:"#8b7355",textAlign:"center",marginBottom:"20px",fontStyle:"italic"},children:"Enter promotional codes to receive special rewards!"}),e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px"},children:[c&&e.jsx("button",{style:H(O({},S),{background:"#666"}),onClick:c,children:"Back to Settings"}),e.jsx("button",{style:H(O({},S),{flex:"1"}),onClick:o,children:"Close"})]})]})})},mt=({isOpen:t,onClose:o,onConfirm:l,currentName:c})=>{const[i,r]=T.useState(c),[u,n]=T.useState(!1);if(!t)return null;const y=()=>$(null,null,function*(){if(i.trim().length<3){alert("Ruler name must contain at least 3 characters!");return}if(i.trim().length>20){alert("Ruler name must not exceed 20 characters!");return}if(i.trim()===c.trim()){alert("New name must be different from current name!");return}n(!0);try{yield l(i.trim()),o()}catch(a){alert("Error changing name. Please try again.")}finally{n(!1)}});return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:3e3},children:e.jsxs("div",{style:{backgroundColor:"#fdf6e3",border:"4px solid #8d6e63",borderRadius:"8px",padding:"32px",maxWidth:"500px",width:"90%",textAlign:"center",fontFamily:"Georgia, serif"},children:[e.jsx("h2",{style:{color:"#3e2723",marginBottom:"16px"},children:"üëë Change Ruler Name üëë"}),e.jsxs("p",{style:{color:"#5d4037",marginBottom:"24px",lineHeight:"1.5"},children:["Current name: ",e.jsx("strong",{children:c}),e.jsx("br",{}),"Enter new name for your ruler:"]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("label",{style:{display:"block",color:"#3e2723",marginBottom:"8px",fontWeight:"bold"},children:"New Name:"}),e.jsx("input",{type:"text",value:i,onChange:a=>r(a.target.value),placeholder:"Enter new name...",maxLength:20,style:{width:"100%",padding:"12px",border:"2px solid #a1887f",borderRadius:"4px",fontSize:"16px",fontFamily:"Arial, sans-serif",backgroundColor:"#fff",color:"#3e2723"},onKeyPress:a=>a.key==="Enter"&&y()}),e.jsxs("div",{style:{fontSize:"12px",color:"#8d6e63",marginTop:"4px",textAlign:"left"},children:[i.length,"/20 characters"]})]}),e.jsx("div",{style:{backgroundColor:"#fff3e0",border:"2px solid #bf9000",borderRadius:"4px",padding:"12px",marginBottom:"24px"},children:e.jsx("p",{style:{color:"#bf9000",margin:0,fontSize:"14px",fontWeight:"bold"},children:"‚ö†Ô∏è Warning: Name change will update your profile in leaderboard!"})}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[e.jsx("button",{type:"button",onClick:y,disabled:u||i.trim().length<3||i.trim()===c.trim(),style:{padding:"12px 24px",backgroundColor:u||i.trim().length<3||i.trim()===c.trim()?"#cccccc":"#2e7d32",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",fontWeight:"bold",cursor:u||i.trim().length<3||i.trim()===c.trim()?"not-allowed":"pointer",fontFamily:"Georgia, serif"},children:u?"Saving...":"Change Name"}),e.jsx("button",{type:"button",onClick:o,style:{padding:"12px 24px",backgroundColor:"#c62828",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",cursor:"pointer",fontFamily:"Georgia, serif",transition:"background-color 0.2s"},onMouseOver:a=>{a.currentTarget.style.backgroundColor="#d32f2f"},onMouseOut:a=>{a.currentTarget.style.backgroundColor="#c62828"},children:"Cancel"})]})]})})};export{it as C,at as E,ut as L,ht as O,nt as P,pt as R,st as S,rt as T,dt as a,gt as b,lt as c,mt as d,ct as s,xt as u};
