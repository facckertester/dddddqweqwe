var ve=Object.defineProperty,je=Object.defineProperties;var we=Object.getOwnPropertyDescriptors;var le=Object.getOwnPropertySymbols;var ke=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var ae=(t,r,a)=>r in t?ve(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a,G=(t,r)=>{for(var a in r||(r={}))ke.call(r,a)&&ae(t,a,r[a]);if(le)for(var a of le(r))Ce.call(r,a)&&ae(t,a,r[a]);return t},O=(t,r)=>je(t,we(r));var $=(t,r,a)=>new Promise((d,i)=>{var o=f=>{try{n(a.next(f))}catch(l){i(l)}},p=f=>{try{n(a.throw(f))}catch(l){i(l)}},n=f=>f.done?d(f.value):Promise.resolve(f.value).then(o,p);n((a=a.apply(t,r)).next())});import{r as B,j as e,R as J}from"./vendor-react-CUeQczFW.js";import{t as s,f as R,T as Se,C as de,B as V,W as Re,A as Ne,P as oe,a as ee,N as Te,b as Be,M as ce,c as We,d as Ae,e as xe,i as Q,j as pe}from"./core-BLe5j-6i.js";import{g as Z}from"./components-ui-BeL8qPGz.js";import{A as ze}from"./components-achievements-Cx03PYNb.js";import{i as Ee,g as Me,s as te,d as K,a as q,q as ge,c as he,o as me,l as fe,b as be}from"./vendor-firebase-IMiYFFvY.js";import{a as H}from"./vendor-DdgGw12P.js";const re=({currentBet:t,maxGold:r,onBetChange:a,numberFormat:d})=>{const[i,o]=B.useState(t===0?"":t.toString());B.useEffect(()=>{var b,u;t===0&&((b=document.activeElement)==null?void 0:b.tagName)!=="INPUT"?o(""):Math.abs(parseFloat(i)-t)>1e-4&&((u=document.activeElement)==null?void 0:u.tagName)!=="INPUT"&&o(t>1e9?t.toExponential(2).replace("+",""):t.toString())},[t]);const p=b=>{try{if(b.trim()===""){a(0),o("");return}let u=parseFloat(b);const x=b.toLowerCase().trim(),j={k:1e3,m:1e6,b:1e9,t:1e12,qa:1e15,qi:1e18,sx:1e21,sp:1e24,oc:1e27,no:1e30,dc:1e33,ud:1e36,dd:1e39,td:1e42,qd:1e45,qn:1e48};for(const k of Object.keys(j))if(x.endsWith(k)){const h=parseFloat(x.slice(0,-k.length));isNaN(h)||(u=h*j[k]);break}(isNaN(u)||u<0)&&(u=0);const g=r.toNumber();isFinite(g)&&u>g?u=g:!isFinite(g)&&s(u).gt(r)&&(u=Number.MAX_VALUE),a(u),u===0?o(""):u>=1e6?o(u.toExponential(2).replace("+","")):o(Math.floor(u).toString())}catch(u){o(t===0?"":t.toString())}},n=()=>{p(i)},f=b=>{b.key==="Enter"&&(p(i),b.target.blur())},l=b=>{let x=r.times(b).floor().toNumber();isFinite(x)||(x=Number.MAX_VALUE),x<1&&r.gt(0)&&(x=1),a(x),x>=1e6?o(x.toExponential(2).replace("+","")):o(x.toString())};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",width:"100%"},children:[e.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[e.jsx("span",{style:{position:"absolute",left:"10px",pointerEvents:"none",fontSize:"1.2rem"},children:"ðŸ’°"}),e.jsx("input",{type:"text",value:i,onChange:b=>o(b.target.value),onBlur:n,onKeyDown:f,style:{width:"100%",padding:"10px 30px 10px 35px",fontSize:"1.1rem",border:"2px solid var(--border-color)",borderRadius:"4px",fontFamily:"monospace",background:"#fff",color:"#000",outline:"none",fontWeight:"bold"},placeholder:"Wager (100, 1k, 2.5m, 1b, 2e13)..."}),t>0&&e.jsx("button",{onClick:()=>{a(0),o("")},style:{position:"absolute",right:"5px",top:"50%",transform:"translateY(-50%)",background:"transparent",border:"none",color:"#999",fontSize:"1.2rem",cursor:"pointer",padding:"0 5px"},title:"Clear",children:"âœ•"})]}),e.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"space-between"},children:[e.jsx("button",{className:"btn",style:{padding:"4px 8px",fontSize:"0.7rem",flex:1,background:"rgba(0,0,0,0.1)",color:"var(--text-color)",border:"1px solid var(--border-color)"},onClick:()=>l(.1),children:"10%"}),e.jsx("button",{className:"btn",style:{padding:"4px 8px",fontSize:"0.7rem",flex:1,background:"rgba(0,0,0,0.1)",color:"var(--text-color)",border:"1px solid var(--border-color)"},onClick:()=>l(.5),children:"50%"}),e.jsx("button",{className:"btn",style:{padding:"4px 8px",fontSize:"0.7rem",flex:1,background:"var(--gold-color)",color:"#000",border:"1px solid #b8860b"},onClick:()=>l(1),children:"MAX"}),e.jsx("div",{style:{width:"4px"}}),e.jsx("button",{className:"btn",style:{padding:"4px 8px",fontSize:"0.7rem",flex:1,background:"rgba(0,0,0,0.1)",color:"var(--text-color)",border:"1px solid var(--border-color)"},onClick:()=>p(Math.floor(t/2).toString()),children:"Â½"}),e.jsx("button",{className:"btn",style:{padding:"4px 8px",fontSize:"0.7rem",flex:1,background:"rgba(0,0,0,0.1)",color:"var(--text-color)",border:"1px solid var(--border-color)"},onClick:()=>p((t*2).toString()),children:"x2"})]})]})},Fe=["Shadowfax","Roach","Bucephalus","Pegasus","Sleipnir","Epona","Agro","Artax","Rapidash","Spirit","Bullseye","Maximus","Khan","Buckbeak","Chestnut","Midnight","Storm","Blaze","Comet","Dakota"],Ie=["#d32f2f","#1976d2","#388e3c","#fbc02d","#8e24aa","#ef6c00"],Le=50,Pe=({gameState:t,onGamble:r,onLeave:a})=>{const[d,i]=B.useState([]),[o,p]=B.useState(null),[n,f]=B.useState(0),[l,b]=B.useState("betting"),[u,x]=B.useState(""),[j,g]=B.useState(null),k=B.useRef(null),h=B.useRef([]);B.useEffect(()=>{w()},[]);const w=()=>{const m=[],M=[...Fe].sort(()=>.5-Math.random());for(let S=0;S<6;S++){const E=Math.random()*5+5,c=Math.random()*5+5;let z=25-(E+c);z=z+(Math.random()*4-2),z<1.5&&(z=1.5),z>20&&(z=20),m.push({id:S,name:M[S],color:Ie[S],icon:"ðŸŽ",odds:parseFloat(z.toFixed(1)),progress:0,finished:!1,rank:0,speedRating:E,staminaRating:c})}i(m),p(null),g(null),h.current=[],x("Select a horse and place your bet!")},C=()=>{if(o===null){x("Select a horse first!");return}if(n<=0){x("Place a valid bet!");return}if(t.gold.lt(s(n))){x("Not enough gold!");return}b("racing"),x("And they're off!");let m=0;const M=400;k.current=setInterval(()=>{m++,i(S=>S.map(c=>{if(c.finished)return c;const A=Math.random()<.05?1:0,z=Math.random()<.05?-.5:0,I=.15,L=c.speedRating/10*.15,y=Math.random()*.2;let W=I+L+y+A+z,v=c.progress+W;return v>=100&&(v=100,!h.current.includes(c.id))?(h.current.push(c.id),O(G({},c),{progress:100,finished:!0,rank:h.current.length})):O(G({},c),{progress:v})}).slice(0,6)),(h.current.length===6||m>=M)&&(h.current.length<6&&i(S=>(S.filter(c=>!c.finished).sort((c,A)=>A.progress-c.progress).forEach(c=>{h.current.includes(c.id)||h.current.push(c.id)}),S.map(c=>{const A=h.current.indexOf(c.id);return A!==-1?O(G({},c),{rank:A+1,finished:!0,progress:100}):c}))),T())},Le)},T=()=>{k.current&&clearInterval(k.current);const m=d.map(c=>{const A=h.current.indexOf(c.id);return A!==-1?O(G({},c),{rank:A+1,finished:!0}):c});i(m);const M=h.current[0],S=m.find(c=>c.id===M);if(!S)return;if(b("finished"),M===o){const c=m.find(I=>I.id===o),A=(c==null?void 0:c.odds)||1,z=Math.max(1,Math.floor(n*(A-1)));r(z,!0),g({won:!0,amount:z,winnerName:S.name})}else r(n,!1),g({won:!1,amount:n,winnerName:S.name})};B.useEffect(()=>()=>{k.current&&clearInterval(k.current)},[]);const N=()=>{b("betting"),f(0),w()};return j&&(j.won,j.won,j.won,j.won,j.won,j.winnerName,j.won?(e.Fragment,R(s(j.amount),t.numberFormat)):(e.Fragment,R(s(j.amount),t.numberFormat))),e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"5px",textAlign:"center",background:"#e0cda9",borderBottom:"1px solid #5d4037",color:"#5d4037",fontWeight:"bold"},children:u}),e.jsxs("div",{style:{flex:1,background:"#e0cda9",padding:"10px 0",overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"space-between",position:"relative"},children:[e.jsx("div",{style:{position:"absolute",right:"40px",top:0,bottom:0,width:"10px",background:"repeating-linear-gradient(45deg, #000, #000 10px, #fff 10px, #fff 20px)",zIndex:0,borderLeft:"2px solid rgba(0,0,0,0.2)",borderRight:"2px solid rgba(0,0,0,0.2)",height:"100%"}}),d.map(m=>e.jsxs("div",{onClick:()=>l==="betting"&&p(m.id),style:{position:"relative",flex:1,minHeight:"30px",borderBottom:"1px dashed rgba(93, 64, 55, 0.3)",display:"flex",alignItems:"center",cursor:l==="betting"?"pointer":"default",background:o===m.id?"rgba(255, 215, 0, 0.3)":"rgba(255,255,255,0.1)",transition:"background 0.2s"},children:[e.jsxs("div",{style:{width:"100px",padding:"0 10px",borderRight:"1px solid var(--border-color)",display:"flex",flexDirection:"column",justifyContent:"center",zIndex:2,background:"var(--panel-bg)",height:"100%"},children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.8rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"var(--text-color)"},children:m.name}),e.jsxs("div",{style:{fontSize:"0.9rem",color:o===m.id?"var(--accent-color)":"var(--text-secondary)",fontWeight:"bold"},children:[m.odds.toFixed(1),"x"]})]}),e.jsx("div",{style:{position:"absolute",left:`calc(100px + ${m.progress}% - ${m.progress*.8}px)`,transition:l==="racing"?"left 0.05s linear":"left 0.3s ease",fontSize:"2rem",zIndex:1,transform:"scaleX(-1) translateY(-5px)",filter:o===m.id?"drop-shadow(0 0 5px gold)":"drop-shadow(0 2px 2px rgba(0,0,0,0.3))",color:m.color},children:e.jsx("div",{style:{fontSize:"2rem"},children:m.icon})}),m.finished&&e.jsx("div",{style:{position:"absolute",right:"10px",fontWeight:"bold",fontSize:"1.2rem",zIndex:5,color:"#000",textShadow:"0 0 2px rgba(0,0,0,0.3)"},children:m.rank===1?"ðŸ¥‡":m.rank===2?"ðŸ¥ˆ":m.rank===3?"ðŸ¥‰":m.rank?`#${m.rank}`:"?"})]},m.id))]}),e.jsxs("div",{style:{padding:"15px 20px",background:"var(--panel-bg)",borderTop:"2px solid var(--border-color)",flexShrink:0,display:"flex",flexDirection:"row",gap:"15px",alignItems:"flex-end"},children:[e.jsx("div",{style:{flex:1},children:e.jsx(re,{currentBet:n,maxGold:t.gold,onBetChange:f,numberFormat:t.numberFormat})}),e.jsxs("div",{style:{flexShrink:0},children:[l==="betting"&&e.jsx("button",{className:"btn",onClick:C,disabled:o===null||n<=0,style:{opacity:o===null||n<=0?.5:1,fontSize:"1.2rem",padding:"0 30px",height:"60px",background:"var(--accent-color)",boxShadow:"0 4px 0 rgba(0,0,0,0.2)",fontWeight:"bold"},children:"START"}),l==="finished"&&e.jsx("button",{className:"btn",onClick:N,style:{fontSize:"1.2rem",padding:"0 30px",height:"60px",background:"var(--accent-color)",boxShadow:"0 4px 0 rgba(0,0,0,0.2)",fontWeight:"bold"},children:"RACE AGAIN"}),l==="racing"&&e.jsx("div",{style:{width:"100%",height:"60px"}})]})]}),e.jsxs("div",{style:{padding:"10px 20px",background:"var(--panel-bg)",borderTop:"1px solid var(--border-color)",textAlign:"center",fontSize:"1rem",fontWeight:"bold"},children:[e.jsx("span",{style:{marginRight:"10px",color:"var(--text-secondary)"},children:"Result:"}),j?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{marginRight:"10px"},children:j.won?"ðŸ‡":"ðŸ¢"}),e.jsx("span",{style:{color:j.won?"#4caf50":"#f44336",marginRight:"10px"},children:j.won?"Winner!":"Better luck next time"}),e.jsxs("span",{style:{color:"var(--accent-color)",marginRight:"10px"},children:["Winner: ",j.winnerName]}),e.jsxs("span",{style:{color:j.won?"gold":"#ef5350"},children:[j.won?"+":"-",R(s(j.amount),t.numberFormat)," Gold"]})]}):e.jsx("span",{style:{color:"var(--text-secondary)",fontStyle:"italic"},children:"No results yet"})]})]})},De=({gameState:t,onGamble:r,onLeave:a})=>{const[d,i]=B.useState(0),[o,p]=B.useState(null),[n,f]=B.useState(!1),[l,b]=B.useState(0),[u,x]=B.useState(null),[j,g]=B.useState("Select a side and place your wager.");u&&(u.won,u.won,u.won,u.won,u.won,u.side,u.won?(e.Fragment,R(s(u.amount),t.numberFormat)):(e.Fragment,R(s(u.amount),t.numberFormat)));const k=()=>{if(!o){g("Please select Heads or Tails!");return}if(d<=0){g("Please enter a valid bet amount.");return}if(t.gold.lt(s(d))){g("Not enough gold!");return}f(!0),g("");const h=Math.random()>.5,w=Math.random()<.65,C=w?o==="heads"?"tails":"heads":h?"heads":"tails",T=!w,N=l,M=360*5;let S=N+M;const E=S%360;C==="heads"?S+=360-E:S+=180-E+360,b(S),setTimeout(()=>{f(!1),T?(r(d,!0),g("Victory!")):(r(d,!1),g("Defeat!")),setTimeout(()=>{x({won:T,amount:d,side:C})},500)},3e3)};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[e.jsx("style",{children:`
            .coin-container {
                perspective: 1000px;
                width: 180px;
                height: 180px;
                margin: 0 auto;
            }
            .coin {
                width: 100%;
                height: 100%;
                position: relative;
                transform-style: preserve-3d;
                transition: transform 3s cubic-bezier(0.1, 0.7, 0.1, 1);
            }
            .coin-face {
                position: absolute;
                width: 100%;
                height: 100%;
                backface-visibility: hidden;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 5rem;
                box-shadow: inset 0 0 30px rgba(0,0,0,0.5), 0 10px 20px rgba(0,0,0,0.3);
                border: 10px solid #b8860b;
            }
            .coin-front {
                background: radial-gradient(#ffd700, #daa520);
                color: #5d4037;
                transform: rotateY(0deg);
            }
            .coin-back {
                background: radial-gradient(#e6c200, #b8860b);
                color: #5d4037;
                transform: rotateY(180deg);
            }
            .coin-text {
                font-family: 'Cinzel', serif;
                font-weight: bold;
                text-shadow: 2px 2px 0 rgba(255,255,255,0.4);
            }
        `}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative",background:"var(--bg-color)",overflow:"hidden"},children:[e.jsx("div",{className:"coin-container",children:e.jsxs("div",{className:"coin",style:{transform:`rotateY(${l}deg)`},children:[e.jsx("div",{className:"coin-face coin-front",children:e.jsx("span",{className:"coin-text",children:"ðŸ‘‘"})}),e.jsx("div",{className:"coin-face coin-back",children:e.jsx("span",{className:"coin-text",children:"1"})})]})}),e.jsx("div",{style:{fontSize:"1.4rem",fontWeight:"bold",marginTop:"20px",minHeight:"30px",color:"var(--accent-color)",textAlign:"center",padding:"0 20px"},children:j}),e.jsxs("div",{style:{display:"flex",gap:"20px",marginTop:"20px"},children:[e.jsxs("button",{onClick:()=>p("heads"),disabled:n,style:{padding:"10px 20px",border:`3px solid ${o==="heads"?"var(--gold-color)":"transparent"}`,background:o==="heads"?"rgba(255, 215, 0, 0.2)":"var(--bg-color)",color:"var(--text-color)",borderRadius:"8px",cursor:n?"not-allowed":"pointer",transition:"all 0.2s",display:"flex",flexDirection:"column",alignItems:"center",minWidth:"100px",transform:n?"none":"scale(1)",boxShadow:n?"none":"0 4px 8px rgba(0,0,0,0.15)",opacity:n?.6:1},onMouseEnter:h=>{!n&&o!=="heads"&&(h.currentTarget.style.transform="scale(1.1)",h.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.3)",h.currentTarget.style.border="3px solid var(--accent-color)",h.currentTarget.style.background="rgba(33, 150, 243, 0.2)")},onMouseLeave:h=>{!n&&o!=="heads"&&(h.currentTarget.style.transform="scale(1)",h.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)",h.currentTarget.style.border="3px solid transparent",h.currentTarget.style.background="var(--bg-color)")},children:[e.jsx("div",{style:{fontSize:"1.5rem"},children:"ðŸ‘‘"}),e.jsx("div",{style:{fontWeight:"bold"},children:"Heads"})]}),e.jsxs("button",{onClick:()=>p("tails"),disabled:n,style:{padding:"10px 20px",border:`3px solid ${o==="tails"?"var(--gold-color)":"transparent"}`,background:o==="tails"?"rgba(255, 215, 0, 0.2)":"var(--bg-color)",color:"var(--text-color)",borderRadius:"8px",cursor:n?"not-allowed":"pointer",transition:"all 0.2s",display:"flex",flexDirection:"column",alignItems:"center",minWidth:"100px",transform:n?"none":"scale(1)",boxShadow:n?"none":"0 4px 8px rgba(0,0,0,0.15)",opacity:n?.6:1},onMouseEnter:h=>{!n&&o!=="tails"&&(h.currentTarget.style.transform="scale(1.1)",h.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.3)",h.currentTarget.style.border="3px solid var(--accent-color)",h.currentTarget.style.background="rgba(33, 150, 243, 0.2)")},onMouseLeave:h=>{!n&&o!=="tails"&&(h.currentTarget.style.transform="scale(1)",h.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)",h.currentTarget.style.border="3px solid transparent",h.currentTarget.style.background="var(--bg-color)")},children:[e.jsx("div",{style:{fontSize:"1.5rem"},children:"1"}),e.jsx("div",{style:{fontWeight:"bold"},children:"Tails"})]})]})]}),e.jsxs("div",{style:{padding:"15px 20px",background:"var(--panel-bg)",borderTop:"2px solid var(--border-color)",flexShrink:0,display:"flex",flexDirection:"row",gap:"15px",alignItems:"flex-end"},children:[e.jsx("div",{style:{flex:1},children:e.jsx(re,{currentBet:d,maxGold:t.gold,onBetChange:i,numberFormat:t.numberFormat})}),e.jsx("button",{className:"btn",onClick:k,disabled:!o||d<=0||n,style:{opacity:!o||d<=0||n?.5:1,fontSize:"1.2rem",padding:"0 30px",height:"60px",background:"var(--accent-color)",boxShadow:"0 4px 0 rgba(0,0,0,0.2)",flexShrink:0,fontWeight:"bold"},children:"FLIP"})]}),e.jsxs("div",{style:{padding:"10px 20px",background:"var(--panel-bg)",borderTop:"1px solid var(--border-color)",textAlign:"center",fontSize:"1rem",fontWeight:"bold"},children:[e.jsx("span",{style:{marginRight:"10px",color:"var(--text-secondary)"},children:"Result:"}),u?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{marginRight:"10px"},children:u.won?"âœ¨":"ðŸ’¸"}),e.jsx("span",{style:{color:u.won?"#4caf50":"#f44336",marginRight:"10px"},children:u.won?"Victory!":"Defeat!"}),e.jsxs("span",{style:{color:"var(--accent-color)",marginRight:"10px"},children:["Result: ",u.side]}),e.jsxs("span",{style:{color:u.won?"gold":"#ef5350"},children:[u.won?"+":"-",R(s(u.amount),t.numberFormat)," Gold"]})]}):e.jsx("span",{style:{color:"var(--text-secondary)",fontStyle:"italic"},children:"No results yet"})]})]})},ue=({value:t,size:r=80,color:a="#3e2723"})=>{const d=r*.18,i=r*.25,o=r*.5,p=r*.75,n=[];return(t===1||t===3||t===5)&&n.push({cx:o,cy:o}),t>1&&(n.push({cx:i,cy:i}),n.push({cx:p,cy:p})),t>3&&(n.push({cx:p,cy:i}),n.push({cx:i,cy:p})),t===6&&(n.push({cx:i,cy:o}),n.push({cx:p,cy:o})),e.jsx("div",{style:{width:r,height:r,backgroundColor:"#fff",borderRadius:r*.15,boxShadow:"0 4px 8px rgba(0,0,0,0.2), inset 0 -4px 4px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #ccc"},children:e.jsx("svg",{width:r,height:r,viewBox:`0 0 ${r} ${r}`,children:n.map((f,l)=>e.jsx("circle",{cx:f.cx,cy:f.cy,r:d/2,fill:a},l))})})},Ge=({gameState:t,onGamble:r,onLeave:a})=>{const[d,i]=B.useState(0),[o,p]=B.useState(!1),[n,f]=B.useState([1,1]),[l,b]=B.useState(null),[u,x]=B.useState("Place your wager and roll!"),j=()=>{if(d<=0){x("Please enter a valid bet amount.");return}if(t.gold.lt(s(d))){x("Not enough gold!");return}p(!0),x("Rolling..."),b(null);let k=0;const h=10,w=setInterval(()=>{f([Math.floor(Math.random()*6)+1,Math.floor(Math.random()*6)+1]),k++,k>=h&&(clearInterval(w),g())},100)},g=()=>{const k=Math.floor(Math.random()*6)+1,h=Math.floor(Math.random()*6)+1,w=k+h;f([k,h]),p(!1);let C=0,T=!1,N="";if(w===2?(C=10,T=!0,N="Snake Eyes! JACKPOT (x10)!"):w===3?(C=2,T=!0,N="Low Triple! (x2)"):w>=4&&w<=9?(C=0,T=!1,N="House wins..."):w>=10&&w<=11?(C=1.5,T=!0,N="Good roll! (x1.5)"):w===12&&(C=5,T=!0,N="Boxcars! Nice Win (x5)!"),T){const m=Math.max(1,Math.floor(d*(C-1)));r(m,!0),x(N),b({won:!0,amount:m,sum:w})}else r(d,!1),x(N),b({won:!1,amount:d,sum:w})};return l&&(l.won,l.won,l.won,l.won,l.won,l.sum,l.won?(e.Fragment,R(s(l.amount),t.numberFormat)):(e.Fragment,R(s(l.amount),t.numberFormat))),e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-evenly",alignItems:"center",background:"var(--bg-color)",overflow:"hidden",padding:"10px"},children:[e.jsxs("div",{style:{background:"var(--panel-bg)",padding:"10px",borderRadius:"8px",fontSize:"0.8rem",border:"1px solid var(--border-color)",width:"100%",maxWidth:"400px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[e.jsx("span",{style:{color:"var(--text-color)"},children:"Sum 2 (Snake Eyes)"}),e.jsx("span",{style:{color:"var(--gold-color)",fontWeight:"bold"},children:"x10"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[e.jsx("span",{style:{color:"var(--text-color)"},children:"Sum 3"}),e.jsx("span",{style:{color:"var(--success-color)",fontWeight:"bold"},children:"x2"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[e.jsx("span",{style:{color:"var(--text-color)"},children:"Sum 10-11"}),e.jsx("span",{style:{color:"var(--success-color)",fontWeight:"bold"},children:"x1.5"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-color)"},children:"Sum 12 (Boxcars)"}),e.jsx("span",{style:{color:"var(--gold-color)",fontWeight:"bold"},children:"x5"})]}),e.jsx("div",{style:{textAlign:"center",color:"var(--danger-color)",marginTop:"15px",fontSize:"0.9rem",fontWeight:"bold"},children:"Sum 4-9: House Wins"})]}),e.jsxs("div",{style:{display:"flex",gap:"30px",transform:"scale(1.2)"},children:[e.jsx(ue,{value:n[0],size:100}),e.jsx(ue,{value:n[1],size:100})]}),e.jsx("div",{style:{fontSize:"1.8rem",fontWeight:"bold",minHeight:"40px",color:"var(--accent-color)"},children:o?"":`Sum: ${n[0]+n[1]}`}),e.jsx("div",{style:{fontSize:"1rem",minHeight:"20px",color:"var(--text-color)"},children:u})]}),e.jsxs("div",{style:{padding:"15px 20px",background:"var(--panel-bg)",borderTop:"2px solid var(--border-color)",flexShrink:0,display:"flex",flexDirection:"row",gap:"15px",alignItems:"flex-end"},children:[e.jsx("div",{style:{flex:1},children:e.jsx(re,{currentBet:d,maxGold:t.gold,onBetChange:i,numberFormat:t.numberFormat})}),e.jsx("button",{className:"btn",onClick:j,disabled:d<=0||o,style:{fontSize:"1.2rem",padding:"0 30px",height:"60px",background:"var(--accent-color)",opacity:d<=0||o?.5:1,boxShadow:"0 4px 0 rgba(0,0,0,0.2)",flexShrink:0,fontWeight:"bold"},children:"ROLL"})]}),e.jsxs("div",{style:{padding:"10px 20px",background:"var(--panel-bg)",borderTop:"1px solid var(--border-color)",textAlign:"center",fontSize:"1rem",fontWeight:"bold"},children:[e.jsx("span",{style:{marginRight:"10px",color:"var(--text-secondary)"},children:"Result:"}),l?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{marginRight:"10px"},children:l.won?"ðŸŽ²":"ðŸ“‰"}),e.jsx("span",{style:{color:l.won?"#4caf50":"#f44336",marginRight:"10px"},children:l.won?"You Won!":"You Lost"}),e.jsxs("span",{style:{color:"var(--accent-color)",marginRight:"10px"},children:["Rolled: ",l.sum]}),e.jsxs("span",{style:{color:l.won?"gold":"#ef5350"},children:[l.won?"+":"-",R(s(l.amount),t.numberFormat)," Gold"]})]}):e.jsx("span",{style:{color:"var(--text-secondary)",fontStyle:"italic"},children:"No results yet"})]})]})},ot=({gameState:t,onGamble:r,onClose:a})=>{const[d,i]=B.useState("racing");return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{height:"95vh",maxWidth:"1000px",width:"98%",padding:"0",display:"flex",flexDirection:"column",overflow:"hidden",borderRadius:"12px",border:"4px double var(--border-color)"},children:[e.jsxs("div",{style:{padding:"10px 20px",borderBottom:"2px solid var(--border-color)",background:"var(--accent-color)",color:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h2",{style:{borderBottom:"none",margin:0,fontSize:"1.4rem",textShadow:"1px 1px 0 rgba(0,0,0,0.3)"},children:"ðŸº The Rusty Tankard"}),e.jsxs("div",{style:{fontSize:"0.9rem",background:"rgba(0,0,0,0.2)",padding:"4px 10px",borderRadius:"4px"},children:["Gold: ",e.jsx("span",{style:{color:"var(--gold-color)",fontWeight:"bold"},children:R(t.gold,t.numberFormat)})]})]}),e.jsxs("div",{style:{display:"flex",background:"var(--bg-color)",borderBottom:"2px solid var(--border-color)",overflowX:"auto"},children:[e.jsx("button",{onClick:()=>i("racing"),style:{flex:1,minWidth:"90px",padding:"12px 10px",border:"none",background:d==="racing"?"var(--panel-bg)":"transparent",fontWeight:"bold",color:d==="racing"?"var(--accent-color)":"var(--text-secondary)",cursor:"pointer",borderBottom:d==="racing"?"3px solid var(--accent-color)":"3px solid transparent",transition:"all 0.2s"},children:"ðŸ‡ Racing"}),e.jsx("button",{onClick:()=>i("coin"),style:{flex:1,minWidth:"90px",padding:"12px 10px",border:"none",background:d==="coin"?"var(--panel-bg)":"transparent",fontWeight:"bold",color:d==="coin"?"var(--accent-color)":"var(--text-secondary)",cursor:"pointer",borderBottom:d==="coin"?"3px solid var(--accent-color)":"3px solid transparent",transition:"all 0.2s"},children:"ðŸŸ¡ Coin"}),e.jsx("button",{onClick:()=>i("dice"),style:{flex:1,minWidth:"90px",padding:"12px 10px",border:"none",background:d==="dice"?"var(--panel-bg)":"transparent",fontWeight:"bold",color:d==="dice"?"var(--accent-color)":"var(--text-secondary)",cursor:"pointer",borderBottom:d==="dice"?"3px solid var(--accent-color)":"3px solid transparent",transition:"all 0.2s"},children:"ðŸŽ² Dice"})]}),e.jsxs("div",{style:{background:"var(--bg-color)",flex:1,overflow:"hidden",position:"relative",display:"flex",flexDirection:"column"},children:[d==="racing"&&e.jsx(Pe,{gameState:t,onGamble:(o,p)=>r(o,p),onLeave:a}),d==="coin"&&e.jsx(De,{gameState:t,onGamble:(o,p)=>r(o,p),onLeave:a}),d==="dice"&&e.jsx(Ge,{gameState:t,onGamble:(o,p)=>r(o,p),onLeave:a})]}),e.jsx("div",{style:{padding:"8px",borderTop:"2px solid var(--border-color)",background:"var(--panel-bg)",textAlign:"center",flexShrink:0},children:e.jsx("button",{className:"btn",onClick:a,style:{background:"#5d4037",padding:"8px 20px",fontSize:"0.9rem",width:"auto"},children:"Exit Tavern"})})]})})},rt=({gameState:t,onPrestige:r,onClose:a})=>{var w;const i=s(1e12),o=t.totalGold;let p=s(0),n=!1,f=i.minus(o);if(o.gte(i)){const C=o.dividedBy(i);p=s(Math.floor(Math.pow(C.toNumber(),.33))).times(1).minus(t.renown),p.lt(0)&&(p=s(0)),n=p.gt(0)}const l=t.renown.plus(p),b=i.times(Math.pow(Math.floor(l.dividedBy(1).toNumber()+1),1/.33)),u=b.minus(o),j=Z(t.totalRenownEarned).minus(s(1)).times(s(100)),k=Z(t.totalRenownEarned.plus(p)).minus(s(1)).times(s(100)),h=Object.values(t.nationalProjects||{}).some(C=>C==null?void 0:C.active);return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{border:"4px solid #673ab7",maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[e.jsx("h2",{style:{color:"#673ab7"},children:"ðŸ‘‘ Abdication"}),e.jsx("p",{children:"Are you ready to pass the crown to your heir?"}),e.jsxs("div",{style:{flex:1,overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:[!((w=t.playerProfile)!=null&&w.hasChosenName)&&e.jsxs("div",{style:{background:"rgba(255, 235, 59, 0.1)",border:"1px solid #ffc107",padding:"10px",borderRadius:"4px",marginBottom:"15px",fontSize:"0.9rem"},children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"})," You can abdicate without choosing a ruler name. Choose a name only if you want to appear in the leaderboard."]}),e.jsxs("div",{style:{textAlign:"left",margin:"20px 0",background:"rgba(243, 229, 245, 0.5)",padding:"15px",borderRadius:"4px"},children:[e.jsx("div",{children:e.jsx("strong",{children:"You will lose:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"All Gold & Treasury"}),e.jsx("li",{children:"All Estates (Buildings)"}),e.jsx("li",{children:"Workforce (Laborers & Specialists)"}),e.jsx("li",{children:"Royal Scepter Levels"}),e.jsxs("li",{children:[e.jsx("strong",{children:"Unfinished National Projects"})," (Progress & Resources)"]})]}),e.jsx("div",{children:e.jsx("strong",{children:"You will keep:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"Achievements"}),e.jsxs("li",{children:["Current Renown (",R(t.renown,t.numberFormat),")"]}),e.jsx("li",{children:"Completed National Project Levels"}),e.jsx("li",{children:"Lifetime Stats & Leaderboard Rank"})]})]}),h&&e.jsx("div",{style:{marginBottom:"20px",padding:"10px",background:"rgba(255, 0, 0, 0.1)",border:"1px solid red",borderRadius:"4px",color:"#d32f2f",fontSize:"0.9rem",fontWeight:"bold",textAlign:"center"},children:"âš ï¸ WARNING: You have a National Project under construction! Abdication will cancel the construction. All progress and resources invested in the pending level will be lost."}),e.jsxs("div",{style:{fontSize:"1.2rem",marginBottom:"20px"},children:[e.jsxs("div",{style:{marginBottom:"5px",fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Current Renown: ",R(t.renown,t.numberFormat)]}),e.jsxs("div",{style:{marginBottom:"5px",fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Total Renown: ",R(t.totalRenownEarned,t.numberFormat)," (+",j.toNumber().toFixed(1),"%)"]}),e.jsx("hr",{style:{margin:"15px 0",borderTop:"1px dashed #ccc",borderBottom:"none"}}),e.jsxs("div",{style:{marginBottom:"5px",fontSize:"0.9rem",color:"var(--text-secondary)"},children:[e.jsx("strong",{children:"Renown Gain:"})," +",R(p,t.numberFormat)]}),e.jsxs("div",{style:{marginBottom:"5px",fontSize:"0.9rem",color:"var(--text-secondary)"},children:[e.jsx("strong",{children:"Total After Prestige:"})," ",R(t.totalRenownEarned.plus(p),t.numberFormat)," (+",k.toNumber().toFixed(1),"% bonus)"]}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"10px",background:"rgba(0,0,0,0.05)",padding:"5px",borderRadius:"4px"},children:[e.jsxs("div",{children:["Next Renown at: ",e.jsx("strong",{children:R(b,t.numberFormat)})," Lifetime Gold"]}),e.jsxs("div",{style:{color:u.gt(0)?"#cc0000":"var(--success-color)",fontWeight:"bold"},children:["(Need ",R(u.gt(0)?u:s(0),t.numberFormat)," more)"]})]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"20px"},children:[e.jsx("button",{className:"btn",style:{background:"#666"},onClick:a,children:"Cancel"}),e.jsx("button",{className:"btn",style:{background:"#673ab7"},onClick:r,disabled:!n,children:n?"Abdicate":o.lt(i)?`Need ${R(f,t.numberFormat)} more Gold`:"Prestige Unavailable"})]})]})})},nt=({gameState:t,onClose:r,onHardReset:a,onSave:d,onSetTheme:i,onSetNumberFormat:o,onToggleIdleMode:p,onUpdateInterface:n,onOpenPromoCodes:f,onChangeName:l})=>{var N,m,M,S,E;const[b,u]=J.useState(!1),x=t.interface||{density:"normal",showFloatingText:!0,showWeatherWidget:!0,reduceMotion:!1,crownAnimations:!0,layout:{left:s(1),center:s(1),right:s(1)}},j=(N=x.layout.left)!=null&&N.toNumber?x.layout.left.toNumber():Number(x.layout.left),g=(m=x.layout.center)!=null&&m.toNumber?x.layout.center.toNumber():Number(x.layout.center),k=(M=x.layout.right)!=null&&M.toNumber?x.layout.right.toNumber():Number(x.layout.right),h=()=>{b?a():u(!0)},w=(c,A)=>{n({layout:O(G({},x.layout),{[c]:s(A)})})},C={marginBottom:"8px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px",background:"rgba(0,0,0,0.03)",borderRadius:"4px"},T={width:"100%",marginBottom:"5px"};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[e.jsx("h2",{children:"âš™ï¸ Royal Settings"}),t.playerProfile&&e.jsxs("div",{style:{backgroundColor:"rgba(191, 144, 0, 0.1)",border:"2px solid var(--gold-color)",borderRadius:"4px",padding:"12px",marginBottom:"20px",textAlign:"center"},children:[e.jsxs("div",{style:{color:"var(--gold-color)",fontSize:"16px",fontWeight:"bold"},children:["ðŸ‘‘ Your Ruler: ",t.playerProfile.rulerName," ",t.playerProfile.rulerId,t.playerProfile.specialIcon&&e.jsx("span",{style:{marginLeft:"5px"},children:t.playerProfile.specialIcon}),t.playerProfile.specialTitle&&e.jsx("span",{style:{marginLeft:"5px",color:"var(--accent-color)",fontSize:"14px"},children:t.playerProfile.specialTitle})]}),e.jsx("div",{style:{color:"var(--text-secondary)",fontSize:"12px",marginTop:"5px"},children:"Registered in Leaderboard System"})]}),e.jsxs("div",{style:{textAlign:"left",marginBottom:"20px",maxHeight:"60vh",overflowY:"auto",paddingRight:"5px",flex:1,overflowX:"hidden",WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:[e.jsx("h3",{style:{marginBottom:"10px"},children:"Layout Configuration"}),e.jsxs("div",{style:{marginBottom:"15px",background:"rgba(0,0,0,0.03)",padding:"10px",borderRadius:"4px"},children:[e.jsx("div",{style:{fontSize:"0.9rem",marginBottom:"5px",fontWeight:"bold"},children:"Column Widths (Ratio)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr auto",gap:"10px",alignItems:"center",marginBottom:"5px"},children:[e.jsx("span",{style:{fontSize:"0.8rem"},children:"Left"}),e.jsx("input",{type:"range",min:"1",max:"5",step:"0.5",value:j,onChange:c=>w("left",parseFloat(c.target.value)),style:T}),e.jsx("span",{style:{fontSize:"0.8rem"},children:j})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr auto",gap:"10px",alignItems:"center",marginBottom:"5px"},children:[e.jsx("span",{style:{fontSize:"0.8rem"},children:"Center"}),e.jsx("input",{type:"range",min:"1",max:"5",step:"0.5",value:g,onChange:c=>w("center",parseFloat(c.target.value)),style:T}),e.jsx("span",{style:{fontSize:"0.8rem"},children:g})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr auto",gap:"10px",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"0.8rem"},children:"Right"}),e.jsx("input",{type:"range",min:"1",max:"5",step:"0.5",value:k,onChange:c=>w("right",parseFloat(c.target.value)),style:T}),e.jsx("span",{style:{fontSize:"0.8rem"},children:k})]})]}),e.jsx("div",{style:{borderTop:"1px dashed #ccc",margin:"15px 0"}}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("div",{style:{fontSize:"0.9rem",marginBottom:"5px",fontWeight:"bold"},children:"Preset Themes"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"5px",justifyContent:"center"},children:Object.values(Se).map(c=>e.jsx("button",{className:"btn",style:{background:t.theme===c.id?"var(--accent-color)":"var(--panel-bg)",color:t.theme===c.id?"var(--text-on-accent)":"var(--text-color)",border:"1px solid var(--border-color)",fontSize:"0.8rem",padding:"5px 10px",minWidth:"120px",textAlign:"center"},onClick:()=>i(c.id),children:c.name},c.id))})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("div",{style:{fontSize:"0.9rem",marginBottom:"5px",fontWeight:"bold"},children:"Layout Density"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"5px",justifyContent:"center"},children:["compact","normal","spacious"].map(c=>e.jsx("button",{className:"btn",style:{background:x.density===c?"var(--accent-color)":"var(--panel-bg)",color:x.density===c?"var(--text-on-accent)":"var(--text-color)",border:"1px solid var(--border-color)",fontSize:"0.8rem",textTransform:"capitalize",minWidth:"120px",textAlign:"center",padding:"5px 10px"},onClick:()=>n({density:c}),children:c},c))})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("div",{style:{fontSize:"0.9rem",marginBottom:"5px",fontWeight:"bold"},children:"Number Format"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"5px",justifyContent:"center"},children:["standard","scientific","plain"].map(c=>e.jsx("button",{className:"btn",style:{background:t.numberFormat===c?"var(--accent-color)":"var(--panel-bg)",color:t.numberFormat===c?"var(--text-on-accent)":"var(--text-color)",border:"1px solid var(--border-color)",fontSize:"0.8rem",padding:"5px 10px",textTransform:"capitalize",minWidth:"120px",textAlign:"center"},onClick:()=>o(c),children:c},c))})]}),e.jsx("div",{style:{borderTop:"1px dashed #ccc",margin:"15px 0"}}),e.jsxs("div",{style:C,children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem"},children:"Cinematic Idle Mode"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Show landscape when inactive. Wait 30 seconds after enabling."})]}),e.jsx("button",{className:"btn",style:{background:t.idleModeEnabled?"var(--success-color)":"#9e9e9e",minWidth:"60px"},onClick:p,children:t.idleModeEnabled?"ON":"OFF"})]}),e.jsxs("div",{style:C,children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem"},children:"Click Text"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Show floating numbers on click."})]}),e.jsx("button",{className:"btn",style:{background:x.showFloatingText?"var(--success-color)":"#9e9e9e",minWidth:"60px"},onClick:()=>n({showFloatingText:!x.showFloatingText}),children:x.showFloatingText?"ON":"OFF"})]}),e.jsxs("div",{style:C,children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem"},children:"Weather Widget"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Show weather info in top left."})]}),e.jsx("button",{className:"btn",style:{background:x.showWeatherWidget?"var(--success-color)":"#9e9e9e",minWidth:"60px"},onClick:()=>n({showWeatherWidget:!x.showWeatherWidget}),children:x.showWeatherWidget?"ON":"OFF"})]}),e.jsxs("div",{style:C,children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem"},children:"Crown Animations"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Show crown effects and animations."})]}),e.jsx("button",{className:"btn",style:{background:x.crownAnimations?"var(--success-color)":"#9e9e9e",minWidth:"60px"},onClick:()=>n({crownAnimations:!x.crownAnimations}),children:x.crownAnimations?"ON":"OFF"})]}),e.jsxs("div",{style:C,children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem"},children:"Animations"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Enable visual effects and animations."})]}),e.jsx("button",{className:"btn",style:{background:x.reduceMotion?"#9e9e9e":"var(--success-color)",minWidth:"60px"},onClick:()=>n({reduceMotion:!x.reduceMotion}),children:x.reduceMotion?"OFF":"ON"})]})]}),e.jsxs("div",{style:{borderTop:"2px solid #ccc",paddingTop:"15px",marginTop:"15px",flexShrink:0},children:[e.jsx("h3",{children:"System"}),e.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn",onClick:d,children:"Force Save"}),e.jsx("button",{className:"btn",onClick:l,style:{background:"#2e7d32"},disabled:!((S=t.playerProfile)!=null&&S.hasChosenName),title:(E=t.playerProfile)!=null&&E.hasChosenName?"Change your ruler name":"Choose a ruler name first!",children:"Change Name"}),e.jsx("button",{className:"btn",onClick:f,style:{background:"#9c27b0"},children:"Promo Codes"}),e.jsx("button",{className:"btn",style:{backgroundColor:b?"red":"#d32f2f"},onClick:h,children:b?"CONFIRM WIPE?":"Hard Reset"})]}),b&&e.jsx("div",{style:{color:"red",fontSize:"0.8rem",marginTop:"5px"},children:"Warning: This will delete all progress permanently!"})]}),e.jsx("button",{className:"btn",style:{marginTop:"20px",background:"#5d4037",width:"100%",flexShrink:0},onClick:r,children:"Return to Game"}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-secondary)",marginTop:"10px",flexShrink:0},children:"v2.3.0 - Kingdom Clicker"})]})})},it=({onClose:t})=>e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{maxWidth:"600px",maxHeight:"80vh",display:"flex",flexDirection:"column"},children:[e.jsx("h2",{children:"ðŸ“œ Royal Chronicles"}),e.jsx("div",{style:{overflowY:"auto",textAlign:"left",padding:"0 20px",flex:1},children:de.map((r,a)=>e.jsxs("div",{style:{marginBottom:"20px",borderBottom:a<de.length-1?"1px dashed #ccc":"none",paddingBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[e.jsxs("span",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"var(--accent-color)"},children:["v",r.version]}),e.jsx("span",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:r.date})]}),e.jsx("ul",{style:{margin:"5px 0",paddingLeft:"20px"},children:r.changes.map((d,i)=>e.jsx("li",{style:{marginBottom:"3px"},children:d},i))})]},r.version))}),e.jsx("button",{className:"btn",style:{marginTop:"20px",alignSelf:"center"},onClick:t,children:"Close Chronicles"})]})}),st=({gameState:t,currentGps:r,onClose:a})=>{var w,C;const d=Object.values(t.buildings).reduce((T,N)=>T.plus(N),s(0)),i=t.achievements.length,o=Ne.length;let p="None",n="None",f=-1,l=s(0);V.forEach((T,N)=>{const m=t.buildings[T.id]||s(0);m.gt(s(0))&&N>f&&(f=N,p=T.name),m.gt(l)&&(l=m,n=T.name)});const u=(()=>{var I;const T=s(1),N=t.clickUpgradeLevel||0,m=Math.min(N,15),M=s(2).pow(m),S=T.times(M),E=Z(t.totalRenownEarned);let c=S;E.gt(s(1))&&(c=S.times(E));const A=ee(N);if(A>0){let L=s(0);V.forEach(P=>{const X=t.buildings[P.id]||s(0);X.gt(0)&&(L=L.plus(X.times(P.baseProduction)))});let y=L;E.gt(s(1))&&(y=L.times(E));let W=0;t.nationalProjects&&Object.values(t.nationalProjects).forEach(P=>W+=P.level||0);const v=s(1).plus(s(W*oe));y=y.times(v);const F=((I=t.weather)==null?void 0:I.current)||"clear";let D=s(0);V.forEach(P=>{const X=t.buildings[P.id]||s(0);if(X.gt(0)){let _=s(1);F==="sunny"?(P.id==="peasant"||P.id==="field"||P.id==="stable"||P.id==="cathedral")&&(_=s(1.2)):F==="rainy"?(P.id==="silver_mine"||P.id==="alchemist"||P.id==="market"||P.id==="tavern")&&(_=s(1.2)):F==="stormy"?((P.id==="blacksmith"||P.id==="void_portal")&&(_=s(1.3)),(P.id==="field"||P.id==="stable")&&(_=s(.8))):F==="windy"&&(P.id==="market"||P.id==="castle"||P.id==="time_chamber")&&(_=s(1.15));const se=X.times(P.baseProduction);E.gt(s(1))?D=D.plus(se.times(E).times(v).times(_.minus(s(1)))):D=D.plus(se.times(v).times(_.minus(s(1))))}});const Y=y.plus(D),ye=s(1).plus(s(t.achievements.length*.02)),ne=Y.times(ye);let ie=ne;t.globalIncomeMultiplier&&(ie=ne.times(s(t.globalIncomeMultiplier))),c=c.plus(ie.times(A))}const z=s(1).plus(s(t.achievements.length*.02));return c=c.times(z),t.globalIncomeMultiplier&&(c=c.times(s(t.globalIncomeMultiplier))),c})(),[x,j]=B.useState("");B.useEffect(()=>{const T=()=>{const m=s(Date.now()).minus(t.startTime),M=m.dividedBy(s(1e3)),S=M.minus(M.dividedBy(s(60)).floor().times(s(60))).floor(),E=m.dividedBy(s(6e4)),c=E.minus(E.dividedBy(s(60)).floor().times(s(60))).floor(),A=m.dividedBy(s(36e5)),z=A.minus(A.dividedBy(s(24)).floor().times(s(24))).floor(),I=m.dividedBy(s(864e5)).floor();let L="";I.gt(s(0))&&(L+=`${I.toString()}d `),z.gt(s(0))&&(L+=`${z.toString()}h `),L+=`${c.toString()}m ${S.toString()}s`,j(L)};T();const N=setInterval(T,1e3);return()=>clearInterval(N)},[t.startTime]);const g={display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px dashed rgba(0,0,0,0.1)",fontSize:"0.9rem"},k={fontSize:"1rem",color:"var(--accent-color)",marginTop:"15px",borderBottom:"2px solid var(--border-color)",paddingBottom:"2px",marginBottom:"5px"},h=(w=t.weather)!=null&&w.current&&((C=Re[t.weather.current])==null?void 0:C.name)||"Unknown";return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{maxWidth:"500px",maxHeight:"90vh",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsx("h2",{style:{flexShrink:0},children:"ðŸ“Š Royal Records"}),e.jsxs("div",{style:{textAlign:"left",marginBottom:"20px",overflowY:"auto",paddingRight:"10px",flex:1,minHeight:0},children:[e.jsx("h3",{style:k,children:"âš¡ Current Status"}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Gold Per Second:"}),e.jsxs("strong",{style:{color:"var(--success-color)"},children:[R(r,t.numberFormat)," / sec"]})]}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Click Power:"}),e.jsxs("strong",{style:{color:"var(--success-color)"},children:[R(u,t.numberFormat)," / click"]})]}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Current Weather:"}),e.jsx("strong",{children:h})]}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Current Renown:"}),e.jsx("strong",{style:{color:"#673ab7"},children:R(t.renown,t.numberFormat)})]}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Total Renown Earned:"}),e.jsx("strong",{style:{color:"#9575cd"},children:R(t.totalRenownEarned,t.numberFormat)})]}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Renown Bonus:"}),e.jsxs("strong",{style:{color:"#9575cd"},children:["+",Z(t.totalRenownEarned).minus(s(1)).times(s(100)).toNumber().toString(),"%"]})]}),e.jsx("h3",{style:k,children:"â³ Time & Legacy"}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Time Played:"}),e.jsx("strong",{children:x})]}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Kingdom Founded:"}),e.jsx("span",{children:new Date(t.startTime.toNumber()).toLocaleDateString()})]}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Total Renown:"}),e.jsx("strong",{children:R(t.renown,t.numberFormat)})]}),e.jsx("h3",{style:k,children:"ðŸ’° Economy Summary"}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Current Gold:"}),e.jsx("strong",{children:R(t.gold,t.numberFormat)})]}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Lifetime Gold:"}),e.jsx("strong",{children:R(t.totalGold,t.numberFormat)})]}),e.jsx("h3",{style:k,children:"ðŸ° Dominion"}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Total Buildings:"}),e.jsx("strong",{children:R(d,t.numberFormat)})]}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Highest Tech Building:"}),e.jsx("strong",{children:p})]}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Most Numerous:"}),e.jsxs("strong",{children:[n," (",R(l,t.numberFormat),")"]})]}),e.jsx("h3",{style:k,children:"ðŸ“ˆ Player Stats"}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Manual Clicks:"}),e.jsx("span",{children:R(t.stats.totalClicks,t.numberFormat)})]}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Dragons Slain:"}),e.jsx("span",{children:R(t.stats.dragonsKilled,t.numberFormat)})]}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Tavern Games:"}),e.jsx("span",{children:R(t.stats.tavernGamesPlayed,t.numberFormat)})]}),e.jsx("h3",{style:k,children:"ðŸŽ–ï¸ Completion"}),e.jsxs("div",{style:g,children:[e.jsx("span",{children:"Achievements:"}),e.jsxs("span",{children:[i," / ",o," (",Math.floor(i/o*100),"%)"]})]}),e.jsx("h3",{style:k,children:"ðŸ† Achievements"}),e.jsx(ze,{gameState:t})]}),e.jsx("button",{className:"btn",style:{background:"#5d4037",width:"100%",flexShrink:0},onClick:a,children:"Close Records"})]})})},Oe=[0,10,25,50,100,150,200,250,300,350,400,450,500,550,550,600],lt=({gameState:t,onStartProject:r,onUpgradeClickPower:a,onUpgradeOffline:d,onClose:i})=>{const[o,p]=B.useState("royalScepter"),n=x=>{var m;const j=s(1),g=Math.min(x,15),k=s(2).pow(g),h=j.times(k),w=Z(t.totalRenownEarned);let C=h;w.gt(s(1))&&(C=h.times(w));const T=ee(x);if(T>0){let M=s(0);V.forEach(v=>{const F=t.buildings[v.id]||s(0);F.gt(0)&&(M=M.plus(F.times(v.baseProduction)))});let S=M;w.gt(s(1))&&(S=M.times(w));let E=0;t.nationalProjects&&Object.values(t.nationalProjects).forEach(v=>E+=v.level||0);const c=s(1).plus(s(E*oe));S=S.times(c);const A=((m=t.weather)==null?void 0:m.current)||"clear";let z=s(0);V.forEach(v=>{const F=t.buildings[v.id]||s(0);if(F.gt(0)){let D=s(1);A==="sunny"?(v.id==="peasant"||v.id==="field"||v.id==="stable"||v.id==="cathedral")&&(D=s(1.2)):A==="rainy"?(v.id==="silver_mine"||v.id==="alchemist"||v.id==="market"||v.id==="tavern")&&(D=s(1.2)):A==="stormy"?((v.id==="blacksmith"||v.id==="void_portal")&&(D=s(1.3)),(v.id==="field"||v.id==="stable")&&(D=s(.8))):A==="windy"&&(v.id==="market"||v.id==="castle"||v.id==="time_chamber")&&(D=s(1.15));const Y=F.times(v.baseProduction);w.gt(s(1))?z=z.plus(Y.times(w).times(c).times(D.minus(s(1)))):z=z.plus(Y.times(c).times(D.minus(s(1))))}});const I=S.plus(z),L=s(1).plus(s(t.achievements.length*.02)),y=I.times(L);let W=y;t.globalIncomeMultiplier&&(W=y.times(s(t.globalIncomeMultiplier))),C=C.plus(W.times(T))}const N=s(1).plus(s(t.achievements.length*.02));return C=C.times(N),t.globalIncomeMultiplier&&(C=C.times(s(t.globalIncomeMultiplier))),C};if(!(t.buildings.field||s(0)).gt(0))return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("h2",{children:"ðŸ—ï¸ National Projects"}),e.jsxs("div",{style:{padding:"20px",color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"10px"},children:"ðŸ”’"}),e.jsx("p",{children:"You must establish a functioning economy before launching national projects."}),e.jsx("p",{style:{fontWeight:"bold",color:"var(--accent-color)"},children:"Requirement: Build a Wheat Field."})]}),e.jsx("button",{className:"btn",onClick:i,children:"Close"})]})});const b=()=>e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"15px"},children:Te.map(x=>{var z;const j=t.buildings[x.id]||s(0);if(j.lt(10))return null;const g=t.nationalProjects[x.id]||{level:0,active:!1,startTime:0,endTime:0},k=g.level,h=k>=ce,w=g.active,C=k+1,T=Be(x.id,C),N=Oe[C]||0,m=j.gte(N),M=t.gold.gte(T.gold),S=M&&m;let E=0,c=0;if(w){const I=Date.now(),L=g.endTime-g.startTime,y=I-g.startTime;E=Math.min(100,y/L*100),c=Math.max(0,Math.ceil((g.endTime-I)/1e3))}const A=((z=V.find(I=>I.id===x.id))==null?void 0:z.name)||"Building";return e.jsxs("div",{style:{border:"2px solid var(--border-color)",borderRadius:"8px",background:w?"#fff8e1":"var(--bg-color)",overflow:"hidden",position:"relative"},children:[e.jsxs("div",{style:{padding:"10px",background:w?"var(--accent-color)":"rgba(0,0,0,0.05)",color:w?"#fff":"var(--text-color)",fontWeight:"bold",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:x.name.replace(" Infrastructure","")}),e.jsxs("span",{children:["Lvl ",k," / ",ce]})]}),e.jsxs("div",{style:{padding:"15px"},children:[e.jsx("div",{style:{fontSize:"0.85rem",color:w?"#000000":"var(--text-color)",marginBottom:"10px",fontStyle:"italic"},children:x.description}),e.jsxs("div",{style:{marginBottom:"10px",fontSize:"0.9rem",color:"var(--success-color)",fontWeight:"bold"},children:["Current Bonus: +",(k*oe*100).toFixed(0),"% Global"]}),w?e.jsxs("div",{children:[e.jsx("div",{style:{width:"100%",height:"10px",background:"#ccc",borderRadius:"5px",overflow:"hidden",marginBottom:"5px"},children:e.jsx("div",{style:{width:`${E}%`,height:"100%",background:"var(--success-color)",transition:"width 1s linear"}})}),e.jsxs("div",{style:{textAlign:"center",fontSize:"0.8rem",color:"#3e2723"},children:["Under Construction... ",c,"s remaining"]})]}):h?e.jsx("div",{style:{textAlign:"center",padding:"10px",color:"var(--gold-color)",fontWeight:"bold",border:"1px solid var(--gold-color)",borderRadius:"4px",background:"rgba(255, 215, 0, 0.1)"},children:"MAXIMUM LEVEL REACHED"}):e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.85rem",marginBottom:"10px",background:"rgba(255,255,255,0.5)",padding:"5px",borderRadius:"4px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:"Next Level Requirements:"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"5px"},children:[e.jsxs("span",{style:{color:M?"green":"red"},children:["ðŸ’° ",R(T.gold)," Gold"]}),e.jsxs("span",{style:{color:m?"green":"red"},children:["ðŸ  ",R(s(N))," ",A,"s"]})]}),e.jsx("div",{style:{marginTop:"5px",fontSize:"0.8rem"},children:"â³ Duration: 5 seconds"})]}),e.jsx("button",{className:"btn",style:{width:"100%",background:S?"var(--accent-color)":"var(--border-color)",cursor:S?"pointer":"not-allowed"},disabled:!S,onClick:()=>r(x.id),children:"Start Project (Units Consumed)"})]})]})]},x.id)})}),u=()=>{const x=t.clickUpgradeLevel||0,j=x>=xe,g=x+1,k=We(g),h=t.gold.gte(k),w=s(2).pow(Math.min(x,15)),C=ee(x),T=n(x);C>0?`${R(w)}${(C*100).toFixed(1)}`:R(w);const N=s(2).pow(Math.min(g,15)),m=ee(g),M=n(g);m>0?`${R(N)}${(m*100).toFixed(1)}`:R(N);const S=t.offlineUpgradeLevel||0,E=S>=Q,c=S+1,A=Ae(c),z=t.renown.gte(A),{efficiency:I,duration:L}=pe(S),{efficiency:y,duration:W}=pe(c),v=F=>{const D=Math.floor(F/3600),Y=Math.floor(F%3600/60);return D>0?`${D}h ${Y}m`:`${Y}m`};return e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"15px"},children:[e.jsxs("div",{style:{border:"2px solid var(--border-color)",borderRadius:"8px",background:"var(--bg-color)",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"10px",background:"rgba(0,0,0,0.05)",color:"var(--text-color)",fontWeight:"bold",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"ðŸ‘‘ Royal Scepter"}),e.jsxs("span",{children:["Lvl ",x," / ",xe]})]}),e.jsxs("div",{style:{padding:"15px"},children:[e.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginBottom:"10px",fontStyle:"italic"},children:"Enhance your royal authority to increase click power."}),e.jsxs("div",{style:{marginBottom:"10px",fontSize:"0.9rem",color:"var(--success-color)",fontWeight:"bold"},children:["Current Power: ",R(T)]}),j?e.jsx("div",{style:{textAlign:"center",padding:"10px",color:"var(--gold-color)",fontWeight:"bold",border:"1px solid var(--gold-color)",borderRadius:"4px",background:"rgba(255, 215, 0, 0.1)"},children:"MAXIMUM LEVEL REACHED"}):e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.85rem",marginBottom:"10px",background:"rgba(255,255,255,0.5)",padding:"5px",borderRadius:"4px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:"Next Level:"}),e.jsxs("div",{style:{marginBottom:"5px"},children:["Power: ",R(M)]}),e.jsxs("div",{style:{color:h?"green":"red",fontWeight:"bold"},children:["ðŸ’° ",R(k)," Gold"]})]}),e.jsx("button",{className:"btn",style:{width:"100%",background:h?"var(--accent-color)":"var(--border-color)",cursor:h?"pointer":"not-allowed"},disabled:!h,onClick:a,children:"Upgrade Scepter"})]})]})]}),e.jsxs("div",{style:{border:"2px solid var(--border-color)",borderRadius:"8px",background:"var(--bg-color)",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"10px",background:"rgba(0,0,0,0.05)",color:"var(--text-color)",fontWeight:"bold",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"ðŸ’¤ Offline Production"}),e.jsxs("span",{children:["Lvl ",S," / ",Q]})]}),e.jsxs("div",{style:{padding:"15px"},children:[e.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginBottom:"10px",fontStyle:"italic"},children:["Improve the efficiency of your kingdom while you are away.",e.jsx("br",{}),"â±ï¸ Higher levels increase both efficiency % and maximum production time."]}),e.jsxs("div",{style:{marginBottom:"10px",fontSize:"0.9rem",color:"var(--success-color)",fontWeight:"bold"},children:["Current: ",(I*100).toFixed(0),"% for ",v(L)]}),!E&&e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("div",{style:{width:"100%",height:"8px",background:"#ccc",borderRadius:"4px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${S/Q*100}%`,height:"100%",background:"var(--success-color)",transition:"width 0.3s ease"}})}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"2px"},children:[Q-S," levels to max"]})]}),E?e.jsx("div",{style:{textAlign:"center",padding:"10px",color:"var(--gold-color)",fontWeight:"bold",border:"1px solid var(--gold-color)",borderRadius:"4px",background:"rgba(255, 215, 0, 0.1)"},children:"MAXIMUM LEVEL REACHED"}):e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.85rem",marginBottom:"10px",background:"rgba(255,255,255,0.5)",padding:"5px",borderRadius:"4px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:"Next Level:"}),e.jsxs("div",{style:{marginBottom:"5px"},children:["Effect: ",(y*100).toFixed(0),"% for ",v(W)]}),e.jsxs("div",{style:{color:z?"#673ab7":"red",fontWeight:"bold"},children:["ðŸ‘‘ ",R(A)," Renown"]})]}),e.jsx("button",{className:"btn",style:{width:"100%",background:z?"#673ab7":"var(--border-color)",cursor:z?"pointer":"not-allowed"},disabled:!z,onClick:d,children:"Upgrade Passive Income"})]})]})]})]})};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{maxWidth:"1000px",width:"95%",height:"85vh",display:"flex",flexDirection:"column",padding:"0"},children:[e.jsxs("div",{style:{padding:"20px",background:"var(--accent-color)",color:"var(--text-on-accent)"},children:[e.jsx("h2",{style:{margin:0,border:"none",color:"var(--gold-color)"},children:"ðŸ›ï¸ National Projects"}),e.jsx("p",{style:{margin:"5px 0 0 0",fontSize:"0.9rem",opacity:.9},children:"Invest resources to permanently improve your kingdom's power. All improvements persist through prestige."})]}),e.jsxs("div",{style:{display:"flex",background:"var(--bg-color)",borderBottom:"2px solid var(--border-color)",padding:"0 20px"},children:[e.jsx("button",{className:"btn",style:{background:o==="infrastructure"?"var(--accent-color)":"transparent",border:"none",borderBottom:o==="infrastructure"?"3px solid var(--gold-color)":"3px solid transparent",borderRadius:"0",padding:"15px 20px",margin:"0",fontWeight:"bold",color:o==="infrastructure"?"var(--text-on-accent)":"var(--text-color)"},onClick:()=>p("infrastructure"),children:"ðŸ—ï¸ Infrastructure"}),e.jsx("button",{className:"btn",style:{background:o==="royalScepter"?"var(--accent-color)":"transparent",border:"none",borderBottom:o==="royalScepter"?"3px solid var(--gold-color)":"3px solid transparent",borderRadius:"0",padding:"15px 20px",margin:"0",fontWeight:"bold",color:o==="royalScepter"?"var(--text-on-accent)":"var(--text-color)"},onClick:()=>p("royalScepter"),children:"ðŸ‘‘ Royal Scepter"})]}),e.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px",background:"var(--panel-bg)"},children:[o==="infrastructure"&&b(),o==="royalScepter"&&u()]}),e.jsx("div",{style:{padding:"15px",borderTop:"1px solid var(--border-color)",textAlign:"right",background:"var(--bg-color)"},children:e.jsx("button",{className:"btn",onClick:i,children:"Return to Kingdom"})})]})})},He={apiKey:"AIzaSyA1Dw5M2Zk8bpTCjlU2Tuifvx0ZI3IeRv0",authDomain:"kingdomclicker-156dc.firebaseapp.com",projectId:"kingdomclicker-156dc",storageBucket:"kingdomclicker-156dc.firebasestorage.app",messagingSenderId:"496461589742",appId:"1:496461589742:web:e6413dfa2d1bbabd3ad7ff"},$e=Ee(He),U=Me($e);function Ue(){return`#${Math.floor(Math.random()*99999).toString().padStart(5,"0")}`}function Ye(){const t=new Date,r=t.getDay(),a=t.getDate()-r+(r===0?-6:1);return new Date(t.setDate(a))}function at(t){return $(this,null,function*(){var r,a,d;try{console.log("ðŸš€ Starting leaderboard submission for:",t.rulerName),console.log("ðŸ“Š Data to submit:",{rulerName:t.rulerName,rulerId:t.rulerId,gold:(r=t.gold)==null?void 0:r.toString(),renown:(a=t.renown)==null?void 0:a.toString(),achievements:t.achievements,totalClicks:(d=t.totalClicks)==null?void 0:d.toString(),period:t.period});const i=O(G({},t),{period:"alltime"}),o=O(G({},t),{period:"weekly"}),p=K(U,"leaderboard_alltime",t.rulerId),n=O(G({},i),{gold:Number(i.gold.toString()),achievements:Number(i.achievements),renown:Number(i.renown.toString()),totalClicks:i.totalClicks.toString(),timestamp:te()});i.buildings!==void 0&&(n.buildings=Number(i.buildings)),console.log("ðŸ“¤ Submitting alltime data:",n),yield q(p,n),console.log("âœ… Alltime data submitted successfully");const f=K(U,"leaderboard_weekly",t.rulerId),l=O(G({},o),{gold:Number(o.gold.toString()),achievements:Number(o.achievements),renown:Number(o.renown.toString()),totalClicks:o.totalClicks.toString(),timestamp:te()});return o.buildings!==void 0&&(l.buildings=Number(o.buildings)),console.log("ðŸ“¤ Submitting weekly data:",l),yield q(f,l),console.log("âœ… Weekly data submitted successfully"),{allTimeId:t.rulerId,weeklyId:t.rulerId}}catch(i){throw console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ Ð² Ð»Ð¸Ð´ÐµÑ€Ð±Ð¾Ñ€Ð´:"),console.error("Ð”ÐµÑ‚Ð°Ð»Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐ¸:",i),i instanceof Error&&(console.error("Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸:",i.message),console.error("Ð¡Ñ‚ÐµÐº Ð¾ÑˆÐ¸Ð±ÐºÐ¸:",i.stack)),"code"in i&&(console.error("ÐšÐ¾Ð´ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Firebase:",i.code),console.error("Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ:",i.customData)),i}})}function _e(t=100){return $(this,null,function*(){try{console.log("ðŸ” Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… all-time Ð»Ð¸Ð´ÐµÑ€Ð±Ð¾Ñ€Ð´Ð°...");const r=ge(he(U,"leaderboard_alltime"),me("gold","desc"),fe(t));console.log("ðŸ“¡ Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ðº Firestore...");const a=yield be(r);console.log("ðŸ“Š ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¾ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð²:",a.docs.length);const d=a.docs.map(i=>{const o=i.data();return O(G({id:i.id},o),{gold:o.gold instanceof H?o.gold:new H(o.gold),renown:o.renown instanceof H?o.renown:new H(o.renown),totalClicks:o.totalClicks instanceof H?o.totalClicks:typeof o.totalClicks=="string"?new H(o.totalClicks):new H(o.totalClicks),timestamp:o.timestamp})});return console.log("âœ… All-time Ð»Ð¸Ð´ÐµÑ€Ð±Ð¾Ñ€Ð´ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½, Ð·Ð°Ð¿Ð¸ÑÐµÐ¹:",d.length),d}catch(r){throw console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ all-time Ð»Ð¸Ð´ÐµÑ€Ð±Ð¾Ñ€Ð´Ð°:"),console.error("Ð”ÐµÑ‚Ð°Ð»Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐ¸:",r),r instanceof Error&&(console.error("Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸:",r.message),console.error("Ð¡Ñ‚ÐµÐº Ð¾ÑˆÐ¸Ð±ÐºÐ¸:",r.stack)),"code"in r&&console.error("ÐšÐ¾Ð´ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Firebase:",r.code),r}})}function Ve(t=100){return $(this,null,function*(){try{console.log("ðŸ” Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… weekly Ð»Ð¸Ð´ÐµÑ€Ð±Ð¾Ñ€Ð´Ð°...");const r=Ye();console.log("ðŸ“… ÐÐ°Ñ‡Ð°Ð»Ð¾ Ð½ÐµÐ´ÐµÐ»Ð¸:",r.toISOString());const a=ge(he(U,"leaderboard_weekly"),me("gold","desc"),fe(t));console.log("ðŸ“¡ Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ðº Firestore...");const d=yield be(a);console.log("ðŸ“Š ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¾ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð² Ð´Ð¾ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ð¸:",d.docs.length);const o=d.docs.map(p=>{const n=p.data();return O(G({id:p.id},n),{gold:n.gold instanceof H?n.gold:new H(n.gold),renown:n.renown instanceof H?n.renown:new H(n.renown),totalClicks:n.totalClicks instanceof H?n.totalClicks:typeof n.totalClicks=="string"?new H(n.totalClicks):new H(n.totalClicks),timestamp:n.timestamp})}).filter(p=>{var l,b;const n=((b=(l=p.timestamp)==null?void 0:l.toDate)==null?void 0:b.call(l))||new Date(p.timestamp),f=n>=r;return f||console.log("ðŸ—‘ï¸ Ð—Ð°Ð¿Ð¸ÑÑŒ Ð¾Ñ‚Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð²Ð°Ð½Ð° (ÑÑ‚Ð°Ñ€Ð°Ñ Ð´Ð°Ñ‚Ð°):",n.toISOString()),f});return console.log("âœ… Weekly Ð»Ð¸Ð´ÐµÑ€Ð±Ð¾Ñ€Ð´ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½, Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ Ð¿Ð¾ÑÐ»Ðµ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ð¸:",o.length),o}catch(r){throw console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ weekly Ð»Ð¸Ð´ÐµÑ€Ð±Ð¾Ñ€Ð´Ð°:"),console.error("Ð”ÐµÑ‚Ð°Ð»Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐ¸:",r),r instanceof Error&&(console.error("Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸:",r.message),console.error("Ð¡Ñ‚ÐµÐº Ð¾ÑˆÐ¸Ð±ÐºÐ¸:",r.stack)),"code"in r&&console.error("ÐšÐ¾Ð´ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Firebase:",r.code),r}})}function dt(t,r,a){return $(this,null,function*(){try{let d=0;const i={};Object.keys(t.buildings).forEach(f=>{const l=Number(t.buildings[f].toString());i[f]=l,d+=l});const o=Math.floor((Date.now()-Number(t.startTime.toString()))/1e3),p={rulerId:r,rulerName:a,totalBuildings:i,totalBuildingsPurchased:d,totalGoldSpent:t.totalGoldSpent||new H(0),totalGoldEarned:t.totalGold,totalClicks:t.stats.totalClicks,prestigeCount:t.prestigeCount||0,totalRenownEarned:t.totalRenownEarned,nationalProjects:Object.keys(t.nationalProjects||{}).reduce((f,l)=>(f[l]=t.nationalProjects[l].level||0,f),{}),clickUpgradeLevel:t.clickUpgradeLevel||0,offlineUpgradeLevel:t.offlineUpgradeLevel||0,tavernGamesPlayed:Number(t.stats.tavernGamesPlayed.toString()),dragonsKilled:Number(t.stats.dragonsKilled.toString()),achievements:t.achievements,playTime:o,lastUpdated:te(),createdAt:te()},n=K(U,"playerStats",r);yield q(n,O(G({},p),{totalGoldSpent:p.totalGoldSpent.toString(),totalGoldEarned:p.totalGoldEarned.toString(),totalClicks:p.totalClicks.toString(),totalRenownEarned:p.totalRenownEarned.toString()}),{merge:!0}),console.log("âœ… Player stats successfully saved")}catch(d){throw console.error("âŒ Error saving player stats:",d),d}})}function ct(t,r){return $(this,null,function*(){try{const a=K(U,"players",t);yield q(a,{rulerName:r},{merge:!0});const d=K(U,"leaderboard_alltime",t);yield q(d,{rulerName:r},{merge:!0});const i=K(U,"leaderboard_weekly",t);yield q(i,{rulerName:r},{merge:!0}),console.log("âœ… Ruler name successfully updated")}catch(a){throw console.error("âŒ Error updating ruler name:",a),a}})}const xt=({isOpen:t,onClose:r,onConfirm:a,gameState:d})=>{const[i,o]=B.useState(""),[p,n]=B.useState(!1);if(!t)return null;const f=()=>$(null,null,function*(){if(i.trim().length<3){alert("Ruler name must contain at least 3 characters!");return}if(i.trim().length>20){alert("Ruler name must not exceed 20 characters!");return}n(!0);try{const b={id:`player_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,rulerName:i.trim(),rulerId:Ue(),lastLeaderboardView:0,lastLeaderboardSubmit:0,hasChosenName:!0,usedPromoCodes:[]};a(b),r()}catch(l){alert("An error occurred while creating profile. Please try again.")}finally{n(!1)}});return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{backgroundColor:"#fdf6e3",border:"4px solid #8d6e63",borderRadius:"8px",padding:"32px",maxWidth:"500px",width:"90%",textAlign:"center",fontFamily:"Georgia, serif"},children:[e.jsx("h2",{style:{color:"#3e2723",marginBottom:"16px"},children:"ðŸ‘‘ Royal Coronation! ðŸ‘‘"}),e.jsxs("p",{style:{color:"#5d4037",marginBottom:"24px",lineHeight:"1.5"},children:["Congratulations! Your kingdom has reached ",e.jsx("strong",{children:Ke(d.gold)})," gold!",e.jsx("br",{}),"It's time to choose a name for your ruler and enter the history books!"]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("label",{style:{display:"block",color:"#3e2723",marginBottom:"8px",fontWeight:"bold"},children:"Ruler Name:"}),e.jsx("input",{type:"text",value:i,onChange:l=>o(l.target.value),placeholder:"Enter your name...",maxLength:20,style:{width:"100%",padding:"12px",border:"2px solid #a1887f",borderRadius:"4px",fontSize:"16px",fontFamily:"Arial, sans-serif",backgroundColor:"#fff",color:"#3e2723"},onKeyPress:l=>l.key==="Enter"&&f()}),e.jsxs("div",{style:{fontSize:"12px",color:"#8d6e63",marginTop:"4px",textAlign:"left"},children:[i.length,"/20 characters"]})]}),e.jsx("div",{style:{backgroundColor:"#fff3e0",border:"2px solid #bf9000",borderRadius:"4px",padding:"12px",marginBottom:"24px"},children:e.jsx("p",{style:{color:"#bf9000",margin:0,fontSize:"14px",fontWeight:"bold"},children:"âš ï¸ Important: You'll be able to join the leaderboard and compete with players from around the world!"})}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[e.jsx("button",{type:"button",onClick:f,disabled:p||i.trim().length<3,style:{padding:"12px 24px",backgroundColor:p||i.trim().length<3?"#cccccc":"#2e7d32",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",fontWeight:"bold",cursor:p||i.trim().length<3?"not-allowed":"pointer",fontFamily:"Georgia, serif"},children:p?"Creating profile...":"Ascend the Throne"}),e.jsx("button",{type:"button",onClick:r,style:{padding:"12px 24px",backgroundColor:"#c62828",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",cursor:"pointer",fontFamily:"Georgia, serif",transition:"background-color 0.2s"},onMouseOver:l=>{l.currentTarget.style.backgroundColor="#d32f2f"},onMouseOut:l=>{l.currentTarget.style.backgroundColor="#c62828"},children:"Later"})]})]})})};function Ke(t){return t.lt(1e3)?t.toFixed(0):t.lt(1e6)?t.toNumber().toLocaleString():t.toExponential(2)}const pt=({isOpen:t,onClose:r,playerProfile:a,onOpenRulerNameModal:d,gameState:i,onForceSubmit:o,addToast:p})=>{const[n,f]=B.useState([]),[l,b]=B.useState([]),[u,x]=B.useState("alltime"),[j,g]=B.useState(!1),[k,h]=B.useState(null),[w,C]=B.useState(0),[T,N]=B.useState(0),m=()=>{const y=localStorage.getItem("leaderboardCache");if(y)try{const{data:W,timestamp:v}=JSON.parse(y),F=Date.now(),D=3600*1e3;if(F-v<D&&W&&W.allTime&&W.weekly)return W}catch(W){console.error("Cache parse error:",W)}return null},M=y=>{const W={data:y,timestamp:Date.now()};localStorage.setItem("leaderboardCache",JSON.stringify(W)),N(Date.now())},S=()=>{const y=localStorage.getItem("leaderboardCache");if(y){const{timestamp:W}=JSON.parse(y),v=Date.now(),F=3600*1e3;return v-W<F}return!1};B.useEffect(()=>{if(t){if(S())try{const y=m();if(y){f(y.allTime),b(y.weekly);const W=JSON.parse(localStorage.getItem("leaderboardCache"));N(W.timestamp);return}}catch(y){console.error("Cache read error:",y)}E()}},[t]);const E=()=>$(null,null,function*(){g(!0),h(null);try{const y=new Promise((F,D)=>setTimeout(()=>D(new Error("Loading timeout")),1e4)),[W,v]=yield Promise.all([Promise.race([_e(50),y]),Promise.race([Ve(50),y])]);f(W),b(v),M({allTime:W,weekly:v})}catch(y){console.error("Error loading leaderboard:",y),h("Failed to load leaderboard. Please check your internet connection and try again.")}finally{g(!1)}}),c=y=>{switch(y){case 1:return"ðŸ¥‡";case 2:return"ðŸ¥ˆ";case 3:return"ðŸ¥‰";default:return`#${y}`}},A=()=>a?(u==="alltime"?n:l).findIndex(W=>W.rulerId===a.rulerId)+1:-1,z=()=>{const y=u==="alltime"?n:l;if(y.length>0){let W=0;if(y.forEach(v=>{if(v.timestamp){let F=0;typeof v.timestamp=="object"&&v.timestamp.toDate?F=v.timestamp.toDate().getTime():typeof v.timestamp=="number"?F=v.timestamp:typeof v.timestamp=="string"&&(F=new Date(v.timestamp).getTime()),F>W&&(W=F)}}),W>0)return W}return T},I=u==="alltime"?n:l,L=I.length>0;return t?e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{maxWidth:"800px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h2",{children:"ðŸ† Leaderboard ðŸ†"}),e.jsx("button",{className:"btn",onClick:r,children:"Close"})]}),!a&&e.jsxs("div",{style:{backgroundColor:"rgba(191, 144, 0, 0.1)",border:"2px solid var(--gold-color)",borderRadius:"4px",padding:"15px",marginBottom:"16px",textAlign:"center"},children:[e.jsx("h4",{style:{color:"var(--gold-color)",margin:"0 0 8px 0",fontSize:"14px"},children:"ðŸ‘ View Only Mode"}),e.jsxs("p",{style:{color:"var(--text-secondary)",margin:"0",fontSize:"12px",lineHeight:"1.4"},children:[e.jsx("strong",{children:"Anyone can view leaderboard!"})," Choose a name at 10M gold to participate."]}),d&&i&&i.gold&&i.gold.gte(1e7)&&e.jsx("button",{className:"btn",onClick:()=>{r(),d()},style:{backgroundColor:"var(--accent-color)",padding:"6px 12px",fontSize:"12px",marginTop:"8px"},children:"ðŸ‘‘ Choose Ruler Name"})]}),L&&e.jsx("div",{style:{backgroundColor:"rgba(191, 144, 0, 0.1)",border:"2px solid var(--gold-color)",borderRadius:"4px",padding:"12px",marginBottom:"16px",textAlign:"center",fontSize:"12px"},children:e.jsxs("span",{style:{color:"var(--gold-color)"},children:["ðŸ“Š Data updated ",Math.floor((Date.now()-z())/6e4)," minutes ago"]})}),j&&e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"var(--text-secondary)"},children:"Loading leaderboard data..."}),k&&e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"var(--danger-color)"},children:k}),a&&L&&e.jsxs("div",{style:{backgroundColor:"rgba(191, 144, 0, 0.1)",border:"2px solid var(--gold-color)",borderRadius:"4px",padding:"12px",marginBottom:"16px",textAlign:"center"},children:[e.jsxs("div",{style:{color:"var(--gold-color)",fontSize:"14px",fontWeight:"bold"},children:["ðŸ‘‘ You are playing as: ",a.rulerName," ",a.rulerId,a.specialIcon&&e.jsx("span",{style:{marginLeft:"5px"},children:a.specialIcon}),a.specialTitle&&e.jsx("span",{style:{marginLeft:"5px",color:"var(--accent-color)",fontSize:"12px"},children:a.specialTitle})]}),I.length>0&&e.jsxs("div",{style:{color:"var(--text-secondary)",fontSize:"12px",marginTop:"5px"},children:["Your Rank: ",A()>0?`#${A()}`:"Not ranked yet"," in ",u==="alltime"?"All Time":"Weekly"]})]}),L&&e.jsxs("div",{style:{display:"flex",marginBottom:"16px",borderBottom:"2px solid var(--border-color)"},children:[e.jsx("button",{onClick:()=>x("alltime"),className:u==="alltime"?"tab-btn active":"tab-btn",children:"All Time"}),e.jsx("button",{onClick:()=>x("weekly"),className:u==="weekly"?"tab-btn active":"tab-btn",children:"This Week"})]}),L&&!j&&!k&&e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto",border:"2px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--panel-bg)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{style:{backgroundColor:"var(--accent-color)",color:"white",position:"sticky",top:0},children:e.jsxs("tr",{children:[e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Rank"}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Ruler"}),e.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Gold"}),e.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Renown"}),e.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Clicks"}),e.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Achievements"})]})}),e.jsx("tbody",{children:I.map((y,W)=>e.jsxs("tr",{style:{backgroundColor:(a==null?void 0:a.rulerId)===y.rulerId?"rgba(191, 144, 0, 0.1)":W%2===0?"rgba(0, 0, 0, 0.02)":"transparent",borderBottom:"1px solid var(--border-color)"},children:[e.jsx("td",{style:{padding:"10px",fontWeight:"bold",color:"var(--text-color)"},children:c(W+1)}),e.jsx("td",{style:{padding:"10px",color:"var(--text-color)"},children:e.jsxs("div",{children:[e.jsxs("strong",{children:[y.rulerName,(a==null?void 0:a.specialIcon)&&a.rulerId===y.rulerId&&e.jsx("span",{style:{marginLeft:"5px"},children:a.specialIcon})]}),e.jsxs("div",{style:{fontSize:"12px",color:"var(--text-secondary)"},children:[y.rulerId,(a==null?void 0:a.specialTitle)&&a.rulerId===y.rulerId&&e.jsx("span",{style:{marginLeft:"5px",color:"var(--accent-color)"},children:a.specialTitle})]})]})}),e.jsx("td",{style:{padding:"10px",textAlign:"right",color:"var(--gold-color)",fontWeight:"bold"},children:R(y.gold,"standard")}),e.jsx("td",{style:{padding:"10px",textAlign:"right",color:"var(--text-secondary)"},children:R(y.renown,"standard")}),e.jsx("td",{style:{padding:"10px",textAlign:"right",color:"var(--text-secondary)"},children:R(y.totalClicks,"standard")}),e.jsx("td",{style:{padding:"10px",textAlign:"right",color:"var(--text-secondary)"},children:y.achievements})]},y.id))})]})}),e.jsx("div",{style:{marginTop:"16px",fontSize:"12px",color:"var(--text-secondary)",textAlign:"center"},children:"ðŸ’¡ Leaderboard updates automatically every hour. Data is cached for performance."})]})}):null},ut=({gained:t,effectiveTime:r,totalTime:a,efficiency:d,completedProjects:i,currentLevel:o,maxDuration:p,onClose:n,numberFormat:f})=>{const l=b=>{const u=Math.floor(b/3600),x=Math.floor(b%3600/60),j=Math.floor(b%60),g=[];return u>0&&g.push(`${u}h`),x>0&&g.push(`${x}m`),(j>0||g.length===0)&&g.push(`${j}s`),g.join(" ")};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{border:"4px solid var(--accent-color)"},children:[e.jsx("h2",{children:"ðŸŒ™ Welcome Back, Ruler!"}),e.jsxs("div",{style:{padding:"20px",textAlign:"left"},children:[e.jsx("p",{children:"Your kingdom continued to operate while you were away."}),e.jsxs("div",{style:{background:"var(--panel-bg)",border:"1px solid var(--border-color)",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[e.jsx("span",{children:"Time Away:"}),e.jsx("strong",{children:l(a.toNumber())})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[e.jsx("span",{children:"Effective Production Time:"}),e.jsx("strong",{children:l(r.toNumber())})]}),r.toNumber()<a.toNumber()&&e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",fontStyle:"italic",marginBottom:"5px",textAlign:"center"},children:["âš ï¸ Production time limited by upgrade level (max ",l(p),")"]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[e.jsx("span",{children:"Efficiency:"}),e.jsxs("strong",{children:[(d*100).toFixed(0),"% (Level ",o,"/20)"]})]}),e.jsx("div",{style:{borderTop:"1px dashed var(--border-color)",margin:"10px 0"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"1.2rem",color:"var(--gold-color)"},children:[e.jsx("span",{children:"Gold Earned:"}),e.jsxs("strong",{children:["+",R(t,f)]})]})]}),i.length>0&&e.jsxs("div",{children:[e.jsx("h3",{children:"âœ… Projects Completed"}),e.jsx("ul",{style:{paddingLeft:"20px",maxHeight:"150px",overflowY:"auto"},children:i.map((b,u)=>e.jsx("li",{style:{color:"var(--success-color)",marginBottom:"5px"},children:b},u))})]})]}),e.jsx("button",{className:"btn",onClick:n,style:{width:"100%",padding:"15px",fontSize:"1.1rem"},children:"Collect & Continue"})]})})},gt=({gameState:t,onClose:r,onRedeemPromoCode:a,onBackToSettings:d})=>{const[i,o]=J.useState(""),[p,n]=J.useState(""),[f,l]=J.useState("info"),[b,u]=J.useState(!1),x=N=>$(null,null,function*(){if(N.preventDefault(),!i.trim()){n("Please enter a promo code"),l("error");return}u(!0),n("");try{yield a(i),o(""),n("Promo code redeemed successfully!"),l("success")}catch(m){n("Error redeeming promo code"),l("error")}finally{u(!1)}}),j={position:"fixed",top:"0",left:"0",right:"0",bottom:"0",backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},g={backgroundColor:"#2c2416",border:"3px solid #8b7355",borderRadius:"12px",padding:"30px",maxWidth:"500px",width:"100%",color:"#f4e4c1",fontFamily:"Georgia, serif",boxShadow:"0 0 30px rgba(0, 0, 0, 0.8)",maxHeight:"80vh",overflowY:"auto"},k={textAlign:"center",fontSize:"2rem",marginBottom:"20px",color:"#d4af37",textShadow:"2px 2px 4px rgba(0, 0, 0, 0.5)"},h={width:"100%",padding:"12px",fontSize:"1rem",backgroundColor:"#1a1611",border:"2px solid #8b7355",borderRadius:"6px",color:"#f4e4c1",fontFamily:"Georgia, serif",textTransform:"uppercase",letterSpacing:"1px",marginBottom:"15px"},w={background:"#9c27b0",color:"white",border:"none",padding:"12px 24px",fontSize:"1rem",borderRadius:"6px",cursor:"pointer",fontFamily:"Georgia, serif",fontWeight:"bold",width:"100%",marginBottom:"10px",opacity:b?.7:1},C={background:"#5d4037",color:"white",border:"none",padding:"12px 24px",fontSize:"1rem",borderRadius:"6px",cursor:"pointer",fontFamily:"Georgia, serif",width:"100%"},T={padding:"10px",borderRadius:"6px",marginBottom:"15px",textAlign:"center",fontSize:"0.9rem",backgroundColor:f==="success"?"#2e7d32":f==="error"?"#c62828":"#1565c0",border:`1px solid ${f==="success"?"#4caf50":f==="error"?"#f44336":"#2196f3"}`};return e.jsx("div",{style:j,onClick:r,children:e.jsxs("div",{style:g,onClick:N=>N.stopPropagation(),children:[e.jsx("h2",{style:k,children:"ðŸŽ« Promo Codes"}),e.jsxs("form",{onSubmit:x,children:[e.jsx("input",{type:"text",value:i,onChange:N=>o(N.target.value),placeholder:"Enter promo code...",style:h,maxLength:50,disabled:b}),e.jsx("button",{type:"submit",style:w,disabled:b,children:b?"Redeeming...":"Redeem Code"})]}),p&&e.jsx("div",{style:T,children:p}),e.jsx("div",{style:{fontSize:"0.8rem",color:"#8b7355",textAlign:"center",marginBottom:"20px",fontStyle:"italic"},children:"Enter promotional codes to receive special rewards!"}),e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px"},children:[d&&e.jsx("button",{style:O(G({},C),{background:"#666"}),onClick:d,children:"Back to Settings"}),e.jsx("button",{style:O(G({},C),{flex:"1"}),onClick:r,children:"Close"})]})]})})},ht=({isOpen:t,onClose:r,onConfirm:a,currentName:d})=>{const[i,o]=B.useState(d),[p,n]=B.useState(!1);if(!t)return null;const f=()=>$(null,null,function*(){if(i.trim().length<3){alert("Ruler name must contain at least 3 characters!");return}if(i.trim().length>20){alert("Ruler name must not exceed 20 characters!");return}if(i.trim()===d.trim()){alert("New name must be different from current name!");return}n(!0);try{yield a(i.trim()),r()}catch(l){alert("Error changing name. Please try again.")}finally{n(!1)}});return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:3e3},children:e.jsxs("div",{style:{backgroundColor:"#fdf6e3",border:"4px solid #8d6e63",borderRadius:"8px",padding:"32px",maxWidth:"500px",width:"90%",textAlign:"center",fontFamily:"Georgia, serif"},children:[e.jsx("h2",{style:{color:"#3e2723",marginBottom:"16px"},children:"ðŸ‘‘ Change Ruler Name ðŸ‘‘"}),e.jsxs("p",{style:{color:"#5d4037",marginBottom:"24px",lineHeight:"1.5"},children:["Current name: ",e.jsx("strong",{children:d}),e.jsx("br",{}),"Enter new name for your ruler:"]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("label",{style:{display:"block",color:"#3e2723",marginBottom:"8px",fontWeight:"bold"},children:"New Name:"}),e.jsx("input",{type:"text",value:i,onChange:l=>o(l.target.value),placeholder:"Enter new name...",maxLength:20,style:{width:"100%",padding:"12px",border:"2px solid #a1887f",borderRadius:"4px",fontSize:"16px",fontFamily:"Arial, sans-serif",backgroundColor:"#fff",color:"#3e2723"},onKeyPress:l=>l.key==="Enter"&&f()}),e.jsxs("div",{style:{fontSize:"12px",color:"#8d6e63",marginTop:"4px",textAlign:"left"},children:[i.length,"/20 characters"]})]}),e.jsx("div",{style:{backgroundColor:"#fff3e0",border:"2px solid #bf9000",borderRadius:"4px",padding:"12px",marginBottom:"24px"},children:e.jsx("p",{style:{color:"#bf9000",margin:0,fontSize:"14px",fontWeight:"bold"},children:"âš ï¸ Warning: Name change will update your profile in leaderboard!"})}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[e.jsx("button",{type:"button",onClick:f,disabled:p||i.trim().length<3||i.trim()===d.trim(),style:{padding:"12px 24px",backgroundColor:p||i.trim().length<3||i.trim()===d.trim()?"#cccccc":"#2e7d32",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",fontWeight:"bold",cursor:p||i.trim().length<3||i.trim()===d.trim()?"not-allowed":"pointer",fontFamily:"Georgia, serif"},children:p?"Saving...":"Change Name"}),e.jsx("button",{type:"button",onClick:r,style:{padding:"12px 24px",backgroundColor:"#c62828",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",cursor:"pointer",fontFamily:"Georgia, serif",transition:"background-color 0.2s"},onMouseOver:l=>{l.currentTarget.style.backgroundColor="#d32f2f"},onMouseOut:l=>{l.currentTarget.style.backgroundColor="#c62828"},children:"Cancel"})]})]})})};export{it as C,lt as E,pt as L,ut as O,rt as P,xt as R,nt as S,ot as T,at as a,gt as b,st as c,ht as d,dt as s,ct as u};
