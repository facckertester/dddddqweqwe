var C=Object.defineProperty,S=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var B=(o,e,n)=>e in o?C(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n,R=(o,e)=>{for(var n in e||(e={}))N.call(e,n)&&B(o,n,e[n]);if(z)for(var n of z(e))L.call(e,n)&&B(o,n,e[n]);return o},I=(o,e)=>S(o,M(e));import{r as h,j as t}from"./vendor-react-CUeQczFW.js";import"./vendor-DdgGw12P.js";import{t as r,f as b,B as T,P as E}from"./core-C2y7dMvE.js";const D=({gameState:o,building:e,x:n,y:i,visible:s,onHide:a})=>{const l=h.useRef(null),[d,p]=h.useState({x:0,y:0});if(h.useEffect(()=>{if(!s||!l.current)return;const c=l.current.getBoundingClientRect();let g=n+15,f=i-c.height/2;g+c.width>window.innerWidth&&(g=n-c.width-15),f<10&&(f=10),f+c.height>window.innerHeight-10&&(f=window.innerHeight-c.height-10),p({x:g,y:f})},[s,n,i]),!s||!e)return null;const x=o.buildings[e.id]||r(0);if(!(o.totalGold.gte(e.baseCost)||x.gt(r(0))))return t.jsxs("div",{ref:l,className:"advanced-tooltip",style:{position:"fixed",left:`${d.x}px`,top:`${d.y}px`,background:"var(--panel-bg)",color:"var(--text-color)",padding:"12px",borderRadius:"2px",border:"4px double var(--accent-color)",fontSize:"15px",lineHeight:"1.4",width:"240px",minWidth:"240px",zIndex:1e4,boxShadow:"var(--shadow)",pointerEvents:"none",transition:"all 0.15s ease"},onMouseLeave:a,children:[t.jsxs("div",{style:{fontWeight:"bold",fontSize:"16px",marginBottom:"8px",color:"var(--accent-color)",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid var(--accent-color)",paddingBottom:"6px"},children:[t.jsx("span",{style:{fontSize:"20px"},children:"â“"}),t.jsx("span",{children:"???"})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(33, 150, 243, 0.1), rgba(33, 150, 243, 0.05))",borderRadius:"6px",border:"1px solid rgba(33, 150, 243, 0.3)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"rgba(33, 150, 243, 0.9)",fontWeight:"bold",fontSize:"13px"},children:"Count"}),t.jsx("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:"???"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05))",borderRadius:"6px",border:"1px solid rgba(76, 175, 80, 0.3)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"var(--success-color)",fontWeight:"bold",fontSize:"13px"},children:"Production"}),t.jsx("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:"???/s"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(255, 152, 0, 0.05))",borderRadius:"6px",border:"1px solid rgba(255, 152, 0, 0.3)"},children:[t.jsx("span",{style:{color:"#ff9800",fontWeight:"bold",fontSize:"13px"},children:"Income Share"}),t.jsx("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:"???%"})]})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(141, 110, 99, 0.1), rgba(141, 110, 99, 0.05))",borderRadius:"6px",border:"1px solid var(--accent-color)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"var(--accent-color)",fontWeight:"bold",fontSize:"13px"},children:"Next Building"}),t.jsx("span",{style:{color:"var(--accent-color)",fontWeight:"bold",fontSize:"14px"},children:"??? gold"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(156, 39, 176, 0.1), rgba(156, 39, 176, 0.05))",borderRadius:"6px",border:"1px solid rgba(156, 39, 176, 0.3)"},children:[t.jsx("span",{style:{color:"#9c27b0",fontWeight:"bold",fontSize:"13px"},children:"Each Produces"}),t.jsx("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:"???/s"})]})]}),t.jsx("div",{style:{padding:"6px",background:"rgba(0, 0, 0, 0.05)",borderRadius:"6px",borderTop:"1px solid var(--border-color)",fontSize:"11px",color:"var(--text-secondary)",fontStyle:"italic",textAlign:"center"},children:"???"})]});const y=o.buildings[e.id]||r(0),u=k(o,e),w=u.times(y),W=A(o),P=W.gt(0)?w.div(W).times(100):r(0),m=O(e.baseCost,y);return(m.gt(0)?u.div(m):r(0)).gt(0)?m.div(u):r(0),t.jsxs("div",{ref:l,className:"advanced-tooltip",style:{position:"fixed",left:`${d.x}px`,top:`${d.y}px`,background:"var(--panel-bg)",color:"var(--text-color)",padding:"12px",borderRadius:"2px",border:"4px double var(--accent-color)",fontSize:"15px",lineHeight:"1.4",width:"240px",minWidth:"240px",zIndex:1e4,boxShadow:"var(--shadow)",pointerEvents:"none",transition:"all 0.15s ease"},onMouseLeave:a,children:[t.jsxs("div",{style:{fontWeight:"bold",fontSize:"16px",marginBottom:"8px",color:"var(--accent-color)",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid var(--accent-color)",paddingBottom:"6px"},children:[t.jsx("span",{style:{fontSize:"20px"},children:e.icon}),t.jsx("span",{children:e.name})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(33, 150, 243, 0.1), rgba(33, 150, 243, 0.05))",borderRadius:"6px",border:"1px solid rgba(33, 150, 243, 0.3)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"rgba(33, 150, 243, 0.9)",fontWeight:"bold",fontSize:"13px"},children:"Count"}),t.jsx("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:b(y,o.numberFormat)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05))",borderRadius:"6px",border:"1px solid rgba(76, 175, 80, 0.3)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"var(--success-color)",fontWeight:"bold",fontSize:"13px"},children:"Production"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:[b(w,o.numberFormat),"/s"]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(255, 152, 0, 0.05))",borderRadius:"6px",border:"1px solid rgba(255, 152, 0, 0.3)"},children:[t.jsx("span",{style:{color:"#ff9800",fontWeight:"bold",fontSize:"13px"},children:"Income Share"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:[b(P,o.numberFormat),"%"]})]})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(141, 110, 99, 0.1), rgba(141, 110, 99, 0.05))",borderRadius:"6px",border:"1px solid var(--accent-color)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"var(--accent-color)",fontWeight:"bold",fontSize:"13px"},children:"Next Building"}),t.jsxs("span",{style:{color:"var(--accent-color)",fontWeight:"bold",fontSize:"14px"},children:[b(m,o.numberFormat)," gold"]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(156, 39, 176, 0.1), rgba(156, 39, 176, 0.05))",borderRadius:"6px",border:"1px solid rgba(156, 39, 176, 0.3)"},children:[t.jsx("span",{style:{color:"#9c27b0",fontWeight:"bold",fontSize:"13px"},children:"Each Produces"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:[b(u,o.numberFormat),"/s"]})]})]}),t.jsx("div",{style:{padding:"6px",background:"rgba(0, 0, 0, 0.05)",borderRadius:"6px",borderTop:"1px solid var(--border-color)",fontSize:"11px",color:"var(--text-secondary)",fontStyle:"italic",textAlign:"center"},children:e.description}),t.jsxs("div",{style:{padding:"6px",background:"rgba(0, 0, 0, 0.05)",borderRadius:"6px",borderTop:"1px solid var(--border-color)",marginTop:"8px"},children:[t.jsx("div",{style:{fontSize:"12px",fontWeight:"bold",marginBottom:"6px",color:"var(--text-secondary)",textAlign:"center"},children:"BONUS BREAKDOWN"}),o.achievements.length>0&&t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 8px",background:"linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(255, 193, 7, 0.05))",borderRadius:"4px",border:"1px solid rgba(255, 193, 7, 0.3)",marginBottom:"3px",fontSize:"11px"},children:[t.jsx("span",{style:{color:"#ffc107",fontWeight:"bold"},children:"ðŸ† Achievements"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold"},children:["+",o.achievements.length*2,"%"]})]}),j(o.totalRenownEarned).gt(r(1))&&t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 8px",background:"linear-gradient(135deg, rgba(156, 39, 176, 0.1), rgba(156, 39, 176, 0.05))",borderRadius:"4px",border:"1px solid rgba(156, 39, 176, 0.3)",marginBottom:"3px",fontSize:"11px"},children:[t.jsx("span",{style:{color:"#9c27b0",fontWeight:"bold"},children:"ðŸ‘‘ Prestige"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold"},children:["+",j(o.totalRenownEarned).minus(r(1)).times(r(100)).floor().toString(),"%"]})]}),(()=>{let v=0;o.nationalProjects&&Object.values(o.nationalProjects).forEach(g=>{v+=g.level||0});const c=v*E*100;return c>0?t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 8px",background:"linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05))",borderRadius:"4px",border:"1px solid rgba(76, 175, 80, 0.3)",marginBottom:"3px",fontSize:"11px"},children:[t.jsx("span",{style:{color:"var(--success-color)",fontWeight:"bold"},children:"ðŸ—ï¸ Projects"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold"},children:["+",c.toFixed(0),"%"]})]}):null})(),o.globalIncomeMultiplier&&o.globalIncomeMultiplier>1&&t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 8px",background:"linear-gradient(135deg, rgba(233, 30, 99, 0.1), rgba(233, 30, 99, 0.05))",borderRadius:"4px",border:"1px solid rgba(233, 30, 99, 0.3)",marginBottom:"3px",fontSize:"11px"},children:[t.jsx("span",{style:{color:"#e91e63",fontWeight:"bold"},children:"ðŸ’ Blessing"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold"},children:["+",((o.globalIncomeMultiplier-1)*100).toFixed(1),"%"]})]})]})]})};function k(o,e){var p;let n=e.baseProduction;const i=((p=o.weather)==null?void 0:p.current)||"clear";i==="sunny"&&(e.id==="peasant"||e.id==="field"||e.id==="stable"||e.id==="cathedral")?n=n.times(r(1.2)):i==="rainy"&&(e.id==="silver_mine"||e.id==="alchemist"||e.id==="market"||e.id==="tavern")?n=n.times(r(1.2)):i==="stormy"?((e.id==="blacksmith"||e.id==="void_portal")&&(n=n.times(r(1.3))),(e.id==="field"||e.id==="stable")&&(n=n.times(r(.8)))):i==="windy"&&(e.id==="market"||e.id==="castle"||e.id==="time_chamber")&&(n=n.times(r(1.15)));const s=j(o.totalRenownEarned);s.gt(r(1))&&(n=n.times(s));let a=0;o.nationalProjects&&Object.values(o.nationalProjects).forEach(x=>{a+=x.level||0});const l=1+a*E;n=n.times(r(l));const d=1+o.achievements.length*.02;return n=n.times(r(d)),o.globalIncomeMultiplier&&(n=n.times(r(o.globalIncomeMultiplier))),n}function j(o){const e=o.toNumber();if(e<=0)return r(1);let n=r(1);return e<=100?n=r(1+e*.02):e<=1e3?n=r(3).plus(r(e-100).times(r(.01))):e<=1e4?n=r(4).plus(r(e-1e3).times(r(.005))):e<=1e5?n=r(4.5).plus(r(e-1e4).times(r(.001))):n=r(5.5).plus(r(5).times(Math.log10(e))),n}function A(o){let e=r(0);return T.forEach(n=>{const i=o.buildings[n.id]||r(0);if(i.gt(0)){const s=k(o,n);e=e.plus(s.times(i))}}),e}function O(o,e){return o.times(r(1.15).pow(e)).floor()}const X=({toasts:o})=>t.jsx("div",{className:"toast-container",children:o.map(e=>t.jsxs("div",{className:`toast ${e.type}`,children:[e.type==="success"&&"âœ…",e.type==="warning"&&"âš ï¸",e.type==="info"&&"â„¹ï¸",e.type==="error"&&"âŒ",t.jsx("span",{children:e.message})]},e.id))}),Y=()=>{const[o,e]=h.useState(null);if(h.useEffect(()=>{const i=l=>{const p=l.target.closest("[data-tooltip]");if(p){const x=p.getAttribute("data-tooltip");x&&e({text:x,x:l.clientX,y:l.clientY})}else e(null)},s=l=>{o&&e(d=>d?I(R({},d),{x:l.clientX,y:l.clientY}):null)},a=()=>{e(null)};return document.addEventListener("mouseover",i),document.addEventListener("mousemove",s),document.addEventListener("mouseout",a),()=>{document.removeEventListener("mouseover",i),document.removeEventListener("mousemove",s),document.removeEventListener("mouseout",a)}},[o]),!o)return null;const n={left:o.x+15,top:o.y+15};return o.x+250>window.innerWidth&&(n.left=o.x-260),o.y+100>window.innerHeight&&(n.top=o.y-50),t.jsx("div",{className:"game-tooltip",style:n,children:o.text.split(`
`).map((i,s)=>t.jsx("div",{style:{marginBottom:s===o.text.split(`
`).length-1?0:"4px"},children:i},s))})};export{D as A,Y as G,X as T,j as g};
