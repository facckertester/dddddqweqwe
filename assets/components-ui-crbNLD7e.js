var R=Object.defineProperty,C=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var z=(o,e,n)=>e in o?R(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n,B=(o,e)=>{for(var n in e||(e={}))k.call(e,n)&&z(o,n,e[n]);if(w)for(var n of w(e))I.call(e,n)&&z(o,n,e[n]);return o},S=(o,e)=>C(o,P(e));import{r as f,j as t}from"./vendor-react-CUeQczFW.js";import{a as L}from"./vendor-DdgGw12P.js";import{t as r,f as g,B as N,P as M}from"./core-uFyQeYSz.js";const Y=({gameState:o,building:e,x:n,y:i,visible:s,onHide:a})=>{const l=f.useRef(null),[d,c]=f.useState({x:0,y:0});if(f.useEffect(()=>{if(!s||!l.current)return;const p=l.current.getBoundingClientRect();let y=n+15,x=i-p.height/2;y+p.width>window.innerWidth&&(y=n-p.width-15),x<10&&(x=10),x+p.height>window.innerHeight-10&&(x=window.innerHeight-p.height-10),c({x:y,y:x})},[s,n,i]),!s||!e)return null;const u=o.buildings[e.id]||r(0);if(!(o.totalGold.gte(e.baseCost)||u.gt(r(0))))return t.jsxs("div",{ref:l,className:"advanced-tooltip",style:{position:"fixed",left:`${d.x}px`,top:`${d.y}px`,background:"var(--panel-bg)",color:"var(--text-color)",padding:"12px",borderRadius:"2px",border:"4px double var(--accent-color)",fontSize:"15px",lineHeight:"1.4",width:"240px",minWidth:"240px",zIndex:1e4,boxShadow:"var(--shadow)",pointerEvents:"none",transition:"all 0.15s ease"},onMouseLeave:a,children:[t.jsxs("div",{style:{fontWeight:"bold",fontSize:"16px",marginBottom:"8px",color:"var(--accent-color)",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid var(--accent-color)",paddingBottom:"6px"},children:[t.jsx("span",{style:{fontSize:"20px"},children:"❓"}),t.jsx("span",{children:"???"})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(33, 150, 243, 0.1), rgba(33, 150, 243, 0.05))",borderRadius:"6px",border:"1px solid rgba(33, 150, 243, 0.3)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"rgba(33, 150, 243, 0.9)",fontWeight:"bold",fontSize:"13px"},children:"Count"}),t.jsx("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:"???"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05))",borderRadius:"6px",border:"1px solid rgba(76, 175, 80, 0.3)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"var(--success-color)",fontWeight:"bold",fontSize:"13px"},children:"Production"}),t.jsx("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:"???/s"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(255, 152, 0, 0.05))",borderRadius:"6px",border:"1px solid rgba(255, 152, 0, 0.3)"},children:[t.jsx("span",{style:{color:"#ff9800",fontWeight:"bold",fontSize:"13px"},children:"Income Share"}),t.jsx("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:"???%"})]})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(141, 110, 99, 0.1), rgba(141, 110, 99, 0.05))",borderRadius:"6px",border:"1px solid var(--accent-color)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"var(--accent-color)",fontWeight:"bold",fontSize:"13px"},children:"Next Building"}),t.jsx("span",{style:{color:"var(--accent-color)",fontWeight:"bold",fontSize:"14px"},children:"??? gold"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(156, 39, 176, 0.1), rgba(156, 39, 176, 0.05))",borderRadius:"6px",border:"1px solid rgba(156, 39, 176, 0.3)"},children:[t.jsx("span",{style:{color:"#9c27b0",fontWeight:"bold",fontSize:"13px"},children:"Each Produces"}),t.jsx("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:"???/s"})]})]}),t.jsx("div",{style:{padding:"6px",background:"rgba(0, 0, 0, 0.05)",borderRadius:"6px",borderTop:"1px solid var(--border-color)",fontSize:"11px",color:"var(--text-secondary)",fontStyle:"italic",textAlign:"center"},children:"???"})]});const m=o.buildings[e.id]||r(0),b=W(o,e),v=b.times(m),j=G(o),E=j.gt(0)?v.div(j).times(100):r(0),h=A(e.baseCost,m);return(h.gt(0)?b.div(h):r(0)).gt(0)?h.div(b):r(0),t.jsxs("div",{ref:l,className:"advanced-tooltip",style:{position:"fixed",left:`${d.x}px`,top:`${d.y}px`,background:"var(--panel-bg)",color:"var(--text-color)",padding:"12px",borderRadius:"2px",border:"4px double var(--accent-color)",fontSize:"15px",lineHeight:"1.4",width:"240px",minWidth:"240px",zIndex:1e4,boxShadow:"var(--shadow)",pointerEvents:"none",transition:"all 0.15s ease"},onMouseLeave:a,children:[t.jsxs("div",{style:{fontWeight:"bold",fontSize:"16px",marginBottom:"8px",color:"var(--accent-color)",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid var(--accent-color)",paddingBottom:"6px"},children:[t.jsx("span",{style:{fontSize:"20px"},children:e.icon}),t.jsx("span",{children:e.name})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(33, 150, 243, 0.1), rgba(33, 150, 243, 0.05))",borderRadius:"6px",border:"1px solid rgba(33, 150, 243, 0.3)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"rgba(33, 150, 243, 0.9)",fontWeight:"bold",fontSize:"13px"},children:"Count"}),t.jsx("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:g(m,o.numberFormat)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05))",borderRadius:"6px",border:"1px solid rgba(76, 175, 80, 0.3)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"var(--success-color)",fontWeight:"bold",fontSize:"13px"},children:"Production"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:[g(v,o.numberFormat),"/s"]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(255, 152, 0, 0.05))",borderRadius:"6px",border:"1px solid rgba(255, 152, 0, 0.3)"},children:[t.jsx("span",{style:{color:"#ff9800",fontWeight:"bold",fontSize:"13px"},children:"Income Share"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:[g(E,o.numberFormat),"%"]})]})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(141, 110, 99, 0.1), rgba(141, 110, 99, 0.05))",borderRadius:"6px",border:"1px solid var(--accent-color)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"var(--accent-color)",fontWeight:"bold",fontSize:"13px"},children:"Next Building"}),t.jsxs("span",{style:{color:"var(--accent-color)",fontWeight:"bold",fontSize:"14px"},children:[g(h,o.numberFormat)," gold"]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(156, 39, 176, 0.1), rgba(156, 39, 176, 0.05))",borderRadius:"6px",border:"1px solid rgba(156, 39, 176, 0.3)"},children:[t.jsx("span",{style:{color:"#9c27b0",fontWeight:"bold",fontSize:"13px"},children:"Each Produces"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:[g(b,o.numberFormat),"/s"]})]})]}),t.jsx("div",{style:{padding:"6px",background:"rgba(0, 0, 0, 0.05)",borderRadius:"6px",borderTop:"1px solid var(--border-color)",fontSize:"11px",color:"var(--text-secondary)",fontStyle:"italic",textAlign:"center"},children:e.description})]})};function W(o,e){var d;let n=e.baseProduction;const i=((d=o.weather)==null?void 0:d.current)||"clear";i==="sunny"&&(e.id==="peasant"||e.id==="field")?n=n.times(r(1.2)):i==="rainy"&&(e.id==="silver_mine"||e.id==="alchemist")?n=n.times(r(1.2)):i==="stormy"?(e.id==="blacksmith"&&(n=n.times(r(1.3))),e.id==="field"&&(n=n.times(r(.8)))):i==="windy"&&e.id==="market"&&(n=n.times(r(1.15)));let s=0;o.nationalProjects&&Object.values(o.nationalProjects).forEach(c=>{s+=c.level||0});const a=1+s*M;n=n.times(r(a));const l=T(o.renown);return n=n.times(l),n}function T(o){const e=o.toNumber();if(e<=0)return r(1);let n=r(1);e<=100?n=r(1+e*.01):e<=1e3?n=r(2).plus(r(e-100).times(r(.005))):e<=1e4?n=r(2.5).plus(r(e-1e3).times(r(.001))):n=r(10).plus(r(10).times(Math.log10(e)));const i=r(1e3);return L.min(n,i)}function G(o){let e=r(0);return N.forEach(n=>{const i=o.buildings[n.id]||r(0);if(i.gt(0)){const s=W(o,n);e=e.plus(s.times(i))}}),e}function A(o,e){return o.times(r(1.15).pow(e)).floor()}const D=({toasts:o})=>t.jsx("div",{className:"toast-container",children:o.map(e=>t.jsxs("div",{className:`toast ${e.type}`,children:[e.type==="success"&&"✅",e.type==="warning"&&"⚠️",e.type==="info"&&"ℹ️",e.type==="error"&&"❌",t.jsx("span",{children:e.message})]},e.id))}),J=()=>{const[o,e]=f.useState(null);if(f.useEffect(()=>{const i=l=>{const c=l.target.closest("[data-tooltip]");if(c){const u=c.getAttribute("data-tooltip");u&&e({text:u,x:l.clientX,y:l.clientY})}else e(null)},s=l=>{o&&e(d=>d?S(B({},d),{x:l.clientX,y:l.clientY}):null)},a=()=>{e(null)};return document.addEventListener("mouseover",i),document.addEventListener("mousemove",s),document.addEventListener("mouseout",a),()=>{document.removeEventListener("mouseover",i),document.removeEventListener("mousemove",s),document.removeEventListener("mouseout",a)}},[o]),!o)return null;const n={left:o.x+15,top:o.y+15};return o.x+250>window.innerWidth&&(n.left=o.x-260),o.y+100>window.innerHeight&&(n.top=o.y-50),t.jsx("div",{className:"game-tooltip",style:n,children:o.text.split(`
`).map((i,s)=>t.jsx("div",{style:{marginBottom:s===o.text.split(`
`).length-1?0:"4px"},children:i},s))})};export{Y as A,J as G,D as T,T as g};
