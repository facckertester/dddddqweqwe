var Yt=Object.defineProperty,Kt=Object.defineProperties;var Vt=Object.getOwnPropertyDescriptors;var xt=Object.getOwnPropertySymbols;var Xt=Object.prototype.hasOwnProperty,Jt=Object.prototype.propertyIsEnumerable;var mt=(t,r,d)=>r in t?Yt(t,r,{enumerable:!0,configurable:!0,writable:!0,value:d}):t[r]=d,u=(t,r)=>{for(var d in r||(r={}))Xt.call(r,d)&&mt(t,d,r[d]);if(xt)for(var d of xt(r))Jt.call(r,d)&&mt(t,d,r[d]);return t},m=(t,r)=>Kt(t,Vt(r));var qt=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports);var de=(t,r,d)=>new Promise((x,i)=>{var a=k=>{try{c(d.next(k))}catch(g){i(g)}},b=k=>{try{c(d.throw(k))}catch(g){i(g)}},c=k=>k.done?x(k.value):Promise.resolve(k.value).then(a,b);c((d=d.apply(t,r)).next())});import{j as e,r as j,R as Se,a as Zt}from"./vendor-react-CUeQczFW.js";import{n as Qt,o as St,t as o,p as ze,e as Ct,f as M,T as Ve,C as ht,B as ue,W as eo,A as Pt,P as Je,g as Ge,a as Tt,b as Lt,M as Xe,c as Ie,d as Fe,q as He,j as $e,h as Ye,i as Ke,k as bt,r as to}from"./core-b497BxOD.js";import{a as we,G as oo}from"./components-ui-GPLDHM49.js";import{B as yt}from"./components-store-Bdq3Xl_B.js";import{M as vt}from"./components-main-DDEw1-ED.js";import{A as ro}from"./components-achievements-BvrPsDrb.js";import{i as no,g as so,s as Ce,d as Te,a as Le,q as Bt,c as Rt,o as Mt,l as Nt,b as Et}from"./vendor-firebase-IMiYFFvY.js";import{a as le}from"./vendor-DdgGw12P.js";import{P as lo}from"./components-services-IDmCsBj4.js";var Wo=qt(be=>{(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))x(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const b of a.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&x(b)}).observe(document,{childList:!0,subtree:!0});function d(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function x(i){if(i.ep)return;i.ep=!0;const a=d(i);fetch(i.href,a)}})();const jt=({gameState:t,onBuyTowerFloor:r})=>{const d=Qt(t.totalGold);St(t.totalGold);const x=t.darkMatterGold||o(0),i=t.infiniteTowerLevel||0;t.portalProgress;const a=ze(i),b=x.gte(a),k=Ct(i).minus(o(1)).times(o(100)),y=(()=>{if(d)return 100;if(t.totalGold.lt(o(1e15)))return 0;const p=Math.log10(1e15),R=Math.log10(1e18),C=Math.log10(t.totalGold.toNumber()),F=(Math.max(p,Math.min(R,C))-p)/(R-p)*100;return Math.floor(F)})();return e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--gap-size)",height:"100%",minHeight:"600px",overflow:"hidden"},children:e.jsxs("div",{style:{flex:1,overflowY:"auto",overflowX:"hidden",padding:"var(--panel-padding)",WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:[e.jsxs("div",{style:{textAlign:"center",padding:"20px",background:"var(--panel-bg)",border:d?"2px solid #673ab7":"2px dashed var(--border-color)",borderRadius:"8px",position:"relative",overflow:"hidden",marginBottom:"20px"},children:[e.jsx("div",{style:{width:"120px",height:"120px",margin:"0 auto 15px",borderRadius:"50%",background:d?"radial-gradient(circle, rgba(103, 58, 183, 0.21), rgba(103, 58, 183, 0.1))":"radial-gradient(circle, rgba(128, 128, 128, 0.2), rgba(128, 128, 128, 0.05))",border:d?"3px solid rgba(103, 58, 183, 0.37)":"3px solid rgba(128, 128, 128, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"3rem"},children:d?"üåÄ":"üîí"}),e.jsx("h3",{style:{fontSize:"1.3rem",color:"#ba68c8",marginBottom:"10px",fontWeight:"bold",textShadow:"0 0 10px rgba(186, 104, 200, 0.5)"},children:d?"Portal to Another Dimension":"Portal Construction"}),!d&&e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsxs("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",marginBottom:"8px"},children:["Progress: ",y,"%"]}),e.jsx("div",{style:{width:"100%",height:"8px",background:"rgba(0,0,0,0.1)",borderRadius:"4px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${y}%`,height:"100%",background:"linear-gradient(90deg, #673ab7, #9575cd)",transition:"width 0.3s ease"}})}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"5px"}})]}),d&&e.jsx("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:"The portal shimmers with infinite possibilities..."})]}),d&&e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(103, 58, 183, 0.1), rgba(103, 58, 183, 0.05))",padding:"15px",borderRadius:"8px",border:"1px solid #673ab7",marginBottom:"20px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsx("span",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#ba68c8",textShadow:"0 0 8px rgba(186, 104, 200, 0.4)"},children:"‚ö´ Dark Matter Gold"})}),e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsx("span",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"#ce93d8",textShadow:"0 0 8px rgba(206, 147, 216, 0.4)"},children:M(x,t.numberFormat)})})]}),d&&e.jsxs("div",{style:{background:"var(--panel-bg)",padding:"1px 19px 19px 19px",borderRadius:"px",border:"2px solid #ff9800",marginBottom:"20px"},children:[e.jsx("h4",{style:{fontSize:"1.1rem",color:"#ff9800",marginBottom:"10px",fontWeight:"bold"},children:"üèóÔ∏è Infinite Tower of Time & Space"}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[e.jsx("span",{style:{fontSize:"0.9rem",color:"var(--text-color)"},children:"Current Level"}),e.jsx("span",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#ff9800",textShadow:"0 0 8px rgba(255, 152, 0, 0.4)"},children:i})]}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginBottom:"10px"},children:["Income Bonus: +",M(k,t.numberFormat),"%"]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[e.jsx("span",{style:{fontSize:"0.9rem",color:"var(--text-color)"},children:"Next Floor Cost"}),e.jsxs("span",{style:{fontSize:"1rem",fontWeight:"bold",color:b?"#673ab7":"var(--text-secondary)"},children:[M(a,t.numberFormat)," ‚ö´"]})]})]}),e.jsx("button",{className:"btn",onClick:r,disabled:!b,style:{width:"100%",background:b?"#ff9800":"var(--panel-bg)",color:b?"var(--text-on-accent)":"var(--text-color)",border:"2px solid #ff9800",padding:"10px",fontSize:"1rem",fontWeight:"bold",opacity:b?1:.6,cursor:b?"pointer":"default"},children:b?"Build Next Floor":"Not Enough Dark Matter Gold"})]}),e.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(103, 58, 183, 0.1), rgba(103, 58, 183, 0.05))",padding:"15px",borderRadius:"8px",border:"1px solid rgba(103, 58, 183, 0.2)",fontSize:"0.9rem",color:"var(--text-secondary)",lineHeight:"1.6",fontStyle:"italic",marginBottom:"20px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"10px",color:"#ba68c8",fontStyle:"normal",textAlign:"center",fontSize:"1rem",textShadow:"0 0 8px rgba(186, 104, 200, 0.3)"},children:"üåå The Infinite Mystery"}),e.jsx("p",{style:{margin:"0 0 10px 0",textAlign:"center"},children:"When a kingdom's treasures transcend mortal comprehension, the very fabric of reality begins to unravel, revealing hidden passages to worlds beyond imagination."}),e.jsx("p",{style:{margin:"0 0 10px 0",textAlign:"center"},children:"Through this gateway flows dark matter - the concentrated essence of time and space itself, capable of rewriting the fundamental laws of creation and transforming the nature of existence."}),e.jsx("p",{style:{margin:"0",textAlign:"center",fontWeight:"bold"},children:"Each floor of the Infinite Tower amplifies the flow's power, creating cascades of limitless possibilities in the eternal dance of universes..."})]})]})})},qe=({currentBet:t,maxGold:r,onBetChange:d,numberFormat:x})=>{const[i,a]=j.useState(t===0?"":t.toString());j.useEffect(()=>{var y,p;t===0&&((y=document.activeElement)==null?void 0:y.tagName)!=="INPUT"?a(""):Math.abs(parseFloat(i)-t)>1e-4&&((p=document.activeElement)==null?void 0:p.tagName)!=="INPUT"&&a(t>1e9?t.toExponential(2).replace("+",""):t.toString())},[t]);const b=y=>{try{if(y.trim()===""){d(0),a("");return}let p=parseFloat(y);const R=y.toLowerCase().trim(),C={k:1e3,m:1e6,b:1e9,t:1e12,qa:1e15,qi:1e18,sx:1e21,sp:1e24,oc:1e27,no:1e30,dc:1e33,ud:1e36,dd:1e39,td:1e42,qd:1e45,qn:1e48};for(const F of Object.keys(C))if(R.endsWith(F)){const h=parseFloat(R.slice(0,-F.length));isNaN(h)||(p=h*C[F]);break}(isNaN(p)||p<0)&&(p=0);const A=r.toNumber();isFinite(A)&&p>A?p=A:!isFinite(A)&&o(p).gt(r)&&(p=Number.MAX_VALUE),d(p),p===0?a(""):p>=1e6?a(p.toExponential(2).replace("+","")):a(Math.floor(p).toString())}catch(p){a(t===0?"":t.toString())}},c=()=>{b(i)},k=y=>{y.key==="Enter"&&(b(i),y.target.blur())},g=y=>{let R=r.times(y).floor().toNumber();isFinite(R)||(R=Number.MAX_VALUE),R<1&&r.gt(0)&&(R=1),d(R),R>=1e6?a(R.toExponential(2).replace("+","")):a(R.toString())};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",width:"100%"},children:[e.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[e.jsx("span",{style:{position:"absolute",left:"10px",pointerEvents:"none",fontSize:"1.2rem"},children:"üí∞"}),e.jsx("input",{type:"text",value:i,onChange:y=>a(y.target.value),onBlur:c,onKeyDown:k,style:{width:"100%",padding:"10px 30px 10px 35px",fontSize:"1.1rem",border:"2px solid var(--border-color)",borderRadius:"4px",fontFamily:"monospace",background:"#fff",color:"#000",outline:"none",fontWeight:"bold"},placeholder:"Wager (100, 1k, 2.5m, 1b, 2e13)..."}),t>0&&e.jsx("button",{onClick:()=>{d(0),a("")},style:{position:"absolute",right:"5px",top:"50%",transform:"translateY(-50%)",background:"transparent",border:"none",color:"#999",fontSize:"1.2rem",cursor:"pointer",padding:"0 5px"},title:"Clear",children:"‚úï"})]}),e.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"space-between"},children:[e.jsx("button",{className:"btn",style:{padding:"4px 8px",fontSize:"0.7rem",flex:1,background:"rgba(0,0,0,0.1)",color:"var(--text-color)",border:"1px solid var(--border-color)"},onClick:()=>g(.1),children:"10%"}),e.jsx("button",{className:"btn",style:{padding:"4px 8px",fontSize:"0.7rem",flex:1,background:"rgba(0,0,0,0.1)",color:"var(--text-color)",border:"1px solid var(--border-color)"},onClick:()=>g(.5),children:"50%"}),e.jsx("button",{className:"btn",style:{padding:"4px 8px",fontSize:"0.7rem",flex:1,background:"var(--gold-color)",color:"#000",border:"1px solid #b8860b"},onClick:()=>g(1),children:"MAX"}),e.jsx("div",{style:{width:"4px"}}),e.jsx("button",{className:"btn",style:{padding:"4px 8px",fontSize:"0.7rem",flex:1,background:"rgba(0,0,0,0.1)",color:"var(--text-color)",border:"1px solid var(--border-color)"},onClick:()=>b(Math.floor(t/2).toString()),children:"¬Ω"}),e.jsx("button",{className:"btn",style:{padding:"4px 8px",fontSize:"0.7rem",flex:1,background:"rgba(0,0,0,0.1)",color:"var(--text-color)",border:"1px solid var(--border-color)"},onClick:()=>b((t*2).toString()),children:"x2"})]})]})},io=["Shadowfax","Roach","Bucephalus","Pegasus","Sleipnir","Epona","Agro","Artax","Rapidash","Spirit","Bullseye","Maximus","Khan","Buckbeak","Chestnut","Midnight","Storm","Blaze","Comet","Dakota"],ao=["#d32f2f","#1976d2","#388e3c","#fbc02d","#8e24aa","#ef6c00"],co=50,uo=({gameState:t,onGamble:r,onLeave:d})=>{const[x,i]=j.useState([]),[a,b]=j.useState(null),[c,k]=j.useState(0),[g,y]=j.useState("betting"),[p,R]=j.useState(""),[C,A]=j.useState(null),F=j.useRef(null),h=j.useRef([]);j.useEffect(()=>{E()},[]);const E=()=>{const B=[],P=[...io].sort(()=>.5-Math.random());for(let U=0;U<6;U++){const V=Math.random()*5+5,G=Math.random()*5+5;let X=25-(V+G);X=X+(Math.random()*4-2),X<1.5&&(X=1.5),X>20&&(X=20),B.push({id:U,name:P[U],color:ao[U],icon:"üêé",odds:parseFloat(X.toFixed(1)),progress:0,finished:!1,rank:0,speedRating:V,staminaRating:G})}i(B),b(null),A(null),h.current=[],R("Select a horse and place your bet!")},$=()=>{if(a===null){R("Select a horse first!");return}if(c<=0){R("Place a valid bet!");return}if(t.gold.lt(o(c))){R("Not enough gold!");return}y("racing"),R("And they're off!");let B=0;const P=400;F.current=setInterval(()=>{B++,i(U=>U.map(G=>{if(G.finished)return G;const H=Math.random()<.05?1:0,X=Math.random()<.05?-.5:0,J=.15,oe=G.speedRating/10*.15,I=Math.random()*.2;let T=J+oe+I+H+X,O=G.progress+T;return O>=100&&(O=100,!h.current.includes(G.id))?(h.current.push(G.id),m(u({},G),{progress:100,finished:!0,rank:h.current.length})):m(u({},G),{progress:O})}).slice(0,6)),(h.current.length===6||B>=P)&&(h.current.length<6&&i(U=>(U.filter(G=>!G.finished).sort((G,H)=>H.progress-G.progress).forEach(G=>{h.current.includes(G.id)||h.current.push(G.id)}),U.map(G=>{const H=h.current.indexOf(G.id);return H!==-1?m(u({},G),{rank:H+1,finished:!0,progress:100}):G}))),K())},co)},K=()=>{F.current&&clearInterval(F.current);const B=x.map(G=>{const H=h.current.indexOf(G.id);return H!==-1?m(u({},G),{rank:H+1,finished:!0}):G});i(B);const P=h.current[0],U=B.find(G=>G.id===P);if(!U)return;if(y("finished"),P===a){const G=B.find(J=>J.id===a),H=(G==null?void 0:G.odds)||1,X=Math.max(1,Math.floor(c*(H-1)));r(X,!0),A({won:!0,amount:X,winnerName:U.name})}else r(c,!1),A({won:!1,amount:c,winnerName:U.name})};j.useEffect(()=>()=>{F.current&&clearInterval(F.current)},[]);const Y=()=>{y("betting"),k(0),E()};return C&&(C.won,C.won,C.won,C.won,C.won,C.winnerName,C.won?(e.Fragment,M(o(C.amount),t.numberFormat)):(e.Fragment,M(o(C.amount),t.numberFormat))),e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"5px",textAlign:"center",background:"#e0cda9",borderBottom:"1px solid #5d4037",color:"#5d4037",fontWeight:"bold"},children:p}),e.jsxs("div",{style:{flex:1,background:"#e0cda9",padding:"10px 0",overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"space-between",position:"relative"},children:[e.jsx("div",{style:{position:"absolute",right:"40px",top:0,bottom:0,width:"10px",background:"repeating-linear-gradient(45deg, #000, #000 10px, #fff 10px, #fff 20px)",zIndex:0,borderLeft:"2px solid rgba(0,0,0,0.2)",borderRight:"2px solid rgba(0,0,0,0.2)",height:"100%"}}),x.map(B=>e.jsxs("div",{onClick:()=>g==="betting"&&b(B.id),style:{position:"relative",flex:1,minHeight:"30px",borderBottom:"1px dashed rgba(93, 64, 55, 0.3)",display:"flex",alignItems:"center",cursor:g==="betting"?"pointer":"default",background:a===B.id?"rgba(255, 215, 0, 0.3)":"rgba(255,255,255,0.1)",transition:"background 0.2s"},children:[e.jsxs("div",{style:{width:"100px",padding:"0 10px",borderRight:"1px solid var(--border-color)",display:"flex",flexDirection:"column",justifyContent:"center",zIndex:2,background:"var(--panel-bg)",height:"100%"},children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.8rem",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"var(--text-color)"},children:B.name}),e.jsxs("div",{style:{fontSize:"0.9rem",color:a===B.id?"var(--accent-color)":"var(--text-secondary)",fontWeight:"bold"},children:[B.odds.toFixed(1),"x"]})]}),e.jsx("div",{style:{position:"absolute",left:`calc(100px + ${B.progress}% - ${B.progress*.8}px)`,transition:g==="racing"?"left 0.05s linear":"left 0.3s ease",fontSize:"2rem",zIndex:1,transform:"scaleX(-1) translateY(-5px)",filter:a===B.id?"drop-shadow(0 0 5px gold)":"drop-shadow(0 2px 2px rgba(0,0,0,0.3))",color:B.color},children:e.jsx("div",{style:{fontSize:"2rem"},children:B.icon})}),B.finished&&e.jsx("div",{style:{position:"absolute",right:"10px",fontWeight:"bold",fontSize:"1.2rem",zIndex:5,color:"#000",textShadow:"0 0 2px rgba(0,0,0,0.3)"},children:B.rank===1?"ü•á":B.rank===2?"ü•à":B.rank===3?"ü•â":B.rank?`#${B.rank}`:"?"})]},B.id))]}),e.jsxs("div",{style:{padding:"15px 20px",background:"var(--panel-bg)",borderTop:"2px solid var(--border-color)",flexShrink:0,display:"flex",flexDirection:"row",gap:"15px",alignItems:"flex-end"},children:[e.jsx("div",{style:{flex:1},children:e.jsx(qe,{currentBet:c,maxGold:t.gold,onBetChange:k,numberFormat:t.numberFormat})}),e.jsxs("div",{style:{flexShrink:0},children:[g==="betting"&&e.jsx("button",{className:"btn",onClick:$,disabled:a===null||c<=0,style:{opacity:a===null||c<=0?.5:1,fontSize:"1.2rem",padding:"0 30px",height:"60px",background:"var(--accent-color)",boxShadow:"0 4px 0 rgba(0,0,0,0.2)",fontWeight:"bold"},children:"START"}),g==="finished"&&e.jsx("button",{className:"btn",onClick:Y,style:{fontSize:"1.2rem",padding:"0 30px",height:"60px",background:"var(--accent-color)",boxShadow:"0 4px 0 rgba(0,0,0,0.2)",fontWeight:"bold"},children:"RACE AGAIN"}),g==="racing"&&e.jsx("div",{style:{width:"100%",height:"60px"}})]})]}),e.jsxs("div",{style:{padding:"10px 20px",background:"var(--panel-bg)",borderTop:"1px solid var(--border-color)",textAlign:"center",fontSize:"1rem",fontWeight:"bold"},children:[e.jsx("span",{style:{marginRight:"10px",color:"var(--text-secondary)"},children:"Result:"}),C?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{marginRight:"10px"},children:C.won?"üèá":"üê¢"}),e.jsx("span",{style:{color:C.won?"#4caf50":"#f44336",marginRight:"10px"},children:C.won?"Winner!":"Better luck next time"}),e.jsxs("span",{style:{color:"var(--accent-color)",marginRight:"10px"},children:["Winner: ",C.winnerName]}),e.jsxs("span",{style:{color:C.won?"gold":"#ef5350"},children:[C.won?"+":"-",M(o(C.amount),t.numberFormat)," Gold"]})]}):e.jsx("span",{style:{color:"var(--text-secondary)",fontStyle:"italic"},children:"No results yet"})]})]})},po=({gameState:t,onGamble:r,onLeave:d})=>{const[x,i]=j.useState(0),[a,b]=j.useState(null),[c,k]=j.useState(!1),[g,y]=j.useState(0),[p,R]=j.useState(null),[C,A]=j.useState("Select a side and place your wager.");p&&(p.won,p.won,p.won,p.won,p.won,p.side,p.won?(e.Fragment,M(o(p.amount),t.numberFormat)):(e.Fragment,M(o(p.amount),t.numberFormat)));const F=()=>{if(!a){A("Please select Heads or Tails!");return}if(x<=0){A("Please enter a valid bet amount.");return}if(t.gold.lt(o(x))){A("Not enough gold!");return}k(!0),A("");const h=Math.random()>.5,E=Math.random()<.65,$=E?a==="heads"?"tails":"heads":h?"heads":"tails",K=!E,Y=g,P=360*5;let U=Y+P;const V=U%360;$==="heads"?U+=360-V:U+=180-V+360,y(U),setTimeout(()=>{k(!1),K?(r(x,!0),A("Victory!")):(r(x,!1),A("Defeat!")),setTimeout(()=>{R({won:K,amount:x,side:$})},500)},3e3)};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[e.jsx("style",{children:`
            .coin-container {
                perspective: 1000px;
                width: 180px;
                height: 180px;
                margin: 0 auto;
            }
            .coin {
                width: 100%;
                height: 100%;
                position: relative;
                transform-style: preserve-3d;
                transition: transform 3s cubic-bezier(0.1, 0.7, 0.1, 1);
            }
            .coin-face {
                position: absolute;
                width: 100%;
                height: 100%;
                backface-visibility: hidden;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 5rem;
                box-shadow: inset 0 0 30px rgba(0,0,0,0.5), 0 10px 20px rgba(0,0,0,0.3);
                border: 10px solid #b8860b;
            }
            .coin-front {
                background: radial-gradient(#ffd700, #daa520);
                color: #5d4037;
                transform: rotateY(0deg);
            }
            .coin-back {
                background: radial-gradient(#e6c200, #b8860b);
                color: #5d4037;
                transform: rotateY(180deg);
            }
            .coin-text {
                font-family: 'Cinzel', serif;
                font-weight: bold;
                text-shadow: 2px 2px 0 rgba(255,255,255,0.4);
            }
        `}),e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",position:"relative",background:"var(--bg-color)",overflow:"hidden"},children:[e.jsx("div",{className:"coin-container",children:e.jsxs("div",{className:"coin",style:{transform:`rotateY(${g}deg)`},children:[e.jsx("div",{className:"coin-face coin-front",children:e.jsx("span",{className:"coin-text",children:"üëë"})}),e.jsx("div",{className:"coin-face coin-back",children:e.jsx("span",{className:"coin-text",children:"1"})})]})}),e.jsx("div",{style:{fontSize:"1.4rem",fontWeight:"bold",marginTop:"20px",minHeight:"30px",color:"var(--accent-color)",textAlign:"center",padding:"0 20px"},children:C}),e.jsxs("div",{style:{display:"flex",gap:"20px",marginTop:"20px"},children:[e.jsxs("button",{onClick:()=>b("heads"),disabled:c,style:{padding:"10px 20px",border:`3px solid ${a==="heads"?"var(--gold-color)":"transparent"}`,background:a==="heads"?"rgba(255, 215, 0, 0.2)":"var(--bg-color)",color:"var(--text-color)",borderRadius:"8px",cursor:c?"not-allowed":"pointer",transition:"all 0.2s",display:"flex",flexDirection:"column",alignItems:"center",minWidth:"100px",transform:c?"none":"scale(1)",boxShadow:c?"none":"0 4px 8px rgba(0,0,0,0.15)",opacity:c?.6:1},onMouseEnter:h=>{!c&&a!=="heads"&&(h.currentTarget.style.transform="scale(1.1)",h.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.3)",h.currentTarget.style.border="3px solid var(--accent-color)",h.currentTarget.style.background="rgba(33, 150, 243, 0.2)")},onMouseLeave:h=>{!c&&a!=="heads"&&(h.currentTarget.style.transform="scale(1)",h.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)",h.currentTarget.style.border="3px solid transparent",h.currentTarget.style.background="var(--bg-color)")},children:[e.jsx("div",{style:{fontSize:"1.5rem"},children:"üëë"}),e.jsx("div",{style:{fontWeight:"bold"},children:"Heads"})]}),e.jsxs("button",{onClick:()=>b("tails"),disabled:c,style:{padding:"10px 20px",border:`3px solid ${a==="tails"?"var(--gold-color)":"transparent"}`,background:a==="tails"?"rgba(255, 215, 0, 0.2)":"var(--bg-color)",color:"var(--text-color)",borderRadius:"8px",cursor:c?"not-allowed":"pointer",transition:"all 0.2s",display:"flex",flexDirection:"column",alignItems:"center",minWidth:"100px",transform:c?"none":"scale(1)",boxShadow:c?"none":"0 4px 8px rgba(0,0,0,0.15)",opacity:c?.6:1},onMouseEnter:h=>{!c&&a!=="tails"&&(h.currentTarget.style.transform="scale(1.1)",h.currentTarget.style.boxShadow="0 6px 12px rgba(0,0,0,0.3)",h.currentTarget.style.border="3px solid var(--accent-color)",h.currentTarget.style.background="rgba(33, 150, 243, 0.2)")},onMouseLeave:h=>{!c&&a!=="tails"&&(h.currentTarget.style.transform="scale(1)",h.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.1)",h.currentTarget.style.border="3px solid transparent",h.currentTarget.style.background="var(--bg-color)")},children:[e.jsx("div",{style:{fontSize:"1.5rem"},children:"1"}),e.jsx("div",{style:{fontWeight:"bold"},children:"Tails"})]})]})]}),e.jsxs("div",{style:{padding:"15px 20px",background:"var(--panel-bg)",borderTop:"2px solid var(--border-color)",flexShrink:0,display:"flex",flexDirection:"row",gap:"15px",alignItems:"flex-end"},children:[e.jsx("div",{style:{flex:1},children:e.jsx(qe,{currentBet:x,maxGold:t.gold,onBetChange:i,numberFormat:t.numberFormat})}),e.jsx("button",{className:"btn",onClick:F,disabled:!a||x<=0||c,style:{opacity:!a||x<=0||c?.5:1,fontSize:"1.2rem",padding:"0 30px",height:"60px",background:"var(--accent-color)",boxShadow:"0 4px 0 rgba(0,0,0,0.2)",flexShrink:0,fontWeight:"bold"},children:"FLIP"})]}),e.jsxs("div",{style:{padding:"10px 20px",background:"var(--panel-bg)",borderTop:"1px solid var(--border-color)",textAlign:"center",fontSize:"1rem",fontWeight:"bold"},children:[e.jsx("span",{style:{marginRight:"10px",color:"var(--text-secondary)"},children:"Result:"}),p?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{marginRight:"10px"},children:p.won?"‚ú®":"üí∏"}),e.jsx("span",{style:{color:p.won?"#4caf50":"#f44336",marginRight:"10px"},children:p.won?"Victory!":"Defeat!"}),e.jsxs("span",{style:{color:"var(--accent-color)",marginRight:"10px"},children:["Result: ",p.side]}),e.jsxs("span",{style:{color:p.won?"gold":"#ef5350"},children:[p.won?"+":"-",M(o(p.amount),t.numberFormat)," Gold"]})]}):e.jsx("span",{style:{color:"var(--text-secondary)",fontStyle:"italic"},children:"No results yet"})]})]})},wt=({value:t,size:r=80,color:d="#3e2723"})=>{const x=r*.18,i=r*.25,a=r*.5,b=r*.75,c=[];return(t===1||t===3||t===5)&&c.push({cx:a,cy:a}),t>1&&(c.push({cx:i,cy:i}),c.push({cx:b,cy:b})),t>3&&(c.push({cx:b,cy:i}),c.push({cx:i,cy:b})),t===6&&(c.push({cx:i,cy:a}),c.push({cx:b,cy:a})),e.jsx("div",{style:{width:r,height:r,backgroundColor:"#fff",borderRadius:r*.15,boxShadow:"0 4px 8px rgba(0,0,0,0.2), inset 0 -4px 4px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid #ccc"},children:e.jsx("svg",{width:r,height:r,viewBox:`0 0 ${r} ${r}`,children:c.map((k,g)=>e.jsx("circle",{cx:k.cx,cy:k.cy,r:x/2,fill:d},g))})})},go=({gameState:t,onGamble:r,onLeave:d})=>{const[x,i]=j.useState(0),[a,b]=j.useState(!1),[c,k]=j.useState([1,1]),[g,y]=j.useState(null),[p,R]=j.useState("Place your wager and roll!"),C=()=>{if(x<=0){R("Please enter a valid bet amount.");return}if(t.gold.lt(o(x))){R("Not enough gold!");return}b(!0),R("Rolling..."),y(null);let F=0;const h=10,E=setInterval(()=>{k([Math.floor(Math.random()*6)+1,Math.floor(Math.random()*6)+1]),F++,F>=h&&(clearInterval(E),A())},100)},A=()=>{const F=Math.floor(Math.random()*6)+1,h=Math.floor(Math.random()*6)+1,E=F+h;k([F,h]),b(!1);let $=0,K=!1,Y="";if(E===2?($=10,K=!0,Y="Snake Eyes! JACKPOT (x10)!"):E===3?($=2,K=!0,Y="Low Triple! (x2)"):E>=4&&E<=9?($=0,K=!1,Y="House wins..."):E>=10&&E<=11?($=1.5,K=!0,Y="Good roll! (x1.5)"):E===12&&($=5,K=!0,Y="Boxcars! Nice Win (x5)!"),K){const B=Math.max(1,Math.floor(x*($-1)));r(B,!0),R(Y),y({won:!0,amount:B,sum:E})}else r(x,!1),R(Y),y({won:!1,amount:x,sum:E})};return g&&(g.won,g.won,g.won,g.won,g.won,g.sum,g.won?(e.Fragment,M(o(g.amount),t.numberFormat)):(e.Fragment,M(o(g.amount),t.numberFormat))),e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-evenly",alignItems:"center",background:"var(--bg-color)",overflow:"hidden",padding:"10px"},children:[e.jsxs("div",{style:{background:"var(--panel-bg)",padding:"10px",borderRadius:"8px",fontSize:"0.8rem",border:"1px solid var(--border-color)",width:"100%",maxWidth:"400px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[e.jsx("span",{style:{color:"var(--text-color)"},children:"Sum 2 (Snake Eyes)"}),e.jsx("span",{style:{color:"var(--gold-color)",fontWeight:"bold"},children:"x10"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[e.jsx("span",{style:{color:"var(--text-color)"},children:"Sum 3"}),e.jsx("span",{style:{color:"var(--success-color)",fontWeight:"bold"},children:"x2"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[e.jsx("span",{style:{color:"var(--text-color)"},children:"Sum 10-11"}),e.jsx("span",{style:{color:"var(--success-color)",fontWeight:"bold"},children:"x1.5"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-color)"},children:"Sum 12 (Boxcars)"}),e.jsx("span",{style:{color:"var(--gold-color)",fontWeight:"bold"},children:"x5"})]}),e.jsx("div",{style:{textAlign:"center",color:"var(--danger-color)",marginTop:"15px",fontSize:"0.9rem",fontWeight:"bold"},children:"Sum 4-9: House Wins"})]}),e.jsxs("div",{style:{display:"flex",gap:"30px",transform:"scale(1.2)"},children:[e.jsx(wt,{value:c[0],size:100}),e.jsx(wt,{value:c[1],size:100})]}),e.jsx("div",{style:{fontSize:"1.8rem",fontWeight:"bold",minHeight:"40px",color:"var(--accent-color)"},children:a?"":`Sum: ${c[0]+c[1]}`}),e.jsx("div",{style:{fontSize:"1rem",minHeight:"20px",color:"var(--text-color)"},children:p})]}),e.jsxs("div",{style:{padding:"15px 20px",background:"var(--panel-bg)",borderTop:"2px solid var(--border-color)",flexShrink:0,display:"flex",flexDirection:"row",gap:"15px",alignItems:"flex-end"},children:[e.jsx("div",{style:{flex:1},children:e.jsx(qe,{currentBet:x,maxGold:t.gold,onBetChange:i,numberFormat:t.numberFormat})}),e.jsx("button",{className:"btn",onClick:C,disabled:x<=0||a,style:{fontSize:"1.2rem",padding:"0 30px",height:"60px",background:"var(--accent-color)",opacity:x<=0||a?.5:1,boxShadow:"0 4px 0 rgba(0,0,0,0.2)",flexShrink:0,fontWeight:"bold"},children:"ROLL"})]}),e.jsxs("div",{style:{padding:"10px 20px",background:"var(--panel-bg)",borderTop:"1px solid var(--border-color)",textAlign:"center",fontSize:"1rem",fontWeight:"bold"},children:[e.jsx("span",{style:{marginRight:"10px",color:"var(--text-secondary)"},children:"Result:"}),g?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{marginRight:"10px"},children:g.won?"üé≤":"üìâ"}),e.jsx("span",{style:{color:g.won?"#4caf50":"#f44336",marginRight:"10px"},children:g.won?"You Won!":"You Lost"}),e.jsxs("span",{style:{color:"var(--accent-color)",marginRight:"10px"},children:["Rolled: ",g.sum]}),e.jsxs("span",{style:{color:g.won?"gold":"#ef5350"},children:[g.won?"+":"-",M(o(g.amount),t.numberFormat)," Gold"]})]}):e.jsx("span",{style:{color:"var(--text-secondary)",fontStyle:"italic"},children:"No results yet"})]})]})},fo=({gameState:t,onGamble:r,onClose:d})=>{const[x,i]=j.useState("racing");return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{height:"95vh",maxWidth:"1000px",width:"98%",padding:"0",display:"flex",flexDirection:"column",overflow:"hidden",borderRadius:"12px",border:"4px double var(--border-color)"},children:[e.jsxs("div",{style:{padding:"10px 20px",borderBottom:"2px solid var(--border-color)",background:"var(--accent-color)",color:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h2",{style:{borderBottom:"none",margin:0,fontSize:"1.4rem",textShadow:"1px 1px 0 rgba(0,0,0,0.3)"},children:"üç∫ The Rusty Tankard"}),e.jsxs("div",{style:{fontSize:"0.9rem",background:"rgba(0,0,0,0.2)",padding:"4px 10px",borderRadius:"4px"},children:["Gold: ",e.jsx("span",{style:{color:"var(--gold-color)",fontWeight:"bold"},children:M(t.gold,t.numberFormat)})]})]}),e.jsxs("div",{style:{display:"flex",background:"var(--bg-color)",borderBottom:"2px solid var(--border-color)",overflowX:"auto"},children:[e.jsx("button",{onClick:()=>i("racing"),style:{flex:1,minWidth:"90px",padding:"12px 10px",border:"none",background:x==="racing"?"var(--panel-bg)":"transparent",fontWeight:"bold",color:x==="racing"?"var(--accent-color)":"var(--text-secondary)",cursor:"pointer",borderBottom:x==="racing"?"3px solid var(--accent-color)":"3px solid transparent",transition:"all 0.2s"},children:"üèá Racing"}),e.jsx("button",{onClick:()=>i("coin"),style:{flex:1,minWidth:"90px",padding:"12px 10px",border:"none",background:x==="coin"?"var(--panel-bg)":"transparent",fontWeight:"bold",color:x==="coin"?"var(--accent-color)":"var(--text-secondary)",cursor:"pointer",borderBottom:x==="coin"?"3px solid var(--accent-color)":"3px solid transparent",transition:"all 0.2s"},children:"üü° Coin"}),e.jsx("button",{onClick:()=>i("dice"),style:{flex:1,minWidth:"90px",padding:"12px 10px",border:"none",background:x==="dice"?"var(--panel-bg)":"transparent",fontWeight:"bold",color:x==="dice"?"var(--accent-color)":"var(--text-secondary)",cursor:"pointer",borderBottom:x==="dice"?"3px solid var(--accent-color)":"3px solid transparent",transition:"all 0.2s"},children:"üé≤ Dice"})]}),e.jsxs("div",{style:{background:"var(--bg-color)",flex:1,overflow:"hidden",position:"relative",display:"flex",flexDirection:"column"},children:[x==="racing"&&e.jsx(uo,{gameState:t,onGamble:(a,b)=>r(a,b),onLeave:d}),x==="coin"&&e.jsx(po,{gameState:t,onGamble:(a,b)=>r(a,b),onLeave:d}),x==="dice"&&e.jsx(go,{gameState:t,onGamble:(a,b)=>r(a,b),onLeave:d})]}),e.jsx("div",{style:{padding:"8px",borderTop:"2px solid var(--border-color)",background:"var(--panel-bg)",textAlign:"center",flexShrink:0},children:e.jsx("button",{className:"btn",onClick:d,style:{background:"#5d4037",padding:"8px 20px",fontSize:"0.9rem",width:"auto"},children:"Exit Tavern"})})]})})},xo=({gameState:t,onPrestige:r,onClose:d})=>{var E;const i=o(1e12),a=t.totalGold;let b=o(0),c=!1,k=i.minus(a);if(a.gte(i)){const $=a.dividedBy(i);b=o(Math.floor(Math.pow($.toNumber(),.33))).times(1).minus(t.renown),b.lt(0)&&(b=o(0)),c=b.gt(0)}const g=t.renown.plus(b),y=i.times(Math.pow(Math.floor(g.dividedBy(1).toNumber()+1),1/.33)),p=y.minus(a),C=we(t.totalRenownEarned).minus(o(1)).times(o(100)),F=we(t.totalRenownEarned.plus(b)).minus(o(1)).times(o(100)),h=Object.values(t.nationalProjects||{}).some($=>$==null?void 0:$.active);return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{border:"4px solid #673ab7",maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[e.jsx("h2",{style:{color:"#673ab7"},children:"üëë Abdication"}),e.jsx("p",{children:"Are you ready to pass the crown to your heir?"}),e.jsxs("div",{style:{flex:1,overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:[!((E=t.playerProfile)!=null&&E.hasChosenName)&&e.jsxs("div",{style:{background:"rgba(255, 235, 59, 0.1)",border:"1px solid #ffc107",padding:"10px",borderRadius:"4px",marginBottom:"15px",fontSize:"0.9rem"},children:["üí° ",e.jsx("strong",{children:"Tip:"})," You can abdicate without choosing a ruler name. Choose a name only if you want to appear in the leaderboard."]}),e.jsxs("div",{style:{textAlign:"left",margin:"20px 0",background:"rgba(243, 229, 245, 0.5)",padding:"15px",borderRadius:"4px"},children:[e.jsx("div",{children:e.jsx("strong",{children:"You will lose:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"All Gold & Treasury"}),e.jsx("li",{children:"All Estates (Buildings)"}),e.jsx("li",{children:"Royal Scepter Levels"})]}),e.jsx("div",{children:e.jsx("strong",{children:"You will keep:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"Achievements"}),e.jsxs("li",{children:["Current Renown (",M(t.renown,t.numberFormat),")"]}),e.jsx("li",{children:"National Projects"}),e.jsx("li",{children:"Lifetime Stats & Leaderboard Rank"})]})]}),h&&e.jsx("div",{style:{marginBottom:"20px",padding:"10px",background:"rgba(255, 0, 0, 0.1)",border:"1px solid red",borderRadius:"4px",color:"#d32f2f",fontSize:"0.9rem",fontWeight:"bold",textAlign:"center"},children:"‚ö†Ô∏è WARNING: You have a National Project under construction! Abdication will cancel the construction. All progress and resources invested in the pending level will be lost."}),e.jsxs("div",{style:{fontSize:"1.2rem",marginBottom:"20px"},children:[e.jsxs("div",{style:{marginBottom:"5px",fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Current Renown: ",M(t.renown,t.numberFormat)]}),e.jsxs("div",{style:{marginBottom:"5px",fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Total Renown: ",M(t.totalRenownEarned,t.numberFormat)," (+",C.toNumber().toFixed(1),"%)"]}),e.jsx("hr",{style:{margin:"15px 0",borderTop:"1px dashed #ccc",borderBottom:"none"}}),e.jsxs("div",{style:{marginBottom:"5px",fontSize:"0.9rem",color:"var(--text-secondary)"},children:[e.jsx("strong",{children:"Renown Gain:"})," +",M(b,t.numberFormat)]}),e.jsxs("div",{style:{marginBottom:"5px",fontSize:"0.9rem",color:"var(--text-secondary)"},children:[e.jsx("strong",{children:"Total After Prestige:"})," ",M(t.totalRenownEarned.plus(b),t.numberFormat)," (+",F.toNumber().toFixed(1),"% bonus)"]}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"10px",background:"rgba(0,0,0,0.05)",padding:"5px",borderRadius:"4px"},children:[e.jsxs("div",{children:["Next Renown at: ",e.jsx("strong",{children:M(y,t.numberFormat)})," Lifetime Gold"]}),e.jsxs("div",{style:{color:p.gt(0)?"#cc0000":"var(--success-color)",fontWeight:"bold"},children:["(Need ",M(p.gt(0)?p:o(0),t.numberFormat)," more)"]})]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"20px"},children:[e.jsx("button",{className:"btn",style:{background:"#666"},onClick:d,children:"Cancel"}),e.jsx("button",{className:"btn",style:{background:"#673ab7"},onClick:r,disabled:!c,children:c?"Abdicate":a.lt(i)?`Need ${M(k,t.numberFormat)} more Gold`:"Prestige Unavailable"})]})]})})},mo=({gameState:t,onClose:r,onHardReset:d,onProgressReset:x,onSave:i,onSetTheme:a,onSetNumberFormat:b,onToggleIdleMode:c,onUpdateInterface:k})=>{var K,Y,B;const[g,y]=Se.useState(!1),p=t.interface||{density:"normal",showFloatingText:!0,showWeatherWidget:!0,layout:{left:o(1),center:o(1),right:o(1)}},R=(K=p.layout.left)!=null&&K.toNumber?p.layout.left.toNumber():Number(p.layout.left),C=(Y=p.layout.center)!=null&&Y.toNumber?p.layout.center.toNumber():Number(p.layout.center),A=(B=p.layout.right)!=null&&B.toNumber?p.layout.right.toNumber():Number(p.layout.right),F=()=>{g?x():y(!0)},h=(P,U)=>{k({layout:m(u({},p.layout),{[P]:o(U)})})},E={marginBottom:"8px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px",background:"rgba(0,0,0,0.03)",borderRadius:"4px"},$={width:"100%",marginBottom:"5px"};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[e.jsx("h2",{children:"‚öôÔ∏è Royal Settings"}),t.playerProfile&&e.jsxs("div",{style:{backgroundColor:"rgba(191, 144, 0, 0.1)",border:"2px solid var(--gold-color)",borderRadius:"4px",padding:"12px",marginBottom:"20px",textAlign:"center"},children:[e.jsxs("div",{style:{color:"var(--gold-color)",fontSize:"16px",fontWeight:"bold"},children:["üëë Your Ruler: ",t.playerProfile.rulerName," ",t.playerProfile.rulerId,t.playerProfile.specialIcon&&e.jsx("span",{style:{marginLeft:"5px"},children:t.playerProfile.specialIcon}),t.playerProfile.specialTitle&&e.jsx("span",{style:{marginLeft:"5px",color:"var(--accent-color)",fontSize:"14px"},children:t.playerProfile.specialTitle})]}),e.jsx("div",{style:{color:"var(--text-secondary)",fontSize:"12px",marginTop:"5px"},children:"Registered in Leaderboard System"})]}),e.jsxs("div",{style:{textAlign:"left",marginBottom:"20px",maxHeight:"60vh",overflowY:"auto",paddingRight:"5px",flex:1,overflowX:"hidden",WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:[e.jsx("h3",{style:{marginBottom:"10px"},children:"Layout Configuration"}),e.jsxs("div",{style:{marginBottom:"15px",background:"rgba(0,0,0,0.03)",padding:"10px",borderRadius:"4px"},children:[e.jsx("div",{style:{fontSize:"0.9rem",marginBottom:"5px",fontWeight:"bold"},children:"Column Widths (Ratio)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr auto",gap:"10px",alignItems:"center",marginBottom:"5px"},children:[e.jsx("span",{style:{fontSize:"0.8rem"},children:"Left"}),e.jsx("input",{type:"range",min:"1",max:"5",step:"0.5",value:R,onChange:P=>h("left",parseFloat(P.target.value)),style:$}),e.jsx("span",{style:{fontSize:"0.8rem"},children:R})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr auto",gap:"10px",alignItems:"center",marginBottom:"5px"},children:[e.jsx("span",{style:{fontSize:"0.8rem"},children:"Center"}),e.jsx("input",{type:"range",min:"1",max:"5",step:"0.5",value:C,onChange:P=>h("center",parseFloat(P.target.value)),style:$}),e.jsx("span",{style:{fontSize:"0.8rem"},children:C})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr auto",gap:"10px",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"0.8rem"},children:"Right"}),e.jsx("input",{type:"range",min:"1",max:"5",step:"0.5",value:A,onChange:P=>h("right",parseFloat(P.target.value)),style:$}),e.jsx("span",{style:{fontSize:"0.8rem"},children:A})]})]}),e.jsx("div",{style:{borderTop:"1px dashed #ccc",margin:"15px 0"}}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("div",{style:{fontSize:"0.9rem",marginBottom:"5px",fontWeight:"bold"},children:"Preset Themes"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"5px",justifyContent:"center"},children:Object.values(Ve).map(P=>e.jsx("button",{className:"btn",style:{background:t.theme===P.id?"var(--accent-color)":"var(--panel-bg)",color:t.theme===P.id?"var(--text-on-accent)":"var(--text-color)",border:"1px solid var(--border-color)",fontSize:"0.8rem",padding:"5px 10px",minWidth:"120px",textAlign:"center"},onClick:()=>a(P.id),children:P.name},P.id))})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("div",{style:{fontSize:"0.9rem",marginBottom:"5px",fontWeight:"bold"},children:"Layout Density"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"5px",justifyContent:"center"},children:["compact","normal","spacious"].map(P=>e.jsx("button",{className:"btn",style:{background:p.density===P?"var(--accent-color)":"var(--panel-bg)",color:p.density===P?"var(--text-on-accent)":"var(--text-color)",border:"1px solid var(--border-color)",fontSize:"0.8rem",textTransform:"capitalize",minWidth:"120px",textAlign:"center",padding:"5px 10px"},onClick:()=>k({density:P}),children:P},P))})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("div",{style:{fontSize:"0.9rem",marginBottom:"5px",fontWeight:"bold"},children:"Number Format"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"5px",justifyContent:"center"},children:["standard","scientific","plain"].map(P=>e.jsx("button",{className:"btn",style:{background:t.numberFormat===P?"var(--accent-color)":"var(--panel-bg)",color:t.numberFormat===P?"var(--text-on-accent)":"var(--text-color)",border:"1px solid var(--border-color)",fontSize:"0.8rem",padding:"5px 10px",textTransform:"capitalize",minWidth:"120px",textAlign:"center"},onClick:()=>b(P),children:P},P))})]}),e.jsx("div",{style:{borderTop:"1px dashed #ccc",margin:"15px 0"}}),e.jsxs("div",{style:E,children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem"},children:"Cinematic Idle Mode"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Show landscape when inactive. Wait 30 seconds after enabling."})]}),e.jsx("button",{className:"btn",style:{background:t.idleModeEnabled?"var(--success-color)":"#9e9e9e",minWidth:"60px"},onClick:c,children:t.idleModeEnabled?"ON":"OFF"})]}),e.jsxs("div",{style:E,children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem"},children:"Click Text"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Show floating numbers on click."})]}),e.jsx("button",{className:"btn",style:{background:p.showFloatingText?"var(--success-color)":"#9e9e9e",minWidth:"60px"},onClick:()=>k({showFloatingText:!p.showFloatingText}),children:p.showFloatingText?"ON":"OFF"})]}),e.jsxs("div",{style:E,children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem"},children:"Weather Widget"}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)"},children:"Show weather info in top left."})]}),e.jsx("button",{className:"btn",style:{background:p.showWeatherWidget?"var(--success-color)":"#9e9e9e",minWidth:"60px"},onClick:()=>k({showWeatherWidget:!p.showWeatherWidget}),children:p.showWeatherWidget?"ON":"OFF"})]})]}),e.jsxs("div",{style:{borderTop:"2px solid #ccc",paddingTop:"15px",marginTop:"15px",flexShrink:0},children:[e.jsx("h3",{children:"System"}),e.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn",onClick:i,children:"Force Save"}),e.jsx("button",{className:"btn",style:{backgroundColor:g?"red":"#d32f2f"},onClick:F,children:g?"CONFIRM WIPE?":"Reset Progress"})]}),g&&e.jsx("div",{style:{color:"red",fontSize:"0.8rem",marginTop:"5px"},children:"Warning: This will delete all progress but keep your settings!"})]}),e.jsx("button",{className:"btn",style:{marginTop:"20px",background:"#5d4037",width:"100%",flexShrink:0},onClick:r,children:"Return to Game"}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-secondary)",marginTop:"10px",flexShrink:0},children:"v2.3.0 - Kingdom Clicker"})]})})},ho=({onClose:t})=>e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{maxWidth:"600px",maxHeight:"80vh",display:"flex",flexDirection:"column"},children:[e.jsx("h2",{children:"üìú Royal Chronicles"}),e.jsx("div",{style:{overflowY:"auto",textAlign:"left",padding:"0 20px",flex:1},children:ht.map((r,d)=>e.jsxs("div",{style:{marginBottom:"20px",borderBottom:d<ht.length-1?"1px dashed #ccc":"none",paddingBottom:"10px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[e.jsxs("span",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"var(--accent-color)"},children:["v",r.version]}),e.jsx("span",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:r.date})]}),e.jsx("ul",{style:{margin:"5px 0",paddingLeft:"20px"},children:r.changes.map((x,i)=>e.jsx("li",{style:{marginBottom:"3px"},children:x},i))})]},r.version))}),e.jsx("button",{className:"btn",style:{marginTop:"20px",alignSelf:"center"},onClick:t,children:"Close Chronicles"})]})}),bo=({gameState:t,currentGps:r,currentTotalClicks:d,currentPrestigeClicks:x,onClose:i})=>{var K,Y,B;const a=Object.values(t.buildings).reduce((P,U)=>P.plus(U),o(0)),b=t.achievements.length,c=Pt.length;let k="None",g="None",y=-1,p=o(0);ue.forEach((P,U)=>{const V=t.buildings[P.id]||o(0);V.gt(o(0))&&U>y&&(y=U,k=P.name),V.gt(p)&&(p=V,g=P.name)});const C=(()=>{var T;const P=o(1),U=t.clickUpgradeLevel||0,V=Math.min(U,15),G=o(2).pow(V),H=P.times(G),X=we(t.totalRenownEarned);let J=H;X.gt(o(1))&&(J=H.times(X));const oe=Ge(U);if(oe>0){let O=o(0);ue.forEach(ee=>{const z=t.buildings[ee.id]||o(0);z.gt(0)&&(O=O.plus(z.times(ee.baseProduction)))});let Z=O;X.gt(o(1))&&(Z=O.times(X));let ne=0;t.nationalProjects&&Object.values(t.nationalProjects).forEach(ee=>ne+=ee.level||0);const ke=o(1).plus(o(ne*Je));Z=Z.times(ke);const ye=((T=t.weather)==null?void 0:T.current)||"clear";let ge=o(0);ue.forEach(ee=>{const z=t.buildings[ee.id]||o(0);if(z.gt(0)){let ae=o(1);ye==="sunny"?(ee.id==="peasant"||ee.id==="field"||ee.id==="stable"||ee.id==="cathedral")&&(ae=o(1.2)):ye==="rainy"?(ee.id==="silver_mine"||ee.id==="alchemist"||ee.id==="market"||ee.id==="tavern")&&(ae=o(1.2)):ye==="stormy"?((ee.id==="blacksmith"||ee.id==="void_portal")&&(ae=o(1.3)),(ee.id==="field"||ee.id==="stable")&&(ae=o(.8))):ye==="windy"&&(ee.id==="market"||ee.id==="castle"||ee.id==="time_chamber")&&(ae=o(1.15));const fe=z.times(ee.baseProduction);X.gt(o(1))?ge=ge.plus(fe.times(X).times(ke).times(ae.minus(o(1)))):ge=ge.plus(fe.times(ke).times(ae.minus(o(1))))}});const Be=Z.plus(ge),Oe=o(1).plus(o(t.achievements.length*.02)),Re=Be.times(Oe);let Me=Re;t.globalIncomeMultiplier&&(Me=Re.times(o(t.globalIncomeMultiplier))),J=J.plus(Me.times(oe))}const I=o(1).plus(o(t.achievements.length*.02));return J=J.times(I),t.globalIncomeMultiplier&&(J=J.times(o(t.globalIncomeMultiplier))),J})(),[A,F]=j.useState("");j.useEffect(()=>{const P=()=>{const V=o(Date.now()).minus(t.startTime),G=V.dividedBy(o(1e3)),H=G.minus(G.dividedBy(o(60)).floor().times(o(60))).floor(),X=V.dividedBy(o(6e4)),J=X.minus(X.dividedBy(o(60)).floor().times(o(60))).floor(),oe=V.dividedBy(o(36e5)),I=oe.minus(oe.dividedBy(o(24)).floor().times(o(24))).floor(),T=V.dividedBy(o(864e5)).floor();let O="";T.gt(o(0))&&(O+=`${T.toString()}d `),I.gt(o(0))&&(O+=`${I.toString()}h `),O+=`${J.toString()}m ${H.toString()}s`,F(O)};P();const U=setInterval(P,1e3);return()=>clearInterval(U)},[t.startTime]);const h={display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px dashed rgba(0,0,0,0.1)",fontSize:"0.9rem"},E={fontSize:"1rem",color:"var(--accent-color)",marginTop:"15px",borderBottom:"2px solid var(--border-color)",paddingBottom:"2px",marginBottom:"5px"},$=(K=t.weather)!=null&&K.current&&((Y=eo[t.weather.current])==null?void 0:Y.name)||"Unknown";return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{maxWidth:"500px",maxHeight:"90vh",display:"flex",flexDirection:"column",overflow:"hidden"},children:[e.jsx("h2",{style:{flexShrink:0},children:"üìä Royal Records"}),e.jsxs("div",{style:{textAlign:"left",marginBottom:"20px",overflowY:"auto",paddingRight:"10px",flex:1,minHeight:0},children:[e.jsx("h3",{style:E,children:"‚ö° Current Status"}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Gold Per Second:"}),e.jsxs("strong",{style:{color:"var(--success-color)"},children:[M(r,t.numberFormat)," / sec"]})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Click Power:"}),e.jsxs("strong",{style:{color:"var(--success-color)"},children:[M(C,t.numberFormat)," / click"]})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Current Weather:"}),e.jsx("strong",{children:$})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Current Renown:"}),e.jsx("strong",{style:{color:"#673ab7"},children:M(t.renown,t.numberFormat)})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Total Renown Earned:"}),e.jsx("strong",{style:{color:"#9575cd"},children:M(t.totalRenownEarned,t.numberFormat)})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Renown Bonus:"}),e.jsxs("strong",{style:{color:"#9575cd"},children:["+",we(t.totalRenownEarned).minus(o(1)).times(o(100)).toNumber().toString(),"%"]})]}),e.jsx("h3",{style:E,children:"‚è≥ Time & Legacy"}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Time Played:"}),e.jsx("strong",{children:A})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Kingdom Founded:"}),e.jsx("span",{children:new Date(t.startTime.toNumber()).toLocaleDateString()})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Total Renown:"}),e.jsx("strong",{children:M(t.renown,t.numberFormat)})]}),e.jsx("h3",{style:E,children:"üí∞ Economy Summary"}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Current Gold:"}),e.jsx("strong",{children:M(t.gold,t.numberFormat)})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Lifetime Gold:"}),e.jsx("strong",{children:M(t.totalGold,t.numberFormat)})]}),e.jsx("h3",{style:E,children:"üè∞ Dominion"}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Total Buildings:"}),e.jsx("strong",{children:M(a,t.numberFormat)})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Highest Tech Building:"}),e.jsx("strong",{children:k})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Most Numerous:"}),e.jsxs("strong",{children:[g," (",M(p,t.numberFormat),")"]})]}),e.jsx("h3",{style:E,children:"üìà Player Stats"}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Total Clicks:"}),e.jsx("span",{children:M(d,t.numberFormat)})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Current Prestige Clicks:"}),e.jsx("span",{children:M(x,t.numberFormat)})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Dragons Slain:"}),e.jsx("span",{children:M(t.stats.dragonsKilled,t.numberFormat)})]}),((B=t.buildings.tavern)==null?void 0:B.gt(o(0)))&&e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Tavern Games:"}),e.jsx("span",{children:M(t.stats.tavernGamesPlayed,t.numberFormat)})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Buildings Purchased:"}),e.jsx("span",{children:M(t.stats.totalBuildingsPurchased,t.numberFormat)})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Total Gold Spent:"}),e.jsx("span",{children:M(t.stats.totalGoldSpent,t.numberFormat)})]}),t.totalGold.gte(o(1e12))&&e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Times Prestiged:"}),e.jsx("span",{children:t.stats.prestigeCount})]}),(t.stats.clickUpgradeLevel>0||t.stats.offlineUpgradeLevel>0||t.totalGold.gte(o(1e18)))&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{style:E,children:"‚öîÔ∏è Upgrades & Power"}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Royal Scepter Level:"}),e.jsx("span",{children:t.stats.clickUpgradeLevel})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Passive Income Level:"}),e.jsx("span",{children:t.stats.offlineUpgradeLevel})]}),t.totalGold.gte(o(1e18))&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Infinite Tower Level:"}),e.jsx("span",{children:t.stats.infiniteTowerLevel})]}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Dark Matter Gold:"}),e.jsx("span",{style:{color:"#673ab7"},children:M(t.stats.darkMatterGold,t.numberFormat)})]})]})]}),e.jsx("h3",{style:E,children:"üéñÔ∏è Completion"}),e.jsxs("div",{style:h,children:[e.jsx("span",{children:"Achievements:"}),e.jsxs("span",{children:[b," / ",c," (",Math.floor(b/c*100),"%)"]})]}),e.jsx("h3",{style:E,children:"üèÜ Achievements"}),e.jsx(ro,{gameState:t})]}),e.jsx("button",{className:"btn",style:{background:"#5d4037",width:"100%",flexShrink:0},onClick:i,children:"Close Records"})]})})},yo=({gameState:t,onStartProject:r,onUpgradeClickPower:d,onUpgradeOffline:x,onClose:i})=>{const[a,b]=j.useState("royalScepter"),c=p=>{var Y;const R=o(1),C=Math.min(p,15),A=o(2).pow(C),F=R.times(A),h=we(t.totalRenownEarned);let E=F;h.gt(o(1))&&(E=F.times(h));const $=Ge(p);if($>0){let B=o(0);ue.forEach(T=>{const O=t.buildings[T.id]||o(0);O.gt(0)&&(B=B.plus(O.times(T.baseProduction)))});let P=B;h.gt(o(1))&&(P=B.times(h));let U=0;t.nationalProjects&&Object.values(t.nationalProjects).forEach(T=>U+=T.level||0);const V=o(1).plus(o(U*Je));P=P.times(V);const G=((Y=t.weather)==null?void 0:Y.current)||"clear";let H=o(0);ue.forEach(T=>{const O=t.buildings[T.id]||o(0);if(O.gt(0)){let Z=o(1);G==="sunny"?(T.id==="peasant"||T.id==="field"||T.id==="stable"||T.id==="cathedral")&&(Z=o(1.2)):G==="rainy"?(T.id==="silver_mine"||T.id==="alchemist"||T.id==="market"||T.id==="tavern")&&(Z=o(1.2)):G==="stormy"?((T.id==="blacksmith"||T.id==="void_portal")&&(Z=o(1.3)),(T.id==="field"||T.id==="stable")&&(Z=o(.8))):G==="windy"&&(T.id==="market"||T.id==="castle"||T.id==="time_chamber")&&(Z=o(1.15));const ne=O.times(T.baseProduction);h.gt(o(1))?H=H.plus(ne.times(h).times(V).times(Z.minus(o(1)))):H=H.plus(ne.times(V).times(Z.minus(o(1))))}});const X=P.plus(H),J=o(1).plus(o(t.achievements.length*.02)),oe=X.times(J);let I=oe;t.globalIncomeMultiplier&&(I=oe.times(o(t.globalIncomeMultiplier))),E=E.plus(I.times($))}const K=o(1).plus(o(t.achievements.length*.02));return E=E.times(K),t.globalIncomeMultiplier&&(E=E.times(o(t.globalIncomeMultiplier))),E};if(!(t.buildings.field||o(0)).gt(0))return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("h2",{children:"üèóÔ∏è National Projects"}),e.jsxs("div",{style:{padding:"20px",color:"var(--text-secondary)"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"10px"},children:"üîí"}),e.jsx("p",{children:"You must establish a functioning economy before launching national projects."}),e.jsx("p",{style:{fontWeight:"bold",color:"var(--accent-color)"},children:"Requirement: Build a Wheat Field."})]}),e.jsx("button",{className:"btn",onClick:i,children:"Close"})]})});const y=()=>{const p=t.clickUpgradeLevel||0,R=p>=Xe,C=p+1,A=Tt(C),F=t.gold.gte(A),h=o(2).pow(Math.min(p,15)),E=Ge(p),$=c(p);E>0?`${M(h)}${(E*100).toFixed(1)}`:M(h);const K=o(2).pow(Math.min(C,15)),Y=Ge(C),B=c(C);Y>0?`${M(K)}${(Y*100).toFixed(1)}`:M(K);const P=t.offlineUpgradeLevel||0,U=P>=Ie,V=P+1,G=Lt(V),H=t.renown.gte(G),{efficiency:X,duration:J}=Fe(P),{efficiency:oe,duration:I}=Fe(V),T=O=>{const Z=Math.floor(O/3600),ne=Math.floor(O%3600/60);return Z>0?`${Z}h ${ne}m`:`${ne}m`};return e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"15px"},children:[e.jsxs("div",{style:{border:"2px solid var(--border-color)",borderRadius:"8px",background:"var(--bg-color)",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"10px",background:"rgba(0,0,0,0.05)",color:"var(--text-color)",fontWeight:"bold",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"üëë Royal Scepter"}),e.jsxs("span",{children:["Lvl ",p," / ",Xe]})]}),e.jsxs("div",{style:{padding:"15px"},children:[e.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginBottom:"10px",fontStyle:"italic"},children:"Enhance your royal authority to increase click power."}),e.jsxs("div",{style:{marginBottom:"10px",fontSize:"0.9rem",color:"var(--success-color)",fontWeight:"bold"},children:["Current Power: ",M($)]}),R?e.jsx("div",{style:{textAlign:"center",padding:"10px",color:"var(--gold-color)",fontWeight:"bold",border:"1px solid var(--gold-color)",borderRadius:"4px",background:"rgba(255, 215, 0, 0.1)"},children:"MAXIMUM LEVEL REACHED"}):e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.85rem",marginBottom:"10px",background:"rgba(255,255,255,0.5)",padding:"5px",borderRadius:"4px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:"Next Level:"}),e.jsxs("div",{style:{marginBottom:"5px"},children:["Power: ",M(B)]}),e.jsxs("div",{style:{color:F?"green":"red",fontWeight:"bold"},children:["üí∞ ",M(A)," Gold"]})]}),e.jsx("button",{className:"btn",style:{width:"100%",background:F?"var(--accent-color)":"var(--border-color)",cursor:F?"pointer":"not-allowed"},disabled:!F,onClick:d,children:"Upgrade Scepter"})]})]})]}),e.jsxs("div",{style:{border:"2px solid var(--border-color)",borderRadius:"8px",background:"var(--bg-color)",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"10px",background:"rgba(0,0,0,0.05)",color:"var(--text-color)",fontWeight:"bold",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"üí§ Offline Production"}),e.jsxs("span",{children:["Lvl ",P," / ",Ie]})]}),e.jsxs("div",{style:{padding:"15px"},children:[e.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)",marginBottom:"10px",fontStyle:"italic"},children:["Improve the efficiency of your kingdom while you are away.",e.jsx("br",{}),"‚è±Ô∏è Higher levels increase both efficiency % and maximum production time."]}),e.jsxs("div",{style:{marginBottom:"10px",fontSize:"0.9rem",color:"var(--success-color)",fontWeight:"bold"},children:["Current: ",(X*100).toFixed(0),"% for ",T(J)]}),!U&&e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("div",{style:{width:"100%",height:"8px",background:"#ccc",borderRadius:"4px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${P/Ie*100}%`,height:"100%",background:"var(--success-color)",transition:"width 0.3s ease"}})}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center",marginTop:"2px"},children:[Ie-P," levels to max"]})]}),U?e.jsx("div",{style:{textAlign:"center",padding:"10px",color:"var(--gold-color)",fontWeight:"bold",border:"1px solid var(--gold-color)",borderRadius:"4px",background:"rgba(255, 215, 0, 0.1)"},children:"MAXIMUM LEVEL REACHED"}):e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.85rem",marginBottom:"10px",background:"rgba(255,255,255,0.5)",padding:"5px",borderRadius:"4px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:"Next Level:"}),e.jsxs("div",{style:{marginBottom:"5px"},children:["Effect: ",(oe*100).toFixed(0),"% for ",T(I)]}),e.jsxs("div",{style:{color:H?"#673ab7":"red",fontWeight:"bold"},children:["üëë ",M(G)," Renown"]})]}),e.jsx("button",{className:"btn",style:{width:"100%",background:H?"#673ab7":"var(--border-color)",cursor:H?"pointer":"not-allowed"},disabled:!H,onClick:x,children:"Upgrade Passive Income"})]})]})]})]})};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{maxWidth:"1000px",width:"95%",height:"85vh",display:"flex",flexDirection:"column",padding:"0"},children:[e.jsxs("div",{style:{padding:"20px",background:"var(--accent-color)",color:"var(--text-on-accent)"},children:[e.jsx("h2",{style:{margin:0,border:"none",color:"var(--gold-color)"},children:"üèõÔ∏è National Projects"}),e.jsx("p",{style:{margin:"5px 0 0 0",fontSize:"0.9rem",opacity:.9},children:"Invest resources to permanently improve your kingdom's power. All improvements persist through prestige."})]}),e.jsx("div",{style:{display:"flex",background:"var(--bg-color)",borderBottom:"2px solid var(--border-color)",padding:"0 20px"},children:e.jsx("button",{className:"btn",style:{background:"var(--accent-color)",border:"none",borderBottom:"3px solid var(--gold-color)",borderRadius:"0",padding:"15px 20px",margin:"0",fontWeight:"bold",color:"var(--text-on-accent)"},children:"üëë Royal Scepter"})}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"20px",background:"var(--panel-bg)"},children:y()}),e.jsx("div",{style:{padding:"15px",borderTop:"1px solid var(--border-color)",textAlign:"right",background:"var(--bg-color)"},children:e.jsx("button",{className:"btn",onClick:i,children:"Return to Kingdom"})})]})})},vo=({gameState:t})=>{const{weather:r,buildings:d,totalGold:x}=t,i=R=>{var C;return((C=d[R])==null?void 0:C.toNumber())||0};let a="wilderness";i("palace")>0?a="empire":i("castle")>0||i("market")>0?a="city":(i("peasant")>20||i("field")>10||x.gt(o(500)))&&(a="hamlet");let b="",c="";switch(a){case"wilderness":b="linear-gradient(to bottom, #87CEEB 0%, #87CEEB 60%, #556B2F 60%, #556B2F 100%)",c="üå≤ üå≥ üå≤ ü¶å üå≤ üåø";break;case"hamlet":b="linear-gradient(to bottom, #87CEEB 0%, #87CEEB 65%, #8B4513 65%, #228B22 80%)",c="üè° üåæ üêÑ üè° üåæ üöú";break;case"city":b="linear-gradient(to bottom, #B0C4DE 0%, #B0C4DE 60%, #696969 60%, #808080 100%)",c="üè∞ üè† ‚öíÔ∏è üè† ‚öñÔ∏è üè†";break;case"empire":b="linear-gradient(to bottom, #191970 0%, #4B0082 50%, #FFD700 100%)",c="üèØ üíÇ üèõÔ∏è üêâ üèõÔ∏è üíÇ";break}const k=r.current;let g="none",y="",p=0;return k==="rainy"?(g="linear-gradient(to bottom, rgba(0,0,50,0.3), rgba(0,0,100,0.3))",y="üåßÔ∏è üåßÔ∏è üåßÔ∏è üåßÔ∏è üåßÔ∏è",p=1):k==="stormy"?(g="linear-gradient(to bottom, rgba(0,0,0,0.6), rgba(50,50,50,0.6))",y="‚ö° ‚õàÔ∏è ‚ö° ‚õàÔ∏è ‚ö°",p=1):k==="sunny"?(g="radial-gradient(circle at top right, rgba(255,255,0,0.3), transparent)",y="‚òÄÔ∏è",p=.6):k==="windy"&&(y="üçÉ üçÉ üçÉ",p=.8),e.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:b,display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"center",paddingBottom:"20vh",zIndex:0,overflow:"hidden",transition:"background 2s ease"},children:[e.jsx("div",{style:{position:"absolute",top:"10%",width:"100%",textAlign:"center",fontSize:"5rem",opacity:p,animation:k==="windy"?"float 3s infinite ease-in-out":"none"},children:y}),g!=="none"&&e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:g,pointerEvents:"none"}}),e.jsx("div",{style:{fontSize:"4rem",textAlign:"center",zIndex:1,textShadow:"0 4px 4px rgba(0,0,0,0.3)",whiteSpace:"nowrap"},children:c}),e.jsx("div",{style:{marginTop:"20px",fontSize:"1.5rem",color:"#fff",textShadow:"2px 2px 4px #000",fontStyle:"italic",zIndex:2,background:"rgba(0,0,0,0.5)",padding:"5px 15px",borderRadius:"15px"},children:"The Kingdom sleeps..."}),e.jsx("style",{children:`
            @keyframes float {
                0% { transform: translateX(0px); }
                50% { transform: translateX(20px); }
                100% { transform: translateX(0px); }
            }
        `})]})},jo={apiKey:"AIzaSyA1Dw5M2Zk8bpTCjlU2Tuifvx0ZI3IeRv0",authDomain:"kingdomclicker-156dc.firebaseapp.com",projectId:"kingdomclicker-156dc",storageBucket:"kingdomclicker-156dc.firebasestorage.app",messagingSenderId:"496461589742",appId:"1:496461589742:web:e6413dfa2d1bbabd3ad7ff"},wo=no(jo),he=so(wo);function ko(){return`#${Math.floor(Math.random()*99999).toString().padStart(5,"0")}`}function So(){const t=new Date,r=t.getDay(),d=t.getDate()-r+(r===0?-6:1);return new Date(t.setDate(d))}function Ae(t){return de(this,null,function*(){var r,d,x;try{console.log("üöÄ Starting leaderboard submission for:",t.rulerName),console.log("üìä Data to submit:",{rulerName:t.rulerName,rulerId:t.rulerId,gold:(r=t.gold)==null?void 0:r.toString(),renown:(d=t.renown)==null?void 0:d.toString(),achievements:t.achievements,totalClicks:(x=t.totalClicks)==null?void 0:x.toString(),period:t.period});const i=m(u({},t),{period:"alltime"}),a=m(u({},t),{period:"weekly"}),b=Te(he,"leaderboard_alltime",t.rulerId),c=m(u({},i),{gold:Number(i.gold.toString()),achievements:Number(i.achievements),renown:Number(i.renown.toString()),totalClicks:i.totalClicks.toString(),timestamp:Ce()});i.buildings!==void 0&&(c.buildings=Number(i.buildings)),console.log("üì§ Submitting alltime data:",c),yield Le(b,c),console.log("‚úÖ Alltime data submitted successfully");const k=Te(he,"leaderboard_weekly",t.rulerId),g=m(u({},a),{gold:Number(a.gold.toString()),achievements:Number(a.achievements),renown:Number(a.renown.toString()),totalClicks:a.totalClicks.toString(),timestamp:Ce()});return a.buildings!==void 0&&(g.buildings=Number(a.buildings)),console.log("üì§ Submitting weekly data:",g),yield Le(k,g),console.log("‚úÖ Weekly data submitted successfully"),{allTimeId:t.rulerId,weeklyId:t.rulerId}}catch(i){throw console.error("‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ –ª–∏–¥–µ—Ä–±–æ—Ä–¥:"),console.error("–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:",i),i instanceof Error&&(console.error("–°–æ–æ–±—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏:",i.message),console.error("–°—Ç–µ–∫ –æ—à–∏–±–∫–∏:",i.stack)),"code"in i&&(console.error("–ö–æ–¥ –æ—à–∏–±–∫–∏ Firebase:",i.code),console.error("–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:",i.customData)),i}})}function Co(t=100){return de(this,null,function*(){try{console.log("üîç –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö all-time –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞...");const r=Bt(Rt(he,"leaderboard_alltime"),Mt("gold","desc"),Nt(t));console.log("üì° –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∫ Firestore...");const d=yield Et(r);console.log("üìä –ü–æ–ª—É—á–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:",d.docs.length);const x=d.docs.map(i=>{const a=i.data();return m(u({id:i.id},a),{gold:a.gold instanceof le?a.gold:new le(a.gold),renown:a.renown instanceof le?a.renown:new le(a.renown),totalClicks:a.totalClicks instanceof le?a.totalClicks:typeof a.totalClicks=="string"?new le(a.totalClicks):new le(a.totalClicks),timestamp:a.timestamp})});return console.log("‚úÖ All-time –ª–∏–¥–µ—Ä–±–æ—Ä–¥ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω, –∑–∞–ø–∏—Å–µ–π:",x.length),x}catch(r){throw console.error("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ all-time –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞:"),console.error("–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:",r),r instanceof Error&&(console.error("–°–æ–æ–±—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏:",r.message),console.error("–°—Ç–µ–∫ –æ—à–∏–±–∫–∏:",r.stack)),"code"in r&&console.error("–ö–æ–¥ –æ—à–∏–±–∫–∏ Firebase:",r.code),r}})}function Po(t=100){return de(this,null,function*(){try{console.log("üîç –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö weekly –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞...");const r=So();console.log("üìÖ –ù–∞—á–∞–ª–æ –Ω–µ–¥–µ–ª–∏:",r.toISOString());const d=Bt(Rt(he,"leaderboard_weekly"),Mt("gold","desc"),Nt(t));console.log("üì° –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∫ Firestore...");const x=yield Et(d);console.log("üìä –ü–æ–ª—É—á–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:",x.docs.length);const a=x.docs.map(b=>{const c=b.data();return m(u({id:b.id},c),{gold:c.gold instanceof le?c.gold:new le(c.gold),renown:c.renown instanceof le?c.renown:new le(c.renown),totalClicks:c.totalClicks instanceof le?c.totalClicks:typeof c.totalClicks=="string"?new le(c.totalClicks):new le(c.totalClicks),timestamp:c.timestamp})}).filter(b=>{var g,y;const c=((y=(g=b.timestamp)==null?void 0:g.toDate)==null?void 0:y.call(g))||new Date(b.timestamp),k=c>=r;return k||console.log("üóëÔ∏è –ó–∞–ø–∏—Å—å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–∞ (—Å—Ç–∞—Ä–∞—è –¥–∞—Ç–∞):",c.toISOString()),k});return console.log("‚úÖ Weekly –ª–∏–¥–µ—Ä–±–æ—Ä–¥ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω, –∑–∞–ø–∏—Å–µ–π –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:",a.length),a}catch(r){throw console.error("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ weekly –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞:"),console.error("–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:",r),r instanceof Error&&(console.error("–°–æ–æ–±—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏:",r.message),console.error("–°—Ç–µ–∫ –æ—à–∏–±–∫–∏:",r.stack)),"code"in r&&console.error("–ö–æ–¥ –æ—à–∏–±–∫–∏ Firebase:",r.code),r}})}function kt(t,r,d){return de(this,null,function*(){try{const x=`lastStatsSave_${r}`,i=localStorage.getItem(x),a=Date.now(),b=3600*1e3;if(i&&a-parseInt(i)<b)return;let c=0;const k={};Object.keys(t.buildings).forEach(R=>{const C=Number(t.buildings[R].toString());k[R]=C,c+=C});const g=Math.floor((Date.now()-Number(t.startTime.toString()))/1e3),y={rulerId:r,rulerName:d,totalBuildings:k,totalBuildingsPurchased:c,totalGoldSpent:t.totalGoldSpent||new le(0),totalGoldEarned:t.totalGold,totalClicks:t.stats.totalClicks,currentPrestigeClicks:t.stats.currentPrestigeClicks,prestigeCount:t.prestigeCount||0,totalRenownEarned:t.totalRenownEarned,nationalProjects:Object.keys(t.nationalProjects||{}).reduce((R,C)=>(R[C]=t.nationalProjects[C].level||0,R),{}),clickUpgradeLevel:t.clickUpgradeLevel||0,offlineUpgradeLevel:t.offlineUpgradeLevel||0,tavernGamesPlayed:Number(t.stats.tavernGamesPlayed.toString()),dragonsKilled:Number(t.stats.dragonsKilled.toString()),achievements:t.achievements,playTime:g,lastUpdated:Ce(),createdAt:Ce()},p=Te(he,"playerStats",r);yield Le(p,{rulerId:r,rulerName:d,totalBuildings:k,totalBuildingsPurchased:c,totalGoldSpent:y.totalGoldSpent.toString(),totalGoldEarned:y.totalGoldEarned.toString(),totalClicks:y.totalClicks.toString(),currentPrestigeClicks:y.currentPrestigeClicks.toString(),prestigeCount:y.prestigeCount,totalRenownEarned:y.totalRenownEarned.toString(),nationalProjects:y.nationalProjects,clickUpgradeLevel:y.clickUpgradeLevel,offlineUpgradeLevel:y.offlineUpgradeLevel,tavernGamesPlayed:y.tavernGamesPlayed,dragonsKilled:y.dragonsKilled,achievements:y.achievements,playTime:y.playTime,lastUpdated:Ce(),createdAt:Ce()}),localStorage.setItem(`lastStatsSave_${r}`,Date.now().toString()),console.log("‚úÖ Player stats successfully saved")}catch(x){throw console.error("‚ùå Error saving player stats:",x),x}})}function To(t,r){return de(this,null,function*(){try{const d=Te(he,"players",t);yield Le(d,{rulerName:r},{merge:!0});const x=Te(he,"leaderboard_alltime",t);yield Le(x,{rulerName:r},{merge:!0});const i=Te(he,"leaderboard_weekly",t);yield Le(i,{rulerName:r},{merge:!0}),console.log("‚úÖ Ruler name successfully updated")}catch(d){throw console.error("‚ùå Error updating ruler name:",d),d}})}const Lo=({isOpen:t,onClose:r,onConfirm:d,gameState:x})=>{const[i,a]=j.useState(""),[b,c]=j.useState(!1);if(!t)return null;const k=()=>de(null,null,function*(){if(i.trim().length<3){alert("Ruler name must contain at least 3 characters!");return}if(i.trim().length>20){alert("Ruler name must not exceed 20 characters!");return}c(!0);try{const y={id:`player_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,rulerName:i.trim(),rulerId:ko(),lastLeaderboardView:0,lastLeaderboardSubmit:0,hasChosenName:!0,usedPromoCodes:[]};d(y),r()}catch(g){alert("An error occurred while creating profile. Please try again.")}finally{c(!1)}});return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{backgroundColor:"#fdf6e3",border:"4px solid #8d6e63",borderRadius:"8px",padding:"32px",maxWidth:"500px",width:"90%",textAlign:"center",fontFamily:"Georgia, serif"},children:[e.jsx("h2",{style:{color:"#3e2723",marginBottom:"16px"},children:"üëë Royal Coronation! üëë"}),e.jsxs("p",{style:{color:"#5d4037",marginBottom:"24px",lineHeight:"1.5"},children:["Congratulations! Your kingdom has reached ",e.jsx("strong",{children:Bo(x.gold)})," gold!",e.jsx("br",{}),"It's time to choose a name for your ruler and enter the history books!"]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("label",{style:{display:"block",color:"#3e2723",marginBottom:"8px",fontWeight:"bold"},children:"Ruler Name:"}),e.jsx("input",{type:"text",value:i,onChange:g=>a(g.target.value),placeholder:"Enter your name...",maxLength:20,style:{width:"100%",padding:"12px",border:"2px solid #a1887f",borderRadius:"4px",fontSize:"16px",fontFamily:"Arial, sans-serif",backgroundColor:"#fff",color:"#3e2723"},onKeyPress:g=>g.key==="Enter"&&k()}),e.jsxs("div",{style:{fontSize:"12px",color:"#8d6e63",marginTop:"4px",textAlign:"left"},children:[i.length,"/20 characters"]})]}),e.jsx("div",{style:{backgroundColor:"#fff3e0",border:"2px solid #bf9000",borderRadius:"4px",padding:"12px",marginBottom:"24px"},children:e.jsx("p",{style:{color:"#bf9000",margin:0,fontSize:"14px",fontWeight:"bold"},children:"‚ö†Ô∏è Important: You'll be able to join the leaderboard and compete with players from around the world!"})}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[e.jsx("button",{type:"button",onClick:k,disabled:b||i.trim().length<3,style:{padding:"12px 24px",backgroundColor:b||i.trim().length<3?"#cccccc":"#2e7d32",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",fontWeight:"bold",cursor:b||i.trim().length<3?"not-allowed":"pointer",fontFamily:"Georgia, serif"},children:b?"Creating profile...":"Ascend the Throne"}),e.jsx("button",{type:"button",onClick:r,style:{padding:"12px 24px",backgroundColor:"#c62828",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",cursor:"pointer",fontFamily:"Georgia, serif",transition:"background-color 0.2s"},onMouseOver:g=>{g.currentTarget.style.backgroundColor="#d32f2f"},onMouseOut:g=>{g.currentTarget.style.backgroundColor="#c62828"},children:"Later"})]})]})})};function Bo(t){return t.lt(1e3)?t.toFixed(0):t.lt(1e6)?t.toNumber().toLocaleString():t.toExponential(2)}const Ro=({isOpen:t,onClose:r,playerProfile:d,onOpenRulerNameModal:x,gameState:i,onForceSubmit:a,addToast:b})=>{const[c,k]=j.useState([]),[g,y]=j.useState([]),[p,R]=j.useState("alltime"),[C,A]=j.useState(!1),[F,h]=j.useState(null),[E,$]=j.useState(0),[K,Y]=j.useState(0),B=()=>{const I=localStorage.getItem("leaderboardCache");if(I)try{const{data:T,timestamp:O}=JSON.parse(I),Z=Date.now(),ne=3600*1e3;if(Z-O<ne&&T&&T.allTime&&T.weekly)return T}catch(T){console.error("Cache parse error:",T)}return null},P=I=>{const T={data:I,timestamp:Date.now()};localStorage.setItem("leaderboardCache",JSON.stringify(T)),Y(Date.now())},U=()=>{const I=localStorage.getItem("leaderboardCache");if(I){const{timestamp:T}=JSON.parse(I),O=Date.now(),Z=3600*1e3;return O-T<Z}return!1};j.useEffect(()=>{if(t){if(U())try{const I=B();if(I){k(I.allTime),y(I.weekly);const T=JSON.parse(localStorage.getItem("leaderboardCache"));Y(T.timestamp);return}}catch(I){console.error("Cache read error:",I)}V()}},[t]);const V=()=>de(null,null,function*(){A(!0),h(null);try{const I=new Promise((Z,ne)=>setTimeout(()=>ne(new Error("Loading timeout")),1e4)),[T,O]=yield Promise.all([Promise.race([Co(50),I]),Promise.race([Po(50),I])]);k(T),y(O),P({allTime:T,weekly:O})}catch(I){console.error("Error loading leaderboard:",I),h("Failed to load leaderboard. Please check your internet connection and try again.")}finally{A(!1)}}),G=I=>{switch(I){case 1:return"ü•á";case 2:return"ü•à";case 3:return"ü•â";default:return`#${I}`}},H=()=>d?(p==="alltime"?c:g).findIndex(T=>T.rulerId===d.rulerId)+1:-1,X=()=>{const I=p==="alltime"?c:g;if(I.length>0){let T=0;if(I.forEach(O=>{if(O.timestamp){let Z=0;typeof O.timestamp=="object"&&O.timestamp.toDate?Z=O.timestamp.toDate().getTime():typeof O.timestamp=="number"?Z=O.timestamp:typeof O.timestamp=="string"&&(Z=new Date(O.timestamp).getTime()),Z>T&&(T=Z)}}),T>0)return T}return K},J=p==="alltime"?c:g,oe=J.length>0;return t?e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{maxWidth:"800px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h2",{children:"üèÜ Leaderboard üèÜ"}),e.jsx("button",{className:"btn",onClick:r,children:"Close"})]}),!d&&e.jsxs("div",{style:{backgroundColor:"rgba(191, 144, 0, 0.1)",border:"2px solid var(--gold-color)",borderRadius:"4px",padding:"15px",marginBottom:"16px",textAlign:"center"},children:[e.jsx("h4",{style:{color:"var(--gold-color)",margin:"0 0 8px 0",fontSize:"14px"},children:"üëÅ View Only Mode"}),e.jsxs("p",{style:{color:"var(--text-secondary)",margin:"0",fontSize:"12px",lineHeight:"1.4"},children:[e.jsx("strong",{children:"Anyone can view leaderboard!"})," Choose a name at 10M gold to participate."]}),x&&i&&i.gold&&i.gold.gte(1e7)&&e.jsx("button",{className:"btn",onClick:()=>{r(),x()},style:{backgroundColor:"var(--accent-color)",padding:"6px 12px",fontSize:"12px",marginTop:"8px"},children:"üëë Choose Ruler Name"})]}),oe&&e.jsx("div",{style:{backgroundColor:"rgba(191, 144, 0, 0.1)",border:"2px solid var(--gold-color)",borderRadius:"4px",padding:"12px",marginBottom:"16px",textAlign:"center",fontSize:"12px"},children:e.jsxs("span",{style:{color:"var(--gold-color)"},children:["üìä Data updated ",Math.floor((Date.now()-X())/6e4)," minutes ago"]})}),C&&e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"var(--text-secondary)"},children:"Loading leaderboard data..."}),F&&e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"var(--danger-color)"},children:F}),d&&oe&&e.jsxs("div",{style:{backgroundColor:"rgba(191, 144, 0, 0.1)",border:"2px solid var(--gold-color)",borderRadius:"4px",padding:"12px",marginBottom:"16px",textAlign:"center"},children:[e.jsxs("div",{style:{color:"var(--gold-color)",fontSize:"14px",fontWeight:"bold"},children:["üëë You are playing as: ",d.rulerName," ",d.rulerId,d.specialIcon&&e.jsx("span",{style:{marginLeft:"5px"},children:d.specialIcon}),d.specialTitle&&e.jsx("span",{style:{marginLeft:"5px",color:"var(--accent-color)",fontSize:"12px"},children:d.specialTitle})]}),J.length>0&&e.jsxs("div",{style:{color:"var(--text-secondary)",fontSize:"12px",marginTop:"5px"},children:["Your Rank: ",H()>0?`#${H()}`:"Not ranked yet"," in ",p==="alltime"?"All Time":"Weekly"]})]}),oe&&e.jsxs("div",{style:{display:"flex",marginBottom:"16px",borderBottom:"2px solid var(--border-color)"},children:[e.jsx("button",{onClick:()=>R("alltime"),className:p==="alltime"?"tab-btn active":"tab-btn",children:"All Time"}),e.jsx("button",{onClick:()=>R("weekly"),className:p==="weekly"?"tab-btn active":"tab-btn",children:"This Week"})]}),oe&&!C&&!F&&e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto",border:"2px solid var(--border-color)",borderRadius:"4px",backgroundColor:"var(--panel-bg)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{style:{backgroundColor:"var(--accent-color)",color:"white",position:"sticky",top:0},children:e.jsxs("tr",{children:[e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Rank"}),e.jsx("th",{style:{padding:"12px",textAlign:"left"},children:"Ruler"}),e.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Gold"}),e.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Renown"}),e.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Clicks"}),e.jsx("th",{style:{padding:"12px",textAlign:"right"},children:"Achievements"})]})}),e.jsx("tbody",{children:J.map((I,T)=>e.jsxs("tr",{style:{backgroundColor:(d==null?void 0:d.rulerId)===I.rulerId?"rgba(191, 144, 0, 0.1)":T%2===0?"rgba(0, 0, 0, 0.02)":"transparent",borderBottom:"1px solid var(--border-color)"},children:[e.jsx("td",{style:{padding:"10px",fontWeight:"bold",color:"var(--text-color)"},children:G(T+1)}),e.jsx("td",{style:{padding:"10px",color:"var(--text-color)"},children:e.jsxs("div",{children:[e.jsxs("strong",{children:[I.rulerName,(d==null?void 0:d.specialIcon)&&d.rulerId===I.rulerId&&e.jsx("span",{style:{marginLeft:"5px"},children:d.specialIcon})]}),e.jsxs("div",{style:{fontSize:"12px",color:"var(--text-secondary)"},children:[I.rulerId,(d==null?void 0:d.specialTitle)&&d.rulerId===I.rulerId&&e.jsx("span",{style:{marginLeft:"5px",color:"var(--accent-color)"},children:d.specialTitle})]})]})}),e.jsx("td",{style:{padding:"10px",textAlign:"right",color:"var(--gold-color)",fontWeight:"bold"},children:M(I.gold,"standard")}),e.jsx("td",{style:{padding:"10px",textAlign:"right",color:"var(--text-secondary)"},children:M(I.renown,"standard")}),e.jsx("td",{style:{padding:"10px",textAlign:"right",color:"var(--text-secondary)"},children:M(I.totalClicks,"standard")}),e.jsx("td",{style:{padding:"10px",textAlign:"right",color:"var(--text-secondary)"},children:I.achievements})]},I.id))})]})}),e.jsx("div",{style:{marginTop:"16px",fontSize:"12px",color:"var(--text-secondary)",textAlign:"center"},children:"üí° Leaderboard updates automatically every hour. Data is cached for performance."})]})}):null},Mo=({gained:t,effectiveTime:r,totalTime:d,efficiency:x,completedProjects:i,currentLevel:a,maxDuration:b,onClose:c,numberFormat:k})=>{const g=y=>{const p=Math.floor(y/3600),R=Math.floor(y%3600/60),C=Math.floor(y%60),A=[];return p>0&&A.push(`${p}h`),R>0&&A.push(`${R}m`),(C>0||A.length===0)&&A.push(`${C}s`),A.join(" ")};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content",style:{border:"4px solid var(--accent-color)"},children:[e.jsx("h2",{children:"üåô Welcome Back, Ruler!"}),e.jsxs("div",{style:{padding:"20px",textAlign:"left"},children:[e.jsx("p",{children:"Your kingdom continued to operate while you were away."}),e.jsxs("div",{style:{background:"var(--panel-bg)",border:"1px solid var(--border-color)",padding:"15px",borderRadius:"4px",marginBottom:"15px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[e.jsx("span",{children:"Time Away:"}),e.jsx("strong",{children:g(d.toNumber())})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[e.jsx("span",{children:"Effective Production Time:"}),e.jsx("strong",{children:g(r.toNumber())})]}),r.toNumber()<d.toNumber()&&e.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",fontStyle:"italic",marginBottom:"5px",textAlign:"center"},children:["‚ö†Ô∏è Production time limited by upgrade level (max ",g(b),")"]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[e.jsx("span",{children:"Efficiency:"}),e.jsxs("strong",{children:[(x*100).toFixed(0),"% (Level ",a,"/20)"]})]}),e.jsx("div",{style:{borderTop:"1px dashed var(--border-color)",margin:"10px 0"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"1.2rem",color:"var(--gold-color)"},children:[e.jsx("span",{children:"Gold Earned:"}),e.jsxs("strong",{children:["+",M(t,k)]})]})]}),i.length>0&&e.jsxs("div",{children:[e.jsx("h3",{children:"‚úÖ Projects Completed"}),e.jsx("ul",{style:{paddingLeft:"20px",maxHeight:"150px",overflowY:"auto"},children:i.map((y,p)=>e.jsx("li",{style:{color:"var(--success-color)",marginBottom:"5px"},children:y},p))})]})]}),e.jsx("button",{className:"btn",onClick:c,style:{width:"100%",padding:"15px",fontSize:"1.1rem"},children:"Collect & Continue"})]})})},No=({gameState:t,onClose:r,onRedeemPromoCode:d,onBackToSettings:x})=>{const[i,a]=Se.useState(""),[b,c]=Se.useState(""),[k,g]=Se.useState("info"),[y,p]=Se.useState(!1),R=Y=>de(null,null,function*(){if(Y.preventDefault(),!i.trim()){c("Please enter a promo code"),g("error");return}p(!0),c("");try{yield d(i),a(""),c("Promo code redeemed successfully!"),g("success")}catch(B){c("Error redeeming promo code"),g("error")}finally{p(!1)}}),C={position:"fixed",top:"0",left:"0",right:"0",bottom:"0",backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},A={backgroundColor:"#2c2416",border:"3px solid #8b7355",borderRadius:"12px",padding:"30px",maxWidth:"500px",width:"100%",color:"#f4e4c1",fontFamily:"Georgia, serif",boxShadow:"0 0 30px rgba(0, 0, 0, 0.8)",maxHeight:"80vh",overflowY:"auto"},F={textAlign:"center",fontSize:"2rem",marginBottom:"20px",color:"#d4af37",textShadow:"2px 2px 4px rgba(0, 0, 0, 0.5)"},h={width:"100%",padding:"12px",fontSize:"1rem",backgroundColor:"#1a1611",border:"2px solid #8b7355",borderRadius:"6px",color:"#f4e4c1",fontFamily:"Georgia, serif",textTransform:"uppercase",letterSpacing:"1px",marginBottom:"15px"},E={background:"#9c27b0",color:"white",border:"none",padding:"12px 24px",fontSize:"1rem",borderRadius:"6px",cursor:"pointer",fontFamily:"Georgia, serif",fontWeight:"bold",width:"100%",marginBottom:"10px",opacity:y?.7:1},$={background:"#5d4037",color:"white",border:"none",padding:"12px 24px",fontSize:"1rem",borderRadius:"6px",cursor:"pointer",fontFamily:"Georgia, serif",width:"100%"},K={padding:"10px",borderRadius:"6px",marginBottom:"15px",textAlign:"center",fontSize:"0.9rem",backgroundColor:k==="success"?"#2e7d32":k==="error"?"#c62828":"#1565c0",border:`1px solid ${k==="success"?"#4caf50":k==="error"?"#f44336":"#2196f3"}`};return e.jsx("div",{style:C,onClick:r,children:e.jsxs("div",{style:A,onClick:Y=>Y.stopPropagation(),children:[e.jsx("h2",{style:F,children:"üé´ Promo Codes"}),e.jsxs("form",{onSubmit:R,children:[e.jsx("input",{type:"text",value:i,onChange:Y=>a(Y.target.value),placeholder:"Enter promo code...",style:h,maxLength:50,disabled:y}),e.jsx("button",{type:"submit",style:E,disabled:y,children:y?"Redeeming...":"Redeem Code"})]}),b&&e.jsx("div",{style:K,children:b}),e.jsx("div",{style:{fontSize:"0.8rem",color:"#8b7355",textAlign:"center",marginBottom:"20px",fontStyle:"italic"},children:"Enter promotional codes to receive special rewards!"}),e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px"},children:[x&&e.jsx("button",{style:m(u({},$),{background:"#666"}),onClick:x,children:"Back to Settings"}),e.jsx("button",{style:m(u({},$),{flex:"1"}),onClick:r,children:"Close"})]})]})})},Eo=({isOpen:t,onClose:r,onConfirm:d,currentName:x})=>{const[i,a]=j.useState(x),[b,c]=j.useState(!1);if(!t)return null;const k=()=>de(null,null,function*(){if(i.trim().length<3){alert("Ruler name must contain at least 3 characters!");return}if(i.trim().length>20){alert("Ruler name must not exceed 20 characters!");return}if(i.trim()===x.trim()){alert("New name must be different from current name!");return}c(!0);try{yield d(i.trim()),r()}catch(g){alert("Error changing name. Please try again.")}finally{c(!1)}});return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:3e3},children:e.jsxs("div",{style:{backgroundColor:"#fdf6e3",border:"4px solid #8d6e63",borderRadius:"8px",padding:"32px",maxWidth:"500px",width:"90%",textAlign:"center",fontFamily:"Georgia, serif"},children:[e.jsx("h2",{style:{color:"#3e2723",marginBottom:"16px"},children:"üëë Change Ruler Name üëë"}),e.jsxs("p",{style:{color:"#5d4037",marginBottom:"24px",lineHeight:"1.5"},children:["Current name: ",e.jsx("strong",{children:x}),e.jsx("br",{}),"Enter new name for your ruler:"]}),e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsx("label",{style:{display:"block",color:"#3e2723",marginBottom:"8px",fontWeight:"bold"},children:"New Name:"}),e.jsx("input",{type:"text",value:i,onChange:g=>a(g.target.value),placeholder:"Enter new name...",maxLength:20,style:{width:"100%",padding:"12px",border:"2px solid #a1887f",borderRadius:"4px",fontSize:"16px",fontFamily:"Arial, sans-serif",backgroundColor:"#fff",color:"#3e2723"},onKeyPress:g=>g.key==="Enter"&&k()}),e.jsxs("div",{style:{fontSize:"12px",color:"#8d6e63",marginTop:"4px",textAlign:"left"},children:[i.length,"/20 characters"]})]}),e.jsx("div",{style:{backgroundColor:"#fff3e0",border:"2px solid #bf9000",borderRadius:"4px",padding:"12px",marginBottom:"24px"},children:e.jsx("p",{style:{color:"#bf9000",margin:0,fontSize:"14px",fontWeight:"bold"},children:"‚ö†Ô∏è Warning: Name change will update your profile in leaderboard!"})}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[e.jsx("button",{type:"button",onClick:k,disabled:b||i.trim().length<3||i.trim()===x.trim(),style:{padding:"12px 24px",backgroundColor:b||i.trim().length<3||i.trim()===x.trim()?"#cccccc":"#2e7d32",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",fontWeight:"bold",cursor:b||i.trim().length<3||i.trim()===x.trim()?"not-allowed":"pointer",fontFamily:"Georgia, serif"},children:b?"Saving...":"Change Name"}),e.jsx("button",{type:"button",onClick:r,style:{padding:"12px 24px",backgroundColor:"#c62828",color:"white",border:"none",borderRadius:"4px",fontSize:"16px",cursor:"pointer",fontFamily:"Georgia, serif",transition:"background-color 0.2s"},onMouseOver:g=>{g.currentTarget.style.backgroundColor="#d32f2f"},onMouseOut:g=>{g.currentTarget.style.backgroundColor="#c62828"},children:"Cancel"})]})]})})},me={density:"normal",showFloatingText:!0,showWeatherWidget:!0,lastBuyAmount:o(1),layout:{left:o(1),center:o(1),right:o(1)},borderWidth:o(4),customColors:{enabled:!1,bg:"#e8dcc5",panel:"#fdf6e3",text:"#3e2723",secondaryText:"#5d4037",accent:"#8d6e63",accentHover:"#6d4c41",gold:"#bf9000",border:"#a1887f",success:"#2e7d32",danger:"#c62828"}},pe={gold:o(0),totalGold:o(0),totalRenownEarned:o(0),startTime:o(Date.now()),lastSaveTime:o(Date.now()),buildings:{},achievements:[],renown:o(0),prestigeCount:0,darkMatterGold:o(0),infiniteTowerLevel:0,portalProgress:0,nationalProjects:{},clickUpgradeLevel:0,offlineUpgradeLevel:0,weather:{current:"clear",timeLeft:o(120)},event:null,theme:"default",numberFormat:"standard",idleModeEnabled:!1,interface:me,stats:{totalClicks:o(0),currentPrestigeClicks:o(0),dragonsKilled:o(0),tavernGamesPlayed:o(0),prestigeCount:0,infiniteTowerLevel:0,darkMatterGold:o(0),portalProgress:0,clickUpgradeLevel:0,offlineUpgradeLevel:0,totalBuildingsPurchased:o(0),totalGoldSpent:o(0)},playerProfile:null,isDeveloperWifeBlessingObtained:!1,globalIncomeMultiplier:1,isBetaTesterBlessingObtained:!1,betaTesterIncomeMultiplier:1},Pe=t=>{if(t==null||typeof t=="string"||typeof t=="number"||typeof t=="boolean")return t;if(Array.isArray(t))return t.map(Pe);if(typeof t=="object"&&t.toString&&typeof t.toString=="function"&&(t.hasOwnProperty("mantissa")||t.hasOwnProperty("exponent")))return t.toString();if(typeof t=="object"){const r={};for(const d in t)t.hasOwnProperty(d)&&(r[d]=Pe(t[d]));return r}return t},Io=()=>{var nt,st;const[t,r]=j.useState(()=>{var s,l,f,w,S,N,W,q,D,te,_,ie,ce,xe,re,se,ve,We,lt,it,at,dt,ct,ut,pt,gt;const n=localStorage.getItem("kingdom_save");if(n)try{const v=JSON.parse(n);if((s=v.playerProfile)!=null&&s.id){const L=localStorage.getItem(`playerProfile_${v.playerProfile.id}`);L&&(v.playerProfile=JSON.parse(L))}const je=v.interface||{},ft=m(u(u({},me),je),{lastBuyAmount:o((l=je.lastBuyAmount)!=null?l:1),layout:{left:o((w=(f=je.layout)==null?void 0:f.left)!=null?w:me.layout.left),center:o((N=(S=je.layout)==null?void 0:S.center)!=null?N:me.layout.center),right:o((q=(W=je.layout)==null?void 0:W.right)!=null?q:me.layout.right)},borderWidth:o((D=je.borderWidth)!=null?D:me.borderWidth),customColors:u(u({},me.customColors),je.customColors||{})});return m(u(u({},pe),v),{renown:o(v.renown||0),totalRenownEarned:o(v.totalRenownEarned||0),prestigeCount:v.prestigeCount||0,gold:o(v.gold||0),totalGold:o(v.totalGold||0),startTime:o(v.startTime||Date.now()),lastSaveTime:o(v.lastSaveTime||Date.now()),darkMatterGold:o(v.darkMatterGold||0),infiniteTowerLevel:v.infiniteTowerLevel||0,portalProgress:v.portalProgress||0,buildings:Object.keys(v.buildings||{}).reduce((L,Q)=>(L[Q]=o(v.buildings[Q]),L),{}),stats:m(u(u({},pe.stats),v.stats||{}),{totalClicks:o(((te=v.stats)==null?void 0:te.totalClicks)||0),currentPrestigeClicks:o(((_=v.stats)==null?void 0:_.currentPrestigeClicks)||0),dragonsKilled:o(((ie=v.stats)==null?void 0:ie.dragonsKilled)||0),tavernGamesPlayed:o(((ce=v.stats)==null?void 0:ce.tavernGamesPlayed)||0),prestigeCount:((xe=v.stats)==null?void 0:xe.prestigeCount)||0,infiniteTowerLevel:((re=v.stats)==null?void 0:re.infiniteTowerLevel)||0,darkMatterGold:o(((se=v.stats)==null?void 0:se.darkMatterGold)||0),portalProgress:((ve=v.stats)==null?void 0:ve.portalProgress)||0,clickUpgradeLevel:((We=v.stats)==null?void 0:We.clickUpgradeLevel)||0,offlineUpgradeLevel:((lt=v.stats)==null?void 0:lt.offlineUpgradeLevel)||0,totalBuildingsPurchased:o(((it=v.stats)==null?void 0:it.totalBuildingsPurchased)||0),totalGoldSpent:o(((at=v.stats)==null?void 0:at.totalGoldSpent)||0)}),nationalProjects:v.nationalProjects||{},clickUpgradeLevel:v.clickUpgradeLevel||0,offlineUpgradeLevel:v.offlineUpgradeLevel||0,interface:ft,playerProfile:v.playerProfile?m(u({},v.playerProfile),{lastLeaderboardSubmit:v.playerProfile.lastLeaderboardSubmit||0}):null,globalIncomeMultiplier:v.globalIncomeMultiplier||1,isDeveloperWifeBlessingObtained:v.isDeveloperWifeBlessingObtained||!1,betaTesterIncomeMultiplier:v.betaTesterIncomeMultiplier||1,isBetaTesterBlessingObtained:v.isBetaTesterBlessingObtained||!1})}catch(v){console.error("Save load failed",v)}return pe}),d=j.useRef(t);j.useEffect(()=>{d.current=t},[t]);const x=j.useRef("");j.useEffect(()=>{const n=s=>{x.current=(x.current+s.key).slice(-20);const l=x.current.toLowerCase();l.endsWith("godon")?(r(f=>m(u({},f),{godMode:!0})),z("God Mode Enabled: +99999s per click","success"),x.current=""):l.endsWith("godoff")&&(r(f=>m(u({},f),{godMode:!1})),z("God Mode Disabled","info"),x.current="")};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[]);const i=()=>{A(null);const n=localStorage.getItem("kingdom_last_save_time"),s=Date.now();if(n){const l=s-parseInt(n),f=o(l/1e3);if(f.gte(o(60))){const w=t.offlineUpgradeLevel||0,{efficiency:S,duration:N}=Fe(w),W=o(N),q=f.lt(W)?f:W,te=ae(t).times(o(S)).times(q).floor();te.gt(o(0))&&(A({gained:te,effectiveTime:q,totalTime:f,efficiency:S,completedProjects:[],currentLevel:w,maxDuration:N}),r(_=>m(u({},_),{gold:_.gold.plus(te),totalGold:_.totalGold.plus(te)})))}}localStorage.setItem("kingdom_last_save_time",s.toString())},[a,b]=j.useState(!1);j.useEffect(()=>{let n;const s=()=>{b(!1),clearTimeout(n),t.idleModeEnabled&&(n=setTimeout(()=>{b(!0)},2e4))};s();const l=["mousemove","mousedown","keydown","touchstart","scroll"];return l.forEach(f=>window.addEventListener(f,s)),()=>{clearTimeout(n),l.forEach(f=>window.removeEventListener(f,s))}},[t.idleModeEnabled]),j.useEffect(()=>{t.event&&b(!1)},[t.event]),j.useEffect(()=>{const n=M(t.gold);document.title=`Gold: ${n} - Kingdom Clicker`},[t.gold]),j.useEffect(()=>{const n=document.documentElement,s=t.interface||me,l=t.theme||"default",f=Ve[l]||Ve.default;f&&Object.entries(f.colors).forEach(([N,W])=>{n.style.setProperty(N,W)});const w={compact:"8px",normal:"12px",spacious:"20px"},S={compact:"6px",normal:"12px",spacious:"16px"};n.style.setProperty("--panel-padding",w[s.density]),n.style.setProperty("--gap-size",S[s.density]),n.style.setProperty("--col-left",String(s.layout.left)),n.style.setProperty("--col-center",String(s.layout.center)),n.style.setProperty("--col-right",String(s.layout.right)),s.reduceMotion?document.body.classList.add("no-motion"):document.body.classList.remove("no-motion")},[t.theme,t.interface]);const[c,k]=j.useState(!1);j.useEffect(()=>{var n;t.gold.gte(o(1e7))&&!((n=t.playerProfile)!=null&&n.hasChosenName)&&!c&&ye(!0)},[t.gold,t.playerProfile,c]);const[g,y]=j.useState(null),[p,R]=j.useState([]),[C,A]=j.useState(null),[F,h]=j.useState("buildings"),[E,$]=j.useState("army"),[K,Y]=j.useState(!1),[B,P]=j.useState("throne");j.useEffect(()=>{const n=()=>{Y(window.innerWidth<768)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]);const[U,V]=j.useState(!1),[G,H]=j.useState(!1),[X,J]=j.useState(!1),[oe,I]=j.useState(!1),[T,O]=j.useState(!1),[Z,ne]=j.useState(!1),[ke,ye]=j.useState(!1),[ge,Be]=j.useState(!1),[Oe,Re]=j.useState(!1),[Me,ee]=j.useState(!1),z=(n,s="info")=>{const l=Date.now().toString()+Math.random();R(f=>[...f,{id:l,message:n,type:s}]),setTimeout(()=>{R(f=>f.filter(w=>w.id!==l))},3e3)};j.useEffect(()=>{const n=Date.now();if(t.lastSaveTime&&o(n).minus(t.lastSaveTime).gt(o(6e4))){const s=o(n).minus(t.lastSaveTime).dividedBy(o(1e3)),{efficiency:l,duration:f}=Fe(t.offlineUpgradeLevel||0),w=o(f),S=s.lt(w)?s:w,W=ae(t).times(o(l)).times(S).floor(),q=[];let D=u({},t.nationalProjects),te=!1;Object.keys(D).forEach(_=>{var ce;const ie=D[_];if(ie.active&&ie.endTime&&n>=ie.endTime){D[_]=m(u({},ie),{active:!1,level:ie.level+1,startTime:0,endTime:0});const xe=(ce=ue.find(re=>re.id===_))==null?void 0:ce.name;xe&&q.push(`${xe} Infrastructure (Lvl ${ie.level+1})`),te=!0}}),(W.gt(o(0))||q.length>0)&&(A(_=>_||{gained:W,effectiveTime:S,totalTime:s,efficiency:l,completedProjects:q,currentLevel:t.offlineUpgradeLevel||0,maxDuration:f}),r(_=>m(u({},_),{gold:_.gold.plus(W),totalGold:_.totalGold.plus(W),nationalProjects:te?D:_.nationalProjects})))}},[]),j.useEffect(()=>{const n=setInterval(()=>{Date.now()%3e4<1e3&&r(s=>{const l=m(u({},s),{lastSaveTime:o(Date.now())}),f=Pe(l);return localStorage.setItem("kingdom_save",JSON.stringify(f)),l})},1e3);return()=>clearInterval(n)},[]),j.useEffect(()=>{const n=()=>{const l=d.current,f=Pe(l);localStorage.setItem("kingdom_save",JSON.stringify(f)),localStorage.setItem("kingdom_last_save_time",Date.now().toString())};window.addEventListener("beforeunload",n);const s=()=>{document.visibilityState==="hidden"?n():document.visibilityState==="visible"&&i()};return document.addEventListener("visibilitychange",s),()=>{window.removeEventListener("beforeunload",n),document.removeEventListener("visibilitychange",s)}},[]),j.useEffect(()=>{var l;if(!((l=t.playerProfile)!=null&&l.hasChosenName))return;(()=>{var N;const f=Date.now(),w=((N=t.playerProfile)==null?void 0:N.lastLeaderboardSubmit)||0,S=3600*1e3;if(f-w>=S){const W={rulerName:t.playerProfile.rulerName,rulerId:t.playerProfile.rulerId,gold:t.totalGold,renown:t.totalRenownEarned,achievements:t.achievements.length,totalClicks:t.stats.totalClicks};Promise.all([Ae(m(u({},W),{period:"alltime"})),Ae(m(u({},W),{period:"weekly"})),kt(t,t.playerProfile.rulerId,t.playerProfile.rulerName)]).then(()=>{r(q=>m(u({},q),{playerProfile:m(u({},q.playerProfile),{lastLeaderboardSubmit:Date.now()})})),z("Leaderboard data synced on load!","success")}).catch(q=>{console.error("Initial leaderboard submission failed:",q)})}})();const s=setInterval(()=>{var W;const f=d.current,w=Date.now(),S=((W=f.playerProfile)==null?void 0:W.lastLeaderboardSubmit)||0,N=3600*1e3;if(w-S>=N){kt(f,f.playerProfile.rulerId,f.playerProfile.rulerName).catch(D=>{console.error("Failed to save player stats:",D)});const q={rulerName:f.playerProfile.rulerName,rulerId:f.playerProfile.rulerId,gold:f.totalGold,renown:f.totalRenownEarned,achievements:f.achievements.length,totalClicks:f.stats.totalClicks};Promise.all([Ae(m(u({},q),{period:"alltime"})),Ae(m(u({},q),{period:"weekly"}))]).then(()=>{r(D=>m(u({},D),{playerProfile:m(u({},D.playerProfile),{lastLeaderboardSubmit:Date.now()})})),z("Leaderboard data submitted successfully!","success")}).catch(D=>{console.error("Auto leaderboard submission failed:",D)})}},6e4);return()=>clearInterval(s)},[(nt=t.playerProfile)==null?void 0:nt.hasChosenName]),j.useEffect(()=>{const n=setInterval(()=>{if(!t.event&&Math.random()<.05){const f=["dragon","merchant","jester"],w=f[Math.floor(Math.random()*f.length)],S=w==="dragon"?6e5:3e4,N={id:Date.now().toString(),type:w,expiresAt:o(Date.now()).plus(o(S)),hp:w==="dragon"?o(10):void 0,maxHp:w==="dragon"?o(10):void 0,reward:o(0),startTime:w==="dragon"?Date.now():void 0};r(W=>m(u({},W),{event:N}))}},1e4);return()=>clearInterval(n)},[t.event]);const ae=n=>{var q;let s=o(0);const l=((q=n.weather)==null?void 0:q.current)||"clear";ue.forEach(D=>{const te=n.buildings[D.id]||o(0);let _=D.baseProduction;s=s.plus(te.times(_))});const f=we(n.totalRenownEarned);f.gt(o(1))&&(s=s.times(f));let w=0;n.nationalProjects&&Object.values(n.nationalProjects).forEach(D=>{w+=D.level||0});const S=o(1).plus(o(w*Je));s=s.times(S);const N=Ct(n.infiniteTowerLevel||0);s=s.times(N),o(1),ue.forEach(D=>{const te=n.buildings[D.id]||o(0);if(te.gt(0)){let _=o(1);l==="sunny"?(D.id==="peasant"||D.id==="field"||D.id==="stable"||D.id==="cathedral")&&(_=o(1.2)):l==="rainy"?(D.id==="silver_mine"||D.id==="alchemist"||D.id==="market"||D.id==="tavern")&&(_=o(1.2)):l==="stormy"?((D.id==="blacksmith"||D.id==="void_portal")&&(_=o(1.3)),(D.id==="field"||D.id==="stable")&&(_=o(.8))):l==="windy"&&(D.id==="market"||D.id==="castle"||D.id==="time_chamber")&&(_=o(1.15));const ie=te.times(D.baseProduction);if(f.gt(o(1))){const ce=ie.times(f).times(S).times(_.minus(o(1)));s=s.plus(ce)}else{const ce=ie.times(S).times(_.minus(o(1)));s=s.plus(ce)}}});const W=o(1).plus(o(n.achievements.length*.02));if(s=s.times(W),n.globalIncomeMultiplier&&(s=s.times(o(n.globalIncomeMultiplier))),n.betaTesterIncomeMultiplier&&(s=s.times(o(n.betaTesterIncomeMultiplier))),n.event&&n.event.type==="dragon"&&n.event.startTime){const D=Math.floor((Date.now()-n.event.startTime)/1e3),_=1-Math.min(99,D)/100;s=s.times(o(_))}return s},fe=ae(t),Ne=j.useRef(fe);Ne.current=fe,j.useEffect(()=>{const n=setInterval(()=>{r(s=>{const l=Date.now(),f=Ne.current.times(o(He)).dividedBy(o(1e3));let w=s.totalGold.plus(f),S=s.gold.plus(f),N=u({},s.weather);const W=o(He/1e3);if(N.timeLeft=o(N.timeLeft||0).minus(W),N.timeLeft.lte(o(0))){const re=["clear","sunny","rainy","stormy","windy"],se=re[Math.floor(Math.random()*re.length)],ve=o(Math.floor(Math.random()*120)+60);N={current:se,timeLeft:ve}}let q=s.event;q&&q.expiresAt&&o(q.expiresAt).lt(o(l))&&(q=null);let D=u({},s.nationalProjects||{});Object.keys(D).forEach(re=>{var ve;const se=D[re];se.active&&se.endTime&&l>=se.endTime&&(D[re]=m(u({},se),{active:!1,level:se.level+1,startTime:0,endTime:0}),z(`Project Completed: ${(ve=ue.find(We=>We.id===re))==null?void 0:ve.name} Infrastructure Level ${se.level+1}!`,"success"))});const te=[...s.achievements];let _=null;Pt.forEach(re=>{te.includes(re.id)||re.condition(m(u({},s),{totalGold:w,gold:S}),Ne.current)&&(te.push(re.id),_=re)}),_&&(y(_),setTimeout(()=>y(null),3e3));const ie=St(w),ce=(s.infiniteTowerLevel||0)>0?Array.from({length:s.infiniteTowerLevel},(re,se)=>ze(se)).reduce((re,se)=>re.plus(se),o(0)):o(0),xe=ie.minus(ce);return m(u({},s),{gold:S,totalGold:w,darkMatterGold:xe,achievements:te,event:q,weather:N,nationalProjects:D,stats:m(u({},s.stats),{darkMatterGold:xe})})})},He);return()=>clearInterval(n)},[]);const Ee=(n="light")=>{if("vibrate"in navigator&&K)switch(n){case"light":navigator.vibrate(10);break;case"medium":navigator.vibrate(20);break;case"heavy":navigator.vibrate([30,10,30]);break}},Ze=(n=!1)=>{if(n||Ee("light"),!n&&!t.isDeveloperWifeBlessingObtained&&t.totalGold.gte(o(1e12))&&Math.random()<1e-6){r(f=>m(u({},f),{globalIncomeMultiplier:(f.globalIncomeMultiplier||1)+1.073,isDeveloperWifeBlessingObtained:!0,achievements:[...new Set([...f.achievements,"developer_wife_blessing"])]})),z("üíç Developer Wife Blessing received! +107.3% global income!","success");return}const s=Gt(d.current);r(l=>m(u({},l),{gold:l.gold.plus(s),totalGold:l.totalGold.plus(s),stats:m(u({},l.stats),{totalClicks:l.stats.totalClicks.plus(o(1)),currentPrestigeClicks:l.stats.currentPrestigeClicks.plus(o(1)),prestigeCount:l.stats.prestigeCount,infiniteTowerLevel:l.stats.infiniteTowerLevel,darkMatterGold:l.stats.darkMatterGold,portalProgress:l.stats.portalProgress,clickUpgradeLevel:l.stats.clickUpgradeLevel,offlineUpgradeLevel:l.stats.offlineUpgradeLevel,totalBuildingsPurchased:l.stats.totalBuildingsPurchased,totalGoldSpent:l.stats.totalGoldSpent,dragonsKilled:l.stats.dragonsKilled,tavernGamesPlayed:l.stats.tavernGamesPlayed})}))},Gt=n=>{const s=o(1),l=n.clickUpgradeLevel||0,f=Math.min(l,15),w=o(2).pow(f),S=s.times(w),N=we(n.totalRenownEarned);let W=S;N.gt(o(1))&&(W=S.times(N)),n.infiniteTowerLevel&&n.infiniteTowerLevel>0&&(W=W.times(o(1).plus(o(n.infiniteTowerLevel*.01))));const q=Ge(l);if(q>0){const _=ae(n).times(q);W=W.plus(_)}const D=o(1).plus(o(n.achievements.length*.02));if(W=W.times(D),n.globalIncomeMultiplier&&(W=W.times(o(n.globalIncomeMultiplier))),n.betaTesterIncomeMultiplier&&(W=W.times(o(n.betaTesterIncomeMultiplier))),n.godMode){const _=ae(n).times(o(99999));W=W.plus(_)}return W},Ue=()=>{const n=t.clickUpgradeLevel||0;if(n>=Xe){z("Maximum Royal Scepter level reached!","warning");return}const s=Tt(n+1);if(t.gold.lt(s)){z("Not enough gold!","error");return}r(l=>m(u({},l),{gold:l.gold.minus(s),clickUpgradeLevel:l.clickUpgradeLevel+1,stats:m(u({},l.stats),{clickUpgradeLevel:l.clickUpgradeLevel+1,totalGoldSpent:l.stats.totalGoldSpent.plus(s)})})),z(`Royal Scepter upgraded to level ${n+1}!`,"success")},_e=()=>{const n=t.offlineUpgradeLevel||0;if(n>=Ie){z("Maximum Passive Income level reached!","warning");return}const s=Lt(n+1);if(t.renown.lt(s)){z("Not enough Renown!","error");return}r(l=>m(u({},l),{renown:l.renown.minus(s),offlineUpgradeLevel:l.offlineUpgradeLevel+1,stats:m(u({},l.stats),{offlineUpgradeLevel:l.offlineUpgradeLevel+1})})),z(`Passive Income upgraded to level ${n+1}!`,"success")},Qe=(n,s)=>{const l=ue.find(S=>S.id===n);if(!l||s<=0)return;const f=t.buildings[n]||o(0),w=bt(l.baseCost,f,o(s)).floor();t.gold.gte(w)&&(Ee("medium"),r(S=>m(u({},S),{gold:S.gold.minus(w),buildings:m(u({},S.buildings),{[n]:(S.buildings[n]||o(0)).plus(o(s))}),stats:m(u({},S.stats),{totalBuildingsPurchased:S.stats.totalBuildingsPurchased.plus(o(s)),totalGoldSpent:S.stats.totalGoldSpent.plus(w)})})),t.isBetaTesterBlessingObtained||Math.random()<1e-4&&(r(N=>m(u({},N),{betaTesterIncomeMultiplier:(N.betaTesterIncomeMultiplier||1)+1.3,isBetaTesterBlessingObtained:!0,achievements:[...new Set([...N.achievements,"beta_tester_blessing"])]})),z("üß™ Beta-Tester Legendary blessing received! +130% global income!","success")))},et=(n,s)=>{const l=ue.find(N=>N.id===n);if(!l||s<=0)return;const f=t.buildings[n]||o(0),w=o(Math.min(s,f.toNumber()));if(w.lte(o(0)))return;const S=bt(l.baseCost,f.minus(w),w).times(o(.25)).floor();r(N=>m(u({},N),{gold:N.gold.plus(S),buildings:m(u({},N.buildings),{[n]:f.minus(w)})}))},tt=n=>{if(n.type==="merchant"){const s=Ne.current.times(o(10));r(l=>m(u({},l),{gold:l.gold.plus(s),totalGold:l.totalGold.plus(s),event:null})),z(`The merchant gifted you ${M(s.floor(),t.numberFormat)} gold!`,"success")}else if(n.type==="jester"){const s=t.gold.times(o(.1)),l=Math.random()>.5;r(f=>m(u({},f),{gold:l?f.gold.plus(s):f.gold.minus(s),totalGold:l?f.totalGold.plus(s):f.totalGold,event:null})),l?z(`Jester pays out! +${M(s.floor(),t.numberFormat)}`,"success"):z(`Jester tricked you! -${M(s.floor(),t.numberFormat)}`,"warning")}else if(n.type==="dragon")try{let s=!1;r(l=>{if(!l.event||l.event.type!=="dragon")return l;const w=o(l.event.hp||10).minus(o(1));if(w.lte(0)){const S=Ne.current.times(o(30));return s=!0,m(u({},l),{gold:l.gold.plus(S),totalGold:l.totalGold.plus(S),event:null,stats:m(u({},l.stats),{dragonsKilled:l.stats.dragonsKilled.plus(o(1))})})}return m(u({},l),{event:m(u({},l.event),{hp:w})})}),s&&z("Dragon Slain! +Treasury Boost","success")}catch(s){console.error("Error handling dragon interaction:",s),z("Error interacting with dragon","error")}},Wt=()=>{const n=o(1),s=o(1e12),l=t.totalGold;if(l.lt(s))return;const f=l.dividedBy(s),S=o(Math.floor(Math.pow(f.toNumber(),.33))).times(n).minus(t.renown);if(S.lte(0))return;const N=u({},t.nationalProjects);Object.keys(N).forEach(W=>{N[W].active&&(N[W]=m(u({},N[W]),{active:!1,startTime:0,endTime:0}))}),r(m(u({},pe),{renown:t.renown.plus(S),totalRenownEarned:t.totalRenownEarned.plus(S),prestigeCount:t.prestigeCount+1,totalGold:t.totalGold,achievements:t.achievements,nationalProjects:N,offlineUpgradeLevel:t.offlineUpgradeLevel,darkMatterGold:t.darkMatterGold,infiniteTowerLevel:t.infiniteTowerLevel,playerProfile:t.playerProfile,startTime:o(Date.now()),lastSaveTime:o(Date.now()),theme:t.theme,idleModeEnabled:t.idleModeEnabled,interface:t.interface,stats:m(u({},pe.stats),{totalClicks:t.stats.totalClicks,prestigeCount:t.prestigeCount+1,currentPrestigeClicks:o(0),infiniteTowerLevel:t.infiniteTowerLevel,darkMatterGold:t.darkMatterGold,clickUpgradeLevel:t.clickUpgradeLevel,offlineUpgradeLevel:t.offlineUpgradeLevel})})),H(!1),z("Abdication Successful. Long live the new King!","success")},Dt=()=>{localStorage.removeItem("kingdom_save"),r(m(u({},pe),{startTime:o(Date.now())})),J(!1),z("Game Reset","warning")},At=()=>{const n=t.interface,s=t.theme,l=t.numberFormat,f=t.idleModeEnabled;r(m(u({},pe),{startTime:o(Date.now()),interface:n,theme:s,numberFormat:l,idleModeEnabled:f})),J(!1),z("Progress Reset - Settings Preserved","warning")},zt=()=>{const s=Pe(t);localStorage.setItem("kingdom_save",JSON.stringify(s)),z("Game Saved","info")},Ft=()=>{r(n=>{const s=u({},n.nationalProjects);return Object.keys(s).forEach(l=>{s[l].active&&(s[l]=m(u({},s[l]),{endTime:Date.now()+5e3}))}),m(u({},n),{nationalProjects:s})}),z("Projects sped up to 5 seconds!","success")};window.speedUpProjects=Ft;const Ot=n=>{r(s=>m(u({},s),{playerProfile:n})),localStorage.setItem(`playerProfile_${n.id}`,JSON.stringify(n)),z(`Welcome, ${n.rulerName} ${n.rulerId}!`,"success"),k(!1)},Ut=()=>de(null,null,function*(){Wt()}),_t=n=>de(null,null,function*(){var s;if(!((s=t.playerProfile)!=null&&s.id)){z("Error: Player profile not found","error");return}try{yield To(t.playerProfile.id,n);const l=m(u({},t.playerProfile),{rulerName:n});r(S=>m(u({},S),{playerProfile:l}));const f=m(u({},t),{playerProfile:l}),w=Pe(f);localStorage.setItem("kingdom_save",JSON.stringify(w)),z(`Name successfully changed to "${n}"!`,"success")}catch(l){console.error("Error changing name:",l),z("Failed to change name. Please try again.","error")}}),Ht=n=>de(null,null,function*(){var f;const s=((f=t.playerProfile)==null?void 0:f.id)||"default_player",l=yield lo.redeemPromoCode(s,n);if(!l){z("Invalid or expired promo code!","error");return}switch(l.type){case"gold":r(w=>m(u({},w),{gold:w.gold.plus(o(l.value)),totalGold:w.totalGold.plus(o(l.value))})),z(`Received ${M(o(l.value))} gold!`,"success");break;case"betaTester":r(w=>{const S=w.playerProfile?m(u({},w.playerProfile),{usedPromoCodes:[...w.playerProfile.usedPromoCodes||[],"beta_tester"],specialIcon:l.icon||"üß™",specialTitle:l.title||"Beta Tester",isBetaTester:!0}):null;return S&&localStorage.setItem(`playerProfile_${s}`,JSON.stringify(S)),m(u({},w),{playerProfile:S})}),z("Beta Tester rewards unlocked! üß™","success");break;case"icon":r(w=>{const S=w.playerProfile?m(u({},w.playerProfile),{usedPromoCodes:[...w.playerProfile.usedPromoCodes||[],n],specialIcon:l.icon||"‚≠ê",specialTitle:l.title||"Special"}):null;return S&&localStorage.setItem(`playerProfile_${s}`,JSON.stringify(S)),m(u({},w),{playerProfile:S})}),z(`Special icon unlocked: ${l.icon}!`,"success");break;case"title":r(w=>{const S=w.playerProfile?m(u({},w.playerProfile),{usedPromoCodes:[...w.playerProfile.usedPromoCodes||[],n],specialTitle:l.title||"Special"}):null;return S&&localStorage.setItem(`playerProfile_${s}`,JSON.stringify(S)),m(u({},w),{playerProfile:S})}),z(`Special title unlocked: ${l.title}!`,"success");break;default:z("Promo code redeemed!","success")}}),ot=n=>{r(s=>m(u({},s),{interface:m(u({},s.interface),{lastBuyAmount:n})}))},rt=n=>({flex:n==="left"?"var(--col-left)":"var(--col-right)",display:"flex",flexDirection:"column",borderRight:n==="left"?"var(--custom-border-width) double var(--border-color)":"none",borderLeft:n==="right"?"var(--custom-border-width) double var(--border-color)":"none",background:"var(--panel-bg)",minWidth:0,transition:"transform 0.8s ease-in-out",transform:a&&t.idleModeEnabled?n==="left"?"translateX(-120%)":"translateX(120%)":"translateX(0)",zIndex:10});return e.jsxs("div",{style:{display:"flex",height:"100dvh",width:"100vw",backgroundColor:"var(--bg-color)",overflow:"hidden",position:"relative",flexDirection:K?"column":"row"},children:[e.jsx(oo,{}),a&&t.idleModeEnabled&&e.jsx(vo,{gameState:t}),!K&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:rt("left"),children:[e.jsx("div",{style:{display:"flex",borderBottom:"var(--custom-border-width) solid var(--border-color)"},children:e.jsx("button",{className:`tab-btn ${F==="buildings"?"active":""}`,onClick:()=>h("buildings"),children:"Estates"})}),e.jsx("div",{style:{flex:1,overflowY:"auto",overflowX:"hidden"},children:F==="buildings"&&e.jsx(yt,{gameState:t,onBuyBuilding:Qe,onSellBuilding:et,onSetBuyAmount:ot,setGameState:r,onStartProject:n=>{var S;const s=((S=t.nationalProjects[n])==null?void 0:S.level)||0;if(s>=$e)return;const l=Ye(n,s+1),f=t.buildings[n]||o(0);if(f.lt(10))return;const w=Ke[s+1]||0;f.lt(w)||t.gold.lt(l.gold)||(r(N=>m(u({},N),{gold:N.gold.minus(l.gold),nationalProjects:m(u({},N.nationalProjects),{[n]:{level:s+1,active:!1,startTime:0,endTime:0}})})),z("Project upgraded!","success"))}})})]}),e.jsx("div",{style:{flex:"var(--col-center)",display:"flex",flexDirection:"column",position:"relative",borderRight:a&&t.idleModeEnabled?"none":"var(--custom-border-width) double var(--border-color)",minWidth:0,zIndex:5,transition:"border 0.8s",background:"radial-gradient(circle at center, var(--panel-bg) 0%, rgba(0,0,0,0.02) 100%), repeating-linear-gradient(45deg, rgba(0,0,0,0.04) 0px, rgba(0,0,0,0.04) 2px, transparent 2px, transparent 12px)",boxShadow:"inset 0 0 50px rgba(0,0,0,0.1)"},children:e.jsx(vt,{gameState:t,gps:fe,onClick:()=>Ze(!1),onEventInteract:tt,onOpenTavern:()=>V(!0),onOpenPrestige:()=>H(!0),onOpenSettings:()=>J(!0),onOpenStatistics:()=>O(!0),onOpenLeaderboard:()=>{Be(!0)},onOpenEmpire:()=>ne(!0),onUpgradeClickPower:Ue,onUpgradeOffline:_e,isIdle:a&&t.idleModeEnabled})}),e.jsxs("div",{style:rt("right"),children:[e.jsx("div",{style:{display:"flex",borderBottom:"var(--custom-border-width) solid var(--border-color)"},children:e.jsx("button",{className:`tab-btn ${E==="army"?"active":""}`,onClick:()=>$("army"),children:"Future"})}),e.jsx("div",{style:{flex:1,overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch",touchAction:"pan-y",scrollbarWidth:"thin",scrollbarColor:"var(--accent-color) transparent"},children:E==="army"&&e.jsx(jt,{gameState:t,onBuyTowerFloor:()=>{const n=ze(t.infiniteTowerLevel||0);t.darkMatterGold.gte(n)&&(r(s=>m(u({},s),{darkMatterGold:s.darkMatterGold.minus(n),infiniteTowerLevel:(s.infiniteTowerLevel||0)+1,stats:m(u({},s.stats),{infiniteTowerLevel:(s.infiniteTowerLevel||0)+1,darkMatterGold:s.darkMatterGold.minus(n)})})),z("Built another floor of the Infinite Tower! +100% income bonus","success"))}})})]})]}),K&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",position:"relative",minHeight:0,height:"100%"},children:[B==="buildings"&&e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:0},children:[e.jsx("div",{style:{display:"flex",borderBottom:"var(--custom-border-width) solid var(--border-color)",flexShrink:0},children:e.jsx("button",{className:"tab-btn active",onClick:()=>{},children:"Estates"})}),e.jsx("div",{className:"scrollable-content",style:{flex:1,overflowY:"auto",overflowX:"hidden",minHeight:0,WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:e.jsx(yt,{gameState:t,onBuyBuilding:Qe,onSellBuilding:et,onSetBuyAmount:ot,setGameState:r,onStartProject:n=>{var S;const s=((S=t.nationalProjects[n])==null?void 0:S.level)||0;if(s>=$e)return;const l=Ye(n,s+1),f=t.buildings[n]||o(0);if(f.lt(10))return;const w=Ke[s+1]||0;f.lt(w)||t.gold.lt(l.gold)||(r(N=>m(u({},N),{gold:N.gold.minus(l.gold),nationalProjects:m(u({},N.nationalProjects),{[n]:{level:s+1,active:!1,startTime:0,endTime:0}})})),z("Project upgraded!","success"))}})})]}),B==="throne"&&e.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:e.jsx(vt,{gameState:t,gps:fe,onClick:()=>Ze(!1),onEventInteract:tt,onOpenTavern:()=>V(!0),onOpenPrestige:()=>H(!0),onOpenSettings:()=>J(!0),onOpenStatistics:()=>O(!0),onOpenLeaderboard:()=>Be(!0),onOpenEmpire:()=>ne(!0),onUpgradeClickPower:Ue,onUpgradeOffline:_e,isIdle:a&&t.idleModeEnabled})}),B==="army"&&e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:0},children:[e.jsx("div",{style:{display:"flex",borderBottom:"var(--custom-border-width) solid var(--border-color)",flexShrink:0},children:e.jsx("button",{className:"tab-btn active",children:"Future"})}),e.jsx("div",{className:"scrollable-content",style:{flex:1,overflowY:"auto",overflowX:"hidden",minHeight:0,WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:e.jsx(jt,{gameState:t,onBuyTowerFloor:()=>{const n=ze(t.infiniteTowerLevel||0);t.darkMatterGold.gte(n)&&(r(s=>m(u({},s),{darkMatterGold:s.darkMatterGold.minus(n),infiniteTowerLevel:(s.infiniteTowerLevel||0)+1,stats:m(u({},s.stats),{infiniteTowerLevel:(s.infiniteTowerLevel||0)+1,darkMatterGold:s.darkMatterGold.minus(n)})})),z("Built another floor of the Infinite Tower! +100% income bonus","success"))}})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-around",alignItems:"center",height:"60px",backgroundColor:"var(--panel-bg)",borderTop:"var(--custom-border-width) solid var(--border-color)",flexShrink:0},children:[e.jsxs("button",{className:`mobile-nav-btn ${B==="buildings"?"active":""}`,onClick:()=>{Ee("light"),P("buildings")},style:{flex:1,height:"100%",border:"none",backgroundColor:"transparent",fontSize:"12px",color:B==="buildings"?"var(--accent-color)":"var(--text-color)",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"4px",cursor:"pointer"},children:[e.jsx("div",{style:{fontSize:"20px"},children:"üèòÔ∏è"}),e.jsx("div",{children:"Estates"})]}),e.jsxs("button",{className:`mobile-nav-btn ${B==="throne"?"active":""}`,onClick:()=>{Ee("light"),P("throne")},style:{flex:1,height:"100%",border:"none",backgroundColor:"transparent",fontSize:"12px",color:B==="throne"?"var(--accent-color)":"var(--text-color)",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"4px",cursor:"pointer"},children:[e.jsx("div",{style:{fontSize:"20px"},children:"üëë"}),e.jsx("div",{children:"Throne"})]}),e.jsxs("button",{className:`mobile-nav-btn ${B==="army"?"active":""}`,onClick:()=>{Ee("light"),P("army")},style:{flex:1,height:"100%",border:"none",backgroundColor:"transparent",fontSize:"12px",color:B==="army"?"var(--accent-color)":"var(--text-color)",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"4px",cursor:"pointer"},children:[e.jsx("div",{style:{fontSize:"20px"},children:"üë∑"}),e.jsx("div",{children:"Future"})]})]})]}),!(a&&t.idleModeEnabled)&&g&&e.jsxs("div",{className:"achievement-popup",children:[e.jsx("div",{style:{fontSize:"2rem"},children:g.icon}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"bold",color:"var(--text-color)"},children:"Achievement Unlocked!"}),e.jsx("div",{style:{color:"var(--accent-color)"},children:g.name})]})]}),C&&e.jsx(Mo,{gained:C.gained,effectiveTime:C.effectiveTime,totalTime:C.totalTime,efficiency:C.efficiency,completedProjects:C.completedProjects,currentLevel:C.currentLevel,maxDuration:C.maxDuration,numberFormat:t.numberFormat,onClose:()=>A(null)}),Z&&e.jsx(yo,{gameState:t,onClose:()=>ne(!1),onStartProject:n=>{var N;const s=((N=t.nationalProjects[n])==null?void 0:N.level)||0;if(s>=$e)return;const l=Ye(n,s+1),f=t.buildings[n]||o(0);if(f.lt(10))return;const w=Ke[s+1]||0;if(f.lt(w)||t.gold.lt(l.gold))return;const S=to();r(W=>m(u({},W),{gold:W.gold.minus(l.gold),nationalProjects:m(u({},W.nationalProjects),{[n]:{level:s,active:!0,startTime:Date.now(),endTime:Date.now()+S*1e3}})})),z("Construction started!","info")},onUpgradeClickPower:Ue,onUpgradeOffline:_e}),U&&e.jsx(fo,{gameState:t,onGamble:(n,s)=>{const l=o(n);r(f=>m(u({},f),{gold:s?f.gold.plus(l):f.gold.minus(l).max(0),stats:m(u({},f.stats),{tavernGamesPlayed:f.stats.tavernGamesPlayed.plus(o(1))})}))},onClose:()=>V(!1)}),G&&e.jsx(xo,{gameState:t,onPrestige:Ut,onClose:()=>H(!1)}),X&&e.jsx(mo,{gameState:t,onClose:()=>J(!1),onHardReset:Dt,onProgressReset:At,onSave:zt,onSetTheme:n=>r(s=>m(u({},s),{theme:n})),onSetNumberFormat:n=>r(s=>m(u({},s),{numberFormat:n})),onToggleIdleMode:()=>r(n=>m(u({},n),{idleModeEnabled:!n.idleModeEnabled})),onUpdateInterface:n=>r(s=>m(u({},s),{interface:u(u({},s.interface),n)}))}),Oe&&e.jsx(No,{gameState:t,onClose:()=>Re(!1),onRedeemPromoCode:Ht,onBackToSettings:()=>{Re(!1),J(!0)}}),T&&e.jsx(bo,{gameState:t,currentGps:fe,currentTotalClicks:t.stats.totalClicks,currentPrestigeClicks:t.stats.currentPrestigeClicks,onClose:()=>O(!1)}),oe&&e.jsx(ho,{onClose:()=>I(!1)}),ke&&e.jsx(Lo,{isOpen:ke,onClose:()=>{ye(!1),k(!0)},onConfirm:Ot,gameState:t}),ge&&e.jsx(Ro,{isOpen:ge,onClose:()=>Be(!1),playerProfile:t.playerProfile,gameState:t,addToast:z}),Me&&e.jsx(Eo,{isOpen:Me,onClose:()=>ee(!1),onConfirm:_t,currentName:((st=t.playerProfile)==null?void 0:st.rulerName)||""})]})},It=document.getElementById("root");if(!It)throw new Error("Could not find root element to mount to");const Go=Zt.createRoot(It);Go.render(e.jsx(Se.StrictMode,{children:e.jsx(Io,{})}))});export default Wo();
