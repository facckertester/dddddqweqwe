var he=Object.defineProperty,me=Object.defineProperties;var ge=Object.getOwnPropertyDescriptors;var K=Object.getOwnPropertySymbols;var ye=Object.prototype.hasOwnProperty,be=Object.prototype.propertyIsEnumerable;var V=(e,o,r)=>o in e?he(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r,m=(e,o)=>{for(var r in o||(o={}))ye.call(o,r)&&V(e,r,o[r]);if(K)for(var r of K(o))be.call(o,r)&&V(e,r,o[r]);return e},X=(e,o)=>me(e,ge(o));import{R as q,j as n,r as Y}from"./vendor-react-CUeQczFW.js";import{t as i,f as k,W as ve,P as A,B,g as je}from"./core-C2y7dMvE.js";import{g as Q}from"./components-ui-DS-nQxSB.js";const we=q.memo(({renown:e,totalRenownEarned:o,numberFormat:r})=>{const y=Q(o).minus(i(1)).times(i(100)).floor().toString();return n.jsxs("div",{style:{padding:"5px 15px",background:"rgba(103, 58, 183, 0.1)",border:"1px solid rgba(103, 58, 183, 0.3)",borderRadius:"20px",display:"inline-block"},children:[n.jsxs("div",{style:{color:"#673ab7",fontWeight:"bold",fontSize:"1rem"},children:["ðŸ‘‘ Current: ",k(e,r)," Renown"]}),n.jsxs("div",{style:{color:"#673ab7",fontWeight:"bold",fontSize:"1rem"},children:["ðŸ‘‘ Total: ",k(o,r)," (+",y,"% Bonus)"]})]})}),Re=q.memo(({gameState:e,gps:o,onClick:r,onEventInteract:y,onOpenTavern:Z,onOpenPrestige:S,onOpenSettings:ee,onOpenStatistics:ie,onOpenLeaderboard:te,onOpenEmpire:ne,isIdle:s})=>{var T,L,_;const[oe,G]=Y.useState([]),N=Y.useRef(null),C=e.interface||{showFloatingText:!0,showWeatherWidget:!0,crownAnimations:!0},se=()=>{let c=0;return e.nationalProjects&&Object.values(e.nationalProjects).forEach(P=>{c+=P.level*A}),i(c)},re=c=>{var P,D,F;if(C.showFloatingText){const M=(P=N.current)==null?void 0:P.getBoundingClientRect();if(M){const de=c.clientX-M.left+(Math.random()*40-20),ae=c.clientY-M.top+(Math.random()*40-20),pe=i(1),I=e.clickUpgradeLevel||0,xe=Math.min(I,15),ue=i(2).pow(xe),O=pe.times(ue),u=Q(e.totalRenownEarned);let f=O;u.gt(i(1))&&(f=O.times(u));const U=je(I);if(U>0){let d=i(0);B.forEach(t=>{const x=e.buildings[t.id]||i(0);x.gt(0)&&(d=d.plus(x.times(t.baseProduction)))});let a=d;u.gt(i(1))&&(a=d.times(u));let v=0;e.nationalProjects&&Object.values(e.nationalProjects).forEach(t=>v+=t.level||0);const g=i(1).plus(i(v*A));a=a.times(g);const h=((D=e.weather)==null?void 0:D.current)||"clear";let p=i(0);B.forEach(t=>{const x=e.buildings[t.id]||i(0);if(x.gt(0)){let l=i(1);h==="sunny"?(t.id==="peasant"||t.id==="field"||t.id==="stable"||t.id==="cathedral")&&(l=i(1.2)):h==="rainy"?(t.id==="silver_mine"||t.id==="alchemist"||t.id==="market"||t.id==="tavern")&&(l=i(1.2)):h==="stormy"?((t.id==="blacksmith"||t.id==="void_portal")&&(l=i(1.3)),(t.id==="field"||t.id==="stable")&&(l=i(.8))):h==="windy"&&(t.id==="market"||t.id==="castle"||t.id==="time_chamber")&&(l=i(1.15));const w=x.times(t.baseProduction);u.gt(i(1))?p=p.plus(w.times(u).times(g).times(l.minus(i(1)))):p=p.plus(w.times(g).times(l.minus(i(1))))}});const J=a.plus(p),R=i(1).plus(i(e.achievements.length*.02)),j=J.times(R);let W=j;e.globalIncomeMultiplier&&(W=j.times(i(e.globalIncomeMultiplier))),f=f.plus(W.times(U))}const $=i(1).plus(i(e.achievements.length*.02));if(f=f.times($),e.globalIncomeMultiplier&&(f=f.times(i(e.globalIncomeMultiplier))),e.godMode){let d=i(0);B.forEach(t=>{const x=e.buildings[t.id]||i(0);x.gt(0)&&(d=d.plus(x.times(t.baseProduction)))});let a=d;u.gt(i(1))&&(a=d.times(u));let v=0;e.nationalProjects&&Object.values(e.nationalProjects).forEach(t=>v+=t.level||0);const g=i(1).plus(i(v*A));a=a.times(g);const h=((F=e.weather)==null?void 0:F.current)||"clear";let p=i(0);B.forEach(t=>{const x=e.buildings[t.id]||i(0);if(x.gt(0)){let l=i(1);h==="sunny"?(t.id==="peasant"||t.id==="field"||t.id==="stable"||t.id==="cathedral")&&(l=i(1.2)):h==="rainy"?(t.id==="silver_mine"||t.id==="alchemist"||t.id==="market"||t.id==="tavern")&&(l=i(1.2)):h==="stormy"?((t.id==="blacksmith"||t.id==="void_portal")&&(l=i(1.3)),(t.id==="field"||t.id==="stable")&&(l=i(.8))):h==="windy"&&(t.id==="market"||t.id==="castle"||t.id==="time_chamber")&&(l=i(1.15));const w=x.times(t.baseProduction);u.gt(i(1))?p=p.plus(w.times(u).times(g).times(l.minus(i(1)))):p=p.plus(w.times(g).times(l.minus(i(1))))}});const R=a.plus(p).times($);let j=R;e.globalIncomeMultiplier&&(j=R.times(i(e.globalIncomeMultiplier)));const W=j.times(i(99999));f=f.plus(W)}const fe="+"+k(f,e.numberFormat),H={id:Date.now(),x:de,y:ae,val:fe};G(d=>[...d,H]),setTimeout(()=>{G(d=>d.filter(a=>a.id!==H.id))},1e3)}}r(c)},b=ve[((T=e.weather)==null?void 0:T.current)||"clear"],z={transition:"transform 0.8s ease-in-out, width 0.8s ease-in-out, height 0.8s ease-in-out, margin 0.8s ease-in-out, position 0.8s ease-in-out"},le=m(s?{position:"fixed",bottom:"120px",right:"30px",transform:"scale(0.8)",transformOrigin:"bottom right",textAlign:"right",zIndex:100}:{transform:"scale(1)",marginBottom:"3rem",zIndex:10,textAlign:"center"},z),ce=m(s?{width:"80px",height:"80px",fontSize:"2rem",position:"fixed",bottom:"30px",right:"30px",borderRadius:"50%",zIndex:100}:{width:"260px",height:"260px",fontSize:"6rem",borderRadius:"50%",position:"relative",zIndex:5,margin:"0 auto"},z),E={opacity:s?0:1,transition:"opacity 0.5s ease-in-out",pointerEvents:s?"none":"auto"};return n.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",padding:"var(--panel-padding)",height:"100%",overflow:"hidden"},children:[C.showWeatherWidget&&n.jsxs("div",{style:m({position:"absolute",top:"10px",left:"10px",zIndex:20,background:b.color,padding:"8px 12px",borderRadius:"20px",border:"2px solid rgba(0,0,0,0.1)",boxShadow:"2px 2px 5px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",gap:"8px",cursor:"help"},E),"data-tooltip":`${b.name}: ${b.description}`,children:[n.jsx("span",{style:{fontSize:"1.5rem"},children:b.icon}),n.jsxs("div",{style:{textAlign:"left",lineHeight:"1.1"},children:[n.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem",color:"#222"},children:b.name}),n.jsxs("div",{style:{fontSize:"0.7rem",color:"#444"},children:[i(Number(((L=e.weather)==null?void 0:L.timeLeft)||0)).ceil().toString(),"s remaining"]})]})]}),n.jsxs("div",{style:m({position:"absolute",top:"10px",right:"10px",zIndex:20,display:"flex",gap:"5px"},E),children:[n.jsx("button",{onClick:te,style:{background:"transparent",border:"none",fontSize:"1.5rem",cursor:"pointer",opacity:.8,color:"var(--text-color)",transition:"all 0.2s ease"},title:"Leaderboard (Available for all players)",children:"ðŸ†"}),n.jsx("button",{onClick:ie,style:{background:"transparent",border:"none",fontSize:"1.5rem",cursor:"pointer",opacity:.7,color:"var(--text-color)"},title:"Statistics",children:"ðŸ“Š"}),n.jsx("button",{onClick:ee,style:{background:"transparent",border:"none",fontSize:"1.5rem",cursor:"pointer",opacity:.7,color:"var(--text-color)"},title:"Kingdom Settings",children:"âš™ï¸"})]}),n.jsxs("div",{style:le,children:[n.jsx("div",{style:{fontSize:"1rem",color:s?"var(--text-color)":"var(--text-secondary)",marginBottom:"5px",textTransform:"uppercase",letterSpacing:"2px",textShadow:s?"1px 1px 2px #000":"none"},children:"Royal Treasury"}),n.jsx("div",{style:{fontSize:"3rem",fontFamily:"var(--font-main)",color:"var(--text-color)",textShadow:s?"2px 2px 4px #000":"2px 2px 0px rgba(255, 215, 0, 0.4)"},children:k(e.gold,e.numberFormat)}),n.jsxs("div",{style:{marginTop:"5px",fontSize:"1.1rem",color:s?"#90ee90":"var(--success-color)",fontStyle:"italic",textShadow:s?"1px 1px 2px #000":"none"},children:["+",k(o,e.numberFormat)," gold / sec"]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"10px",marginTop:"15px"},children:[n.jsx(we,{renown:e.renown,totalRenownEarned:e.totalRenownEarned,numberFormat:e.numberFormat}),n.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",justifyContent:"center"},children:[n.jsx("div",{style:{padding:"5px 15px",background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"20px",display:"inline-block"},children:n.jsxs("span",{style:{color:"#4caf50",fontWeight:"bold"},children:["ðŸ—ï¸ Projects: +",se().times(i(100)).floor().toString(),"%"]})}),n.jsx("div",{style:{padding:"5px 15px",background:"rgba(255, 152, 0, 0.15)",border:"1px solid rgba(255, 152, 0, 0.5)",borderRadius:"20px",display:"inline-block"},children:n.jsxs("span",{style:{color:"#ff6f00",fontWeight:"bold"},children:["ðŸ† Achievements: +",e.achievements.length*2,"%"]})})]})]})]}),n.jsxs("div",{style:{position:"relative",marginBottom:s?0:"3rem",display:"flex",justifyContent:"center",alignItems:"center"},children:[n.jsx("div",{className:"magnetic-container",children:n.jsx("button",{ref:N,className:`main-button ${s?"idle":""} ${C.crownAnimations?"":"no-animations"}`,style:X(m({},ce),{display:"flex",alignItems:"center",justifyContent:"center",outline:"none",color:"#5d4037",cursor:"pointer",overflow:"hidden"}),onClick:re,children:n.jsx("span",{className:C.crownAnimations?"crown-icon":"",style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",lineHeight:1,marginTop:"-10px"},children:"ðŸ‘‘"})})}),!s&&oe.map(c=>n.jsx("div",{className:"floating-text",style:{left:c.x,top:c.y},children:c.val},c.id))]}),n.jsxs("div",{style:m({display:"flex",gap:"10px",zIndex:10,flexWrap:"wrap",justifyContent:"center"},E),children:[e.buildings.field&&e.buildings.field.gt(i(0))&&n.jsx("button",{className:"btn",style:{background:"var(--accent-color)",borderColor:"var(--gold-color)"},onClick:ne,children:"ðŸ—ï¸ Projects"}),((_=e.buildings.tavern)==null?void 0:_.gt(i(0)))&&n.jsx("button",{className:"btn",onClick:Z,children:"ðŸº Tavern"}),(e.totalGold.gt(i(5e5))||e.renown.gt(i(0)))&&n.jsx("button",{className:"btn",style:{background:"var(--accent-color)"},onClick:S,children:"ðŸ‘‘ Legacy"})]}),!s&&e.event&&e.event.type==="dragon"&&n.jsx("div",{className:"dragon-event",onMouseDown:()=>{try{y(e.event)}catch(c){console.error("Error clicking dragon:",c)}},children:"ðŸ‰"}),!s&&e.event&&e.event.type==="merchant"&&n.jsxs("div",{style:{position:"absolute",right:"20px",top:"100px",background:"#fff3e0",padding:"10px",border:"2px solid orange",zIndex:100,cursor:"pointer",animation:"pop 0.5s",borderRadius:"8px",boxShadow:"2px 2px 5px rgba(0,0,0,0.2)"},onClick:()=>y(e.event),children:[n.jsx("div",{style:{fontSize:"1.5rem",textAlign:"center"},children:"ðŸ‘³"}),n.jsx("div",{style:{fontWeight:"bold",color:"#000"},children:"Merchant"}),n.jsx("small",{style:{color:"#444"},children:"Click for gift"})]}),!s&&e.event&&e.event.type==="jester"&&n.jsxs("div",{style:{position:"absolute",left:"20px",top:"100px",background:"#fce4ec",padding:"10px",border:"2px solid pink",zIndex:100,cursor:"pointer",animation:"pop 0.5s",borderRadius:"8px",boxShadow:"2px 2px 5px rgba(0,0,0,0.2)"},onClick:()=>y(e.event),children:[n.jsx("div",{style:{fontSize:"1.5rem",textAlign:"center"},children:"ðŸ¤¡"}),n.jsx("div",{style:{fontWeight:"bold",color:"#000"},children:"Jester"}),n.jsx("small",{style:{color:"#444"},children:"Risk it all?"})]})]})});export{Re as M};
