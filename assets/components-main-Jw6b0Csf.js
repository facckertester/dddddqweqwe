var me=Object.defineProperty,ge=Object.defineProperties;var ve=Object.getOwnPropertyDescriptors;var X=Object.getOwnPropertySymbols;var be=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable;var Y=(e,r,l)=>r in e?me(e,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[r]=l,m=(e,r)=>{for(var l in r||(r={}))be.call(r,l)&&Y(e,l,r[l]);if(X)for(var l of X(r))ye.call(r,l)&&Y(e,l,r[l]);return e},q=(e,r)=>ge(e,ve(r));import{R as Z,j as t,r as Q}from"./vendor-react-CUeQczFW.js";import{t as i,f as g,W as je,h as we,g as N,P as E,B as M,a as ke}from"./core-BLe5j-6i.js";import{g as S}from"./components-ui-BeL8qPGz.js";const Be=Z.memo(({renown:e,totalRenownEarned:r,numberFormat:l})=>{const v=S(r).minus(i(1)).times(i(100)).floor().toNumber();return v<=0?null:t.jsx("div",{style:{padding:"5px 15px",background:"rgba(103, 58, 183, 0.1)",border:"1px solid rgba(103, 58, 183, 0.3)",borderRadius:"20px",display:"inline-block",cursor:"help"},"data-tooltip":`Total Renown: ${g(r,l)}
Bonus: +${v}% to all income
Renown is earned by prestiging and provides permanent bonuses`,children:t.jsxs("div",{style:{color:"#673ab7",fontWeight:"bold",fontSize:"clamp(0.7rem, 2vw, 1rem)"},children:["üëë Total Renown: ",g(r,l)," +",v,"%"]})})}),Ee=Z.memo(({gameState:e,gps:r,onClick:l,onEventInteract:v,onOpenTavern:ee,onOpenPrestige:ie,onOpenSettings:ne,onOpenStatistics:te,onOpenLeaderboard:oe,onOpenEmpire:re,isIdle:s})=>{var F,D,$;const[se,G]=Q.useState([]),L=Q.useRef(null),B=e.interface||{showFloatingText:!0,showWeatherWidget:!0,crownAnimations:!0},T=()=>{let o=0;return e.nationalProjects&&Object.values(e.nationalProjects).forEach(P=>{o+=P.level*E}),i(o)},le=o=>{var P,I,_;if(B.showFloatingText){const A=(P=L.current)==null?void 0:P.getBoundingClientRect();if(A){const ae=o.clientX-A.left+(Math.random()*40-20),pe=o.clientY-A.top+(Math.random()*40-20),ue=i(1),O=e.clickUpgradeLevel||0,xe=Math.min(O,15),fe=i(2).pow(xe),U=ue.times(fe),x=S(e.totalRenownEarned);let f=U;x.gt(i(1))&&(f=U.times(x));const H=ke(O);if(H>0){let d=i(0);M.forEach(n=>{const u=e.buildings[n.id]||i(0);u.gt(0)&&(d=d.plus(u.times(n.baseProduction)))});let a=d;x.gt(i(1))&&(a=d.times(x));let j=0;e.nationalProjects&&Object.values(e.nationalProjects).forEach(n=>j+=n.level||0);const b=i(1).plus(i(j*E));a=a.times(b);const h=((I=e.weather)==null?void 0:I.current)||"clear";let p=i(0);M.forEach(n=>{const u=e.buildings[n.id]||i(0);if(u.gt(0)){let c=i(1);h==="sunny"?(n.id==="peasant"||n.id==="field"||n.id==="stable"||n.id==="cathedral")&&(c=i(1.2)):h==="rainy"?(n.id==="silver_mine"||n.id==="alchemist"||n.id==="market"||n.id==="tavern")&&(c=i(1.2)):h==="stormy"?((n.id==="blacksmith"||n.id==="void_portal")&&(c=i(1.3)),(n.id==="field"||n.id==="stable")&&(c=i(.8))):h==="windy"&&(n.id==="market"||n.id==="castle"||n.id==="time_chamber")&&(c=i(1.15));const k=u.times(n.baseProduction);x.gt(i(1))?p=p.plus(k.times(x).times(b).times(c.minus(i(1)))):p=p.plus(k.times(b).times(c.minus(i(1))))}});const V=a.plus(p),R=i(1).plus(i(e.achievements.length*.02)),w=V.times(R);let z=w;e.globalIncomeMultiplier&&(z=w.times(i(e.globalIncomeMultiplier))),f=f.plus(z.times(H))}const J=i(1).plus(i(e.achievements.length*.02));if(f=f.times(J),e.globalIncomeMultiplier&&(f=f.times(i(e.globalIncomeMultiplier))),e.godMode){let d=i(0);M.forEach(n=>{const u=e.buildings[n.id]||i(0);u.gt(0)&&(d=d.plus(u.times(n.baseProduction)))});let a=d;x.gt(i(1))&&(a=d.times(x));let j=0;e.nationalProjects&&Object.values(e.nationalProjects).forEach(n=>j+=n.level||0);const b=i(1).plus(i(j*E));a=a.times(b);const h=((_=e.weather)==null?void 0:_.current)||"clear";let p=i(0);M.forEach(n=>{const u=e.buildings[n.id]||i(0);if(u.gt(0)){let c=i(1);h==="sunny"?(n.id==="peasant"||n.id==="field"||n.id==="stable"||n.id==="cathedral")&&(c=i(1.2)):h==="rainy"?(n.id==="silver_mine"||n.id==="alchemist"||n.id==="market"||n.id==="tavern")&&(c=i(1.2)):h==="stormy"?((n.id==="blacksmith"||n.id==="void_portal")&&(c=i(1.3)),(n.id==="field"||n.id==="stable")&&(c=i(.8))):h==="windy"&&(n.id==="market"||n.id==="castle"||n.id==="time_chamber")&&(c=i(1.15));const k=u.times(n.baseProduction);x.gt(i(1))?p=p.plus(k.times(x).times(b).times(c.minus(i(1)))):p=p.plus(k.times(b).times(c.minus(i(1))))}});const R=a.plus(p).times(J);let w=R;e.globalIncomeMultiplier&&(w=R.times(i(e.globalIncomeMultiplier)));const z=w.times(i(99999));f=f.plus(z)}const he="+"+g(f,e.numberFormat),K={id:Date.now(),x:ae,y:pe,val:he};G(d=>[...d,K]),setTimeout(()=>{G(d=>d.filter(a=>a.id!==K.id))},1e3)}}l(o)},y=je[((F=e.weather)==null?void 0:F.current)||"clear"],C={transition:"transform 0.8s ease-in-out, width 0.8s ease-in-out, height 0.8s ease-in-out, margin 0.8s ease-in-out, position 0.8s ease-in-out"},ce=m(s?{position:"fixed",bottom:"120px",right:"30px",transform:"scale(0.8)",transformOrigin:"bottom right",textAlign:"right",zIndex:100}:{transform:"scale(1)",marginBottom:"3rem",zIndex:10,textAlign:"center"},C),de=m(s?{width:"80px",height:"80px",fontSize:"2rem",position:"fixed",bottom:"30px",right:"30px",borderRadius:"50%",zIndex:100}:{width:"260px",height:"260px",fontSize:"6rem",borderRadius:"50%",position:"relative",zIndex:5,margin:"0 auto"},C),W={opacity:s?0:1,transition:"opacity 0.5s ease-in-out",pointerEvents:s?"none":"auto"};return t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",padding:"var(--panel-padding)",height:"100%",overflow:"hidden"},children:[B.showWeatherWidget&&t.jsxs("div",{style:m({position:"absolute",top:"10px",left:"10px",zIndex:20,background:y.color,padding:"8px 12px",borderRadius:"20px",border:"2px solid rgba(0,0,0,0.1)",boxShadow:"2px 2px 5px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",gap:"8px",cursor:"help"},W),"data-tooltip":`${y.name}: ${y.description}`,children:[t.jsx("span",{style:{fontSize:"1.5rem"},children:y.icon}),t.jsxs("div",{style:{textAlign:"left",lineHeight:"1.1"},children:[t.jsx("div",{style:{fontWeight:"bold",fontSize:"0.9rem",color:"#222"},children:y.name}),t.jsxs("div",{style:{fontSize:"0.7rem",color:"#444"},children:[i(Number(((D=e.weather)==null?void 0:D.timeLeft)||0)).ceil().toString(),"s remaining"]})]})]}),t.jsxs("div",{style:m({position:"absolute",top:"10px",right:"10px",zIndex:20,display:"flex",gap:"5px"},W),children:[t.jsx("button",{onClick:oe,style:{background:"transparent",border:"none",fontSize:"1.5rem",cursor:"pointer",opacity:.8,color:"var(--text-color)",transition:"all 0.2s ease"},title:"Leaderboard (Available for all players)",children:"üèÜ"}),t.jsx("button",{onClick:te,style:{background:"transparent",border:"none",fontSize:"1.5rem",cursor:"pointer",opacity:.7,color:"var(--text-color)"},title:"Statistics",children:"üìä"}),t.jsx("button",{onClick:ne,style:{background:"transparent",border:"none",fontSize:"1.5rem",cursor:"pointer",opacity:.7,color:"var(--text-color)"},title:"Kingdom Settings",children:"‚öôÔ∏è"})]}),t.jsxs("div",{style:ce,children:[t.jsx("div",{style:{fontSize:"1rem",color:s?"var(--text-color)":"var(--text-secondary)",marginBottom:"5px",textTransform:"uppercase",letterSpacing:"2px",textShadow:s?"1px 1px 2px #000":"none"},children:"Royal Treasury"}),t.jsx("div",{style:{fontSize:"3rem",fontFamily:"var(--font-main)",color:"var(--text-color)",textShadow:s?"2px 2px 4px #000":"2px 2px 0px rgba(255, 215, 0, 0.4)"},children:g(e.gold,e.numberFormat)}),t.jsxs("div",{style:{marginTop:"5px",fontSize:"1.1rem",color:s?"#90ee90":"var(--success-color)",fontStyle:"italic",textShadow:s?"1px 1px 2px #000":"none"},children:["+",g(r,e.numberFormat)," gold / sec"]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"10px",marginTop:"15px"},children:[t.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",justifyContent:"center"},children:[t.jsx(Be,{renown:e.renown,totalRenownEarned:e.totalRenownEarned,numberFormat:e.numberFormat}),we(e.totalGold)&&(N(e.infiniteTowerLevel||0).minus(i(1)).times(i(100)).floor().toNumber()<=0?null:t.jsx("div",{style:{padding:"5px 15px",background:"rgba(103, 58, 183, 0.1)",border:"1px solid rgba(103, 58, 183, 0.3)",borderRadius:"20px",display:"inline-block",cursor:"help"},"data-tooltip":`Infinite Tower Level: ${e.infiniteTowerLevel||0}
Bonus: +${g(N(e.infiniteTowerLevel||0).minus(i(1)).times(i(100)),e.numberFormat)}% to all income
Each tower floor provides +100% bonus
Build floors using Dark Matter Gold`,children:t.jsxs("span",{style:{color:"#673ab7",fontWeight:"bold"},children:["üèóÔ∏è Tower: +",g(N(e.infiniteTowerLevel||0).minus(i(1)).times(i(100)),e.numberFormat),"%"]})}))]}),t.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",justifyContent:"center"},children:[T().times(i(100)).floor().toNumber()<=0?null:t.jsx("div",{style:{padding:"5px 15px",background:"rgba(76, 175, 80, 0.1)",border:"1px solid rgba(76, 175, 80, 0.3)",borderRadius:"20px",display:"inline-block",cursor:"help"},"data-tooltip":`National Projects Bonus: +${g(T().times(i(100)),e.numberFormat)}%
Each project level provides +${E*100}% bonus
Build projects in the Empire menu
Projects enhance all building production`,children:t.jsxs("span",{style:{color:"#4caf50",fontWeight:"bold"},children:["üèóÔ∏è Projects: +",g(T().times(i(100)),e.numberFormat),"%"]})}),(()=>{const o=e.achievements.length*2;return o<=0?null:t.jsx("div",{style:{padding:"5px 15px",background:"rgba(255, 152, 0, 0.15)",border:"1px solid rgba(255, 152, 0, 0.5)",borderRadius:"20px",display:"inline-block",cursor:"help"},"data-tooltip":`Achievements Bonus: +${o}%
Achievements: ${e.achievements.length} unlocked
Each achievement provides +2% bonus
Complete various challenges to earn achievements
Achievements give permanent income bonuses`,children:t.jsxs("span",{style:{color:"#ff6f00",fontWeight:"bold"},children:["üèÜ Achievements: +",o,"%"]})})})()]})]})]}),t.jsxs("div",{style:{position:"relative",marginBottom:s?0:"3rem",display:"flex",justifyContent:"center",alignItems:"center"},children:[t.jsx("div",{className:"magnetic-container",children:t.jsx("button",{ref:L,className:`main-button ${s?"idle":""} ${B.crownAnimations?"":"no-animations"}`,style:q(m({},de),{display:"flex",alignItems:"center",justifyContent:"center",outline:"none",color:"#5d4037",cursor:"pointer",overflow:"hidden"}),onClick:le,children:t.jsx("span",{className:B.crownAnimations?"crown-icon":"",style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",lineHeight:1,marginTop:"-10px"},children:"üëë"})})}),!s&&se.map(o=>t.jsx("div",{className:"floating-text",style:{left:o.x,top:o.y},children:o.val},o.id))]}),t.jsxs("div",{style:m({display:"flex",gap:"10px",zIndex:10,flexWrap:"wrap",justifyContent:"center"},W),children:[e.buildings.field&&e.buildings.field.gt(i(0))&&t.jsx("button",{className:"btn",style:{background:"var(--accent-color)",borderColor:"var(--gold-color)"},onClick:re,children:"üèóÔ∏è Projects"}),(($=e.buildings.tavern)==null?void 0:$.gt(i(0)))&&t.jsx("button",{className:"btn",onClick:ee,children:"üç∫ Tavern"}),(e.totalGold.gt(i(5e5))||e.renown.gt(i(0)))&&t.jsx("button",{className:"btn",style:{background:"var(--accent-color)"},onClick:ie,children:"üëë Legacy"})]}),!s&&e.event&&e.event.type==="dragon"&&t.jsx("div",{className:"dragon-event",onMouseDown:()=>{try{v(e.event)}catch(o){console.error("Error clicking dragon:",o)}},children:"üêâ"}),!s&&e.event&&e.event.type==="merchant"&&t.jsxs("div",{style:{position:"absolute",right:"20px",top:"100px",background:"#fff3e0",padding:"10px",border:"2px solid orange",zIndex:100,cursor:"pointer",animation:"pop 0.5s",borderRadius:"8px",boxShadow:"2px 2px 5px rgba(0,0,0,0.2)"},onClick:()=>v(e.event),children:[t.jsx("div",{style:{fontSize:"1.5rem",textAlign:"center"},children:"üë≥"}),t.jsx("div",{style:{fontWeight:"bold",color:"#000"},children:"Merchant"}),t.jsx("small",{style:{color:"#444"},children:"Click for gift"})]}),!s&&e.event&&e.event.type==="jester"&&t.jsxs("div",{style:{position:"absolute",left:"20px",top:"100px",background:"#fce4ec",padding:"10px",border:"2px solid pink",zIndex:100,cursor:"pointer",animation:"pop 0.5s",borderRadius:"8px",boxShadow:"2px 2px 5px rgba(0,0,0,0.2)"},onClick:()=>v(e.event),children:[t.jsx("div",{style:{fontSize:"1.5rem",textAlign:"center"},children:"ü§°"}),t.jsx("div",{style:{fontWeight:"bold",color:"#000"},children:"Jester"}),t.jsx("small",{style:{color:"#444"},children:"Risk it all?"})]})]})});export{Ee as M};
