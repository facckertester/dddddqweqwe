var N=Object.defineProperty,T=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var I=(o,e,n)=>e in o?N(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n,k=(o,e)=>{for(var n in e||(e={}))F.call(e,n)&&I(o,n,e[n]);if(R)for(var n of R(e))G.call(e,n)&&I(o,n,e[n]);return o},E=(o,e)=>T(o,A(e));import{r as m,j as t}from"./vendor-react-CUeQczFW.js";import"./vendor-DdgGw12P.js";import{t as r,f as h,h as C,g as P,B as O,P as M}from"./core-BLe5j-6i.js";const J=({gameState:o,building:e,x:n,y:i,visible:s,onHide:c})=>{const l=m.useRef(null),[a,x]=m.useState({x:0,y:0});if(m.useEffect(()=>{if(!s||!l.current)return;const d=l.current.getBoundingClientRect();let f=n+15,u=i-d.height/2;const g=10;f+d.width>window.innerWidth-g&&(f=Math.max(g,n-d.width-15)),u<g&&(u=g),u+d.height>window.innerHeight-g&&(u=Math.max(g,window.innerHeight-d.height-g)),x({x:f,y:u})},[s,n,i]),!s||!e)return null;const p=o.buildings[e.id]||r(0);if(!(o.totalGold.gte(e.baseCost)||p.gt(r(0))))return t.jsxs("div",{ref:l,className:"advanced-tooltip",style:{position:"fixed",left:`${a.x}px`,top:`${a.y}px`,background:"var(--panel-bg)",color:"var(--text-color)",padding:"12px",borderRadius:"2px",border:"4px double var(--accent-color)",fontSize:"15px",lineHeight:"1.4",width:"240px",minWidth:"240px",zIndex:1e4,boxShadow:"var(--shadow)",pointerEvents:"none",transition:"all 0.15s ease"},onMouseLeave:c,children:[t.jsxs("div",{style:{fontWeight:"bold",fontSize:"16px",marginBottom:"8px",color:"var(--accent-color)",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid var(--accent-color)",paddingBottom:"6px"},children:[t.jsx("span",{style:{fontSize:"20px"},children:"â“"}),t.jsx("span",{children:"???"})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(33, 150, 243, 0.1), rgba(33, 150, 243, 0.05))",borderRadius:"6px",border:"1px solid rgba(33, 150, 243, 0.3)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"rgba(33, 150, 243, 0.9)",fontWeight:"bold",fontSize:"13px"},children:"Count"}),t.jsx("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:"???"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05))",borderRadius:"6px",border:"1px solid rgba(76, 175, 80, 0.3)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"var(--success-color)",fontWeight:"bold",fontSize:"13px"},children:"Production"}),t.jsx("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:"???/s"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(255, 152, 0, 0.05))",borderRadius:"6px",border:"1px solid rgba(255, 152, 0, 0.3)"},children:[t.jsx("span",{style:{color:"#ff9800",fontWeight:"bold",fontSize:"13px"},children:"Income Share"}),t.jsx("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:"???%"})]})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(141, 110, 99, 0.1), rgba(141, 110, 99, 0.05))",borderRadius:"6px",border:"1px solid var(--accent-color)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"var(--accent-color)",fontWeight:"bold",fontSize:"13px"},children:"Next Building"}),t.jsx("span",{style:{color:"var(--accent-color)",fontWeight:"bold",fontSize:"14px"},children:"??? gold"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(156, 39, 176, 0.1), rgba(156, 39, 176, 0.05))",borderRadius:"6px",border:"1px solid rgba(156, 39, 176, 0.3)"},children:[t.jsx("span",{style:{color:"#9c27b0",fontWeight:"bold",fontSize:"13px"},children:"Each Produces"}),t.jsx("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:"???/s"})]})]}),t.jsx("div",{style:{padding:"6px",background:"rgba(0, 0, 0, 0.05)",borderRadius:"6px",borderTop:"1px solid var(--border-color)",fontSize:"11px",color:"var(--text-secondary)",fontStyle:"italic",textAlign:"center"},children:"???"})]});const j=o.buildings[e.id]||r(0),y=S(o,e),B=y.times(j),z=U(o),L=z.gt(0)?B.div(z).times(100):r(0),v=_(e.baseCost,j);return(v.gt(0)?y.div(v):r(0)).gt(0)?v.div(y):r(0),t.jsxs("div",{ref:l,className:"advanced-tooltip",style:{position:"fixed",left:`${a.x}px`,top:`${a.y}px`,background:"var(--panel-bg)",color:"var(--text-color)",padding:"12px",borderRadius:"2px",border:"4px double var(--accent-color)",fontSize:"15px",lineHeight:"1.4",width:"240px",minWidth:"240px",zIndex:1e4,boxShadow:"var(--shadow)",pointerEvents:"none",transition:"all 0.15s ease"},onMouseLeave:c,children:[t.jsxs("div",{style:{fontWeight:"bold",fontSize:"16px",marginBottom:"8px",color:"var(--accent-color)",display:"flex",alignItems:"center",gap:"8px",borderBottom:"1px solid var(--accent-color)",paddingBottom:"6px"},children:[t.jsx("span",{style:{fontSize:"20px"},children:e.icon}),t.jsx("span",{children:e.name})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(33, 150, 243, 0.1), rgba(33, 150, 243, 0.05))",borderRadius:"6px",border:"1px solid rgba(33, 150, 243, 0.3)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"rgba(33, 150, 243, 0.9)",fontWeight:"bold",fontSize:"13px"},children:"Count"}),t.jsx("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:h(j,o.numberFormat)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05))",borderRadius:"6px",border:"1px solid rgba(76, 175, 80, 0.3)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"var(--success-color)",fontWeight:"bold",fontSize:"13px"},children:"Production"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:[h(B,o.numberFormat),"/s"]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(255, 152, 0, 0.05))",borderRadius:"6px",border:"1px solid rgba(255, 152, 0, 0.3)"},children:[t.jsx("span",{style:{color:"#ff9800",fontWeight:"bold",fontSize:"13px"},children:"Income Share"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:[h(L,o.numberFormat),"%"]})]})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(141, 110, 99, 0.1), rgba(141, 110, 99, 0.05))",borderRadius:"6px",border:"1px solid var(--accent-color)",marginBottom:"6px"},children:[t.jsx("span",{style:{color:"var(--accent-color)",fontWeight:"bold",fontSize:"13px"},children:"Next Building"}),t.jsxs("span",{style:{color:"var(--accent-color)",fontWeight:"bold",fontSize:"14px"},children:[h(v,o.numberFormat)," gold"]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",background:"linear-gradient(135deg, rgba(156, 39, 176, 0.1), rgba(156, 39, 176, 0.05))",borderRadius:"6px",border:"1px solid rgba(156, 39, 176, 0.3)"},children:[t.jsx("span",{style:{color:"#9c27b0",fontWeight:"bold",fontSize:"13px"},children:"Each Produces"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold",fontSize:"14px"},children:[h(y,o.numberFormat),"/s"]})]})]}),t.jsx("div",{style:{padding:"6px",background:"rgba(0, 0, 0, 0.05)",borderRadius:"6px",borderTop:"1px solid var(--border-color)",fontSize:"11px",color:"var(--text-secondary)",fontStyle:"italic",textAlign:"center"},children:e.description}),t.jsxs("div",{style:{padding:"6px",background:"rgba(0, 0, 0, 0.05)",borderRadius:"6px",borderTop:"1px solid var(--border-color)",marginTop:"8px"},children:[t.jsx("div",{style:{fontSize:"12px",fontWeight:"bold",marginBottom:"6px",color:"var(--text-secondary)",textAlign:"center"},children:"BONUS BREAKDOWN"}),o.achievements.length>0&&t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 8px",background:"linear-gradient(135deg, rgba(255, 193, 7, 0.1), rgba(255, 193, 7, 0.05))",borderRadius:"4px",border:"1px solid rgba(255, 193, 7, 0.3)",marginBottom:"3px",fontSize:"11px"},children:[t.jsx("span",{style:{color:"#ffc107",fontWeight:"bold"},children:"ðŸ† Achievements"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold"},children:["+",o.achievements.length*2,"%"]})]}),w(o.totalRenownEarned).gt(r(1))&&t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 8px",background:"linear-gradient(135deg, rgba(156, 39, 176, 0.1), rgba(156, 39, 176, 0.05))",borderRadius:"4px",border:"1px solid rgba(156, 39, 176, 0.3)",marginBottom:"3px",fontSize:"11px"},children:[t.jsx("span",{style:{color:"#9c27b0",fontWeight:"bold"},children:"ðŸ‘‘ Prestige"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold"},children:["+",w(o.totalRenownEarned).minus(r(1)).times(r(100)).floor().toString(),"%"]})]}),(()=>{let b=0;o.nationalProjects&&Object.values(o.nationalProjects).forEach(f=>{b+=f.level||0});const d=b*M*100;return d>0?t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 8px",background:"linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05))",borderRadius:"4px",border:"1px solid rgba(76, 175, 80, 0.3)",marginBottom:"3px",fontSize:"11px"},children:[t.jsx("span",{style:{color:"var(--success-color)",fontWeight:"bold"},children:"ðŸ—ï¸ Projects"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold"},children:["+",d.toFixed(0),"%"]})]}):null})(),C(o.totalGold)&&(()=>{const b=o.infiniteTowerLevel||0,d=P(b).minus(r(1)).times(r(100)).toNumber();return d>0?t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 8px",background:"linear-gradient(135deg, rgba(103, 58, 183, 0.1), rgba(103, 58, 183, 0.05))",borderRadius:"4px",border:"1px solid rgba(103, 58, 183, 0.3)",marginBottom:"3px",fontSize:"11px"},children:[t.jsx("span",{style:{color:"#673ab7",fontWeight:"bold"},children:"ðŸ—ï¸ Tower"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold"},children:["+",d.toFixed(0),"%"]})]}):null})(),o.globalIncomeMultiplier&&o.globalIncomeMultiplier>1&&t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 8px",background:"linear-gradient(135deg, rgba(233, 30, 99, 0.1), rgba(233, 30, 99, 0.05))",borderRadius:"4px",border:"1px solid rgba(233, 30, 99, 0.3)",marginBottom:"3px",fontSize:"11px"},children:[t.jsx("span",{style:{color:"#e91e63",fontWeight:"bold"},children:"ðŸ’ Blessing"}),t.jsxs("span",{style:{color:"var(--text-color)",fontWeight:"bold"},children:["+",((o.globalIncomeMultiplier-1)*100).toFixed(1),"%"]})]})]})]})};function S(o,e){var x;let n=e.baseProduction;const i=((x=o.weather)==null?void 0:x.current)||"clear";i==="sunny"&&(e.id==="peasant"||e.id==="field"||e.id==="stable"||e.id==="cathedral")?n=n.times(r(1.2)):i==="rainy"&&(e.id==="silver_mine"||e.id==="alchemist"||e.id==="market"||e.id==="tavern")?n=n.times(r(1.2)):i==="stormy"?((e.id==="blacksmith"||e.id==="void_portal")&&(n=n.times(r(1.3))),(e.id==="field"||e.id==="stable")&&(n=n.times(r(.8)))):i==="windy"&&(e.id==="market"||e.id==="castle"||e.id==="time_chamber")&&(n=n.times(r(1.15)));const s=w(o.totalRenownEarned);s.gt(r(1))&&(n=n.times(s));let c=0;o.nationalProjects&&Object.values(o.nationalProjects).forEach(p=>{c+=p.level||0});const l=1+c*M;n=n.times(r(l));const a=1+o.achievements.length*.02;if(n=n.times(r(a)),o.globalIncomeMultiplier&&(n=n.times(r(o.globalIncomeMultiplier))),C(o.totalGold)){const p=o.infiniteTowerLevel||0,W=P(p);n=n.times(W)}return n}function w(o){const e=o.toNumber();if(e<=0)return r(1);let n=r(1);return e<=100?n=r(1+e*.02):e<=1e3?n=r(3).plus(r(e-100).times(r(.01))):e<=1e4?n=r(4).plus(r(e-1e3).times(r(.005))):e<=1e5?n=r(4.5).plus(r(e-1e4).times(r(.001))):n=r(5.5).plus(r(5).times(Math.log10(e))),n}function U(o){let e=r(0);return O.forEach(n=>{const i=o.buildings[n.id]||r(0);if(i.gt(0)){const s=S(o,n);e=e.plus(s.times(i))}}),e}function _(o,e){return o.times(r(1.15).pow(e)).floor()}const K=({toasts:o})=>t.jsx("div",{className:"toast-container",children:o.map(e=>t.jsxs("div",{className:`toast ${e.type}`,children:[e.type==="success"&&"âœ…",e.type==="warning"&&"âš ï¸",e.type==="info"&&"â„¹ï¸",e.type==="error"&&"âŒ",t.jsx("span",{children:e.message})]},e.id))}),V=()=>{const[o,e]=m.useState(null);if(m.useEffect(()=>{const i=l=>{const x=l.target.closest("[data-tooltip]");if(x){const p=x.getAttribute("data-tooltip");p&&e({text:p,x:l.clientX,y:l.clientY})}else e(null)},s=l=>{o&&e(a=>a?E(k({},a),{x:l.clientX,y:l.clientY}):null)},c=()=>{e(null)};return document.addEventListener("mouseover",i),document.addEventListener("mousemove",s),document.addEventListener("mouseout",c),()=>{document.removeEventListener("mouseover",i),document.removeEventListener("mousemove",s),document.removeEventListener("mouseout",c)}},[o]),!o)return null;const n={left:o.x+15,top:o.y+15};return o.x+250>window.innerWidth&&(n.left=o.x-260),o.y+100>window.innerHeight&&(n.top=o.y-50),t.jsx("div",{className:"game-tooltip",style:n,children:o.text.split(`
`).map((i,s)=>t.jsx("div",{style:{marginBottom:s===o.text.split(`
`).length-1?0:"4px"},children:i},s))})};export{J as A,V as G,K as T,w as g};
