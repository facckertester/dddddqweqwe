var ne=Object.defineProperty,le=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var Z=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var $=(r,i,s)=>i in r?ne(r,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[i]=s,N=(r,i)=>{for(var s in i||(i={}))se.call(i,s)&&$(r,s,i[s]);if(Z)for(var s of Z(i))de.call(i,s)&&$(r,s,i[s]);return r},G=(r,i)=>le(r,ie(i));import{j as e,r as E}from"./vendor-react-CUeQczFW.js";import{t as n,N as _,h as W,i as T,j as S,f as h,P as O,B as ce,k as q,l as Q,m as ae}from"./core-b497BxOD.js";import{A as xe}from"./components-ui-GPLDHM49.js";const ue=({building:r,gameState:i,onClose:s})=>{const b=i.buildings[r.id]||n(0),w=_.find(A=>A.id===r.id);if(!w)return null;const y=(i.nationalProjects[r.id]||{level:0}).level,C=y>=S,v=y+1,u=W(r.id,v),L=T[v]||0,k=b.gte(L),m=i.gold.gte(u.gold),M=m&&k;return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:e.jsxs("div",{style:{background:"var(--panel-bg)",border:"2px solid var(--accent-color)",borderRadius:"8px",padding:"20px",maxWidth:"400px",width:"100%",maxHeight:"80vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{fontSize:"2rem"},children:"ðŸ—ï¸"}),e.jsxs("h3",{style:{margin:0,color:"var(--text-color)"},children:[w.name.replace(" Infrastructure","")," - Lvl ",y,"/",S]})]}),e.jsx("button",{onClick:s,style:{background:"none",border:"none",color:"var(--text-secondary)",fontSize:"1.5rem",cursor:"pointer",padding:"5px"},children:"Ã—"})]}),e.jsx("div",{style:{marginBottom:"15px",color:"var(--text-secondary)",fontSize:"0.9rem",lineHeight:"1.4"},children:w.description}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"15px"},children:[e.jsxs("div",{style:{background:"rgba(0,0,0,0.1)",padding:"10px",borderRadius:"4px"},children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Buildings"}),e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"var(--accent-color)"},children:h(b,i.numberFormat)})]}),e.jsxs("div",{style:{background:"rgba(0,0,0,0.1)",padding:"10px",borderRadius:"4px"},children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Current Bonus"}),e.jsxs("div",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"var(--success-color)"},children:["+",(y*O*100).toFixed(0),"%"]})]})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("h4",{style:{margin:"0 0 10px 0",color:"var(--text-color)"},children:C?"Max Level Reached":`Requirements for Level ${v}`}),e.jsx("div",{style:{background:"rgba(0,0,0,0.1)",padding:"10px",borderRadius:"4px"},children:C?e.jsx("div",{style:{textAlign:"center",color:"var(--gold-color)",fontWeight:"bold"},children:"ðŸ† Maximum level achieved!"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"5px"},children:[e.jsx("span",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:"ðŸ° Buildings:"}),e.jsxs("span",{style:{fontSize:"0.9rem",fontWeight:"bold",color:k?"var(--success-color)":"var(--error-color)"},children:[L," (have ",h(b,i.numberFormat),")"]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:"ðŸ’° Gold:"}),e.jsx("span",{style:{fontSize:"0.9rem",fontWeight:"bold",color:m?"var(--success-color)":"var(--error-color)"},children:h(u.gold,i.numberFormat)})]})]})})]}),e.jsxs("div",{style:{background:"rgba(0,0,0,0.1)",padding:"10px",borderRadius:"4px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)"},children:"Status"}),e.jsx("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:C?"var(--gold-color)":M?"var(--success-color)":"var(--text-secondary)"},children:C?"âœ… MAX LEVEL":M?"ðŸš€ Ready to upgrade!":"â³ Requirements not met"})]})]})})},ee=(r,i=!1,s=!1,b=!1)=>({display:"flex",alignItems:"center",padding:"var(--panel-padding)",background:s?"rgba(0,0,0,0.05)":i?"rgba(46, 125, 50, 0.1)":b?"#f3e5f5":"var(--panel-bg)",border:"1px solid",borderColor:s?"rgba(0,0,0,0.2)":b?"#7b1fa2":r?"var(--accent-color)":"rgba(0,0,0,0.1)",borderRadius:"2px",cursor:r&&!s?"pointer":"default",opacity:r&&!s||i?1:.7,transition:"all 0.2s",boxShadow:r&&!s?"2px 2px 0 rgba(0,0,0,0.1)":"none",position:"relative",userSelect:"none",marginBottom:"var(--gap-size)",filter:s?"grayscale(1)":"none"}),pe={display:"flex",flexDirection:"column",gap:"var(--gap-size)",height:"100%",overflowY:"auto",padding:"var(--panel-padding)",position:"relative"},ye=({gameState:r,onBuyBuilding:i,onSellBuilding:s,onSetBuyAmount:b,onStartProject:w,setGameState:D})=>{var X;const[y,C]=E.useState({visible:!1,x:0,y:0,building:null}),v=n(1),u=((X=r.interface)==null?void 0:X.lastBuyAmount)||n(1),[L,k]=E.useState(!1),[m,M]=E.useState({visible:!1,x:0,y:0,buildingId:null}),[A,te]=E.useState({visible:!1,building:null}),[H,F]=E.useState(1);E.useEffect(()=>{const t=c=>{c.ctrlKey?F(10):c.shiftKey?F(100):F(1)},d=c=>t(c),o=c=>t(c);return window.addEventListener("keydown",d),window.addEventListener("keyup",o),()=>{window.removeEventListener("keydown",d),window.removeEventListener("keyup",o)}},[]);const U=(t,d)=>{const o=t.currentTarget.getBoundingClientRect();C({visible:!0,x:o.right,y:o.top+o.height/2,building:d})},I=()=>{C({visible:!1,x:0,y:0,building:null}),M({visible:!1,x:0,y:0,buildingId:null})},J=(t,d)=>{const o=t.currentTarget.getBoundingClientRect();M({visible:!0,x:o.right+10,y:o.top+o.height/2,buildingId:d})},K=()=>{M({visible:!1,x:0,y:0,buildingId:null})},V=t=>{var x;if(!w)return;const d=((x=r.nationalProjects[t])==null?void 0:x.level)||0;if(d>=S)return;const o=W(t,d+1),c=r.buildings[t]||n(0);if(c.lt(10))return;const l=T[d+1]||0;c.lt(l)||r.gold.lt(o.gold)||D(p=>G(N({},p),{gold:p.gold.minus(o.gold),nationalProjects:G(N({},p.nationalProjects),{[t]:{level:d+1,active:!1,startTime:0,endTime:0}})}))},oe=(t,d)=>{var g;let o=d;const c=((g=r.weather)==null?void 0:g.current)||"clear";c==="sunny"&&(t==="peasant"||t==="field")?o=o.times(n(1.2)):c==="rainy"&&(t==="silver_mine"||t==="alchemist")?o=o.times(n(1.2)):c==="stormy"?(t==="blacksmith"&&(o=o.times(n(1.3))),t==="field"&&(o=o.times(n(.8)))):c==="windy"&&t==="market"&&(o=o.times(n(1.15)));let l=n(1),x=0;r.nationalProjects&&Object.values(r.nationalProjects).forEach(f=>x+=f.level||0);const p=1+x*O;l=l.times(n(p));const j=n(1).plus(r.renown.times(.01));return l=l.times(j),o.times(l)},z=(t,d)=>{if(!_.find(P=>P.id===t)||d.lt(10))return"var(--border-color)";const l=(r.nationalProjects[t]||{level:0}).level;if(l>=S)return"var(--gold-color)";const p=l+1,j=W(t,p),g=T[p]||0,f=d.gte(g);return r.gold.gte(j.gold)&&f?"#00e676":"var(--text-secondary)"},re=(t,d)=>{const o=_.find(P=>P.id===t);if(!o||!w||d.lt(10))return null;const l=(r.nationalProjects[t]||{level:0}).level,x=l>=S,p=l+1,j=W(t,p),g=T[p]||0,f=d.gte(g),B=r.gold.gte(j.gold),a=B&&f;return e.jsxs("div",{style:{padding:"10px",background:"var(--panel-bg)",border:"2px solid var(--accent-color)",borderRadius:"8px",fontSize:"0.8rem",color:"var(--text-color)",minWidth:"200px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:[e.jsxs("div",{style:{fontWeight:"bold",marginBottom:"5px",color:"var(--accent-color)"},children:["ðŸ—ï¸ ",o.name.replace(" Infrastructure","")," - Lvl ",l,"/",S]}),e.jsxs("div",{style:{marginBottom:"5px",fontSize:"0.75rem",color:"var(--text-secondary)"},children:["Current Bonus: +",(l*O*100).toFixed(0),"% Global"]}),x?e.jsx("div",{style:{textAlign:"center",padding:"5px",color:"var(--gold-color)",fontWeight:"bold",fontSize:"0.7rem",border:"1px solid var(--gold-color)",borderRadius:"4px",background:"rgba(255, 215, 0, 0.1)"},children:"MAX LEVEL"}):e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.7rem",marginBottom:"5px"},children:[e.jsxs("div",{style:{color:B?"var(--success-color)":"var(--error-color)"},children:["ðŸ’° ",h(j.gold)]}),e.jsxs("div",{style:{color:f?"var(--success-color)":"var(--error-color)"},children:["ðŸ  ",g," buildings"]})]}),e.jsx("div",{style:{fontSize:"0.7rem",color:a?"var(--success-color)":"var(--error-color)",textAlign:"center",fontWeight:"bold"},children:a?"Click to upgrade!":"Requirements not met"})]})]})};let Y=0;return e.jsxs("div",{style:pe,children:[e.jsx("div",{style:{display:"flex",gap:"5px",marginBottom:"10px",justifyContent:"center"},children:[n(1),n(10),n(100),n(500),n(1e3),n(-1)].map(t=>e.jsx("button",{onClick:()=>b(t),style:{padding:"5px 10px",border:"1px solid var(--accent-color)",background:u.equals(t)?"var(--accent-color)":"var(--panel-bg)",color:u.equals(t)?"var(--text-on-accent)":"var(--text-color)",cursor:"pointer",fontWeight:"bold",fontSize:"0.8rem"},children:t.equals(n(-1))?"Max":`${t.toString()}`},`amount-${t.toString()}`))}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",textAlign:"center"},children:"Hold Ctrl: x10 â€¢ Hold Shift: x100"}),e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"10px",justifyContent:"center"},children:[e.jsx("button",{className:"btn",style:{background:L?"var(--panel-bg)":"var(--accent-color)",color:L?"var(--text-color)":"var(--text-on-accent)",border:"1px solid var(--accent-color)",padding:"5px 15px",fontSize:"0.8rem"},onClick:()=>k(!1),children:"ðŸ›’ Buy Mode"}),e.jsx("button",{className:"btn",style:{background:L?"#e65100":"var(--panel-bg)",color:L?"var(--text-on-accent)":"var(--text-color)",border:"1px solid #e65100",padding:"5px 15px",fontSize:"0.8rem"},onClick:()=>k(!0),children:"ðŸ’° Sell Mode (25%)"})]}),e.jsx("h3",{style:{fontSize:"1rem",color:"var(--text-secondary)",fontWeight:"bold",borderBottom:"1px solid var(--border-color)",paddingBottom:"5px"},children:"Estates"}),ce.map((t,d)=>{const o=r.buildings[t.id]||n(0),c=r.totalGold.gte(t.baseCost)||o.gt(n(0));if(c||Y++,!c&&Y>2)return null;if(L){if(o.eq(n(0)))return null;let a;u.equals(n(-1))?a=o:(a=u.times(H),a.gt(o)&&(a=o));const P=q(t.baseCost,o.minus(a),a).times(n(.25)).floor();return oe(t.id,t.baseProduction),e.jsxs("div",{style:ee(!0,!1,!1,!1),onClick:()=>s(t.id,a.toNumber()),onMouseEnter:R=>U(R,t),onMouseLeave:I,children:[o.gte(n(10))&&e.jsx("div",{style:{position:"absolute",left:"11px",top:"50%",transform:"translateY(-50%)",width:"28px",height:"28px",cursor:"pointer",pointerEvents:"auto",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},onClick:R=>{R.stopPropagation(),V(t.id)},onMouseEnter:R=>J(R,t.id),onMouseLeave:K,children:e.jsx("svg",{width:"26",height:"26",viewBox:"0 0 12 12",style:{fill:z(t.id,o),filter:z(t.id,o)==="#00e676"?"drop-shadow(0 0 8px rgba(0, 230, 118, 0.6))":z(t.id,o)==="var(--gold-color)"?"drop-shadow(0 0 8px rgba(255, 215, 0, 0.6))":"drop-shadow(0 0 4px rgba(0, 0, 0, 0.3))"},children:e.jsx("path",{d:"M6 1 L10 8 L7 8 L7 11 L5 11 L5 8 L2 8 Z"})})}),e.jsx("div",{style:{fontSize:"2rem",marginRight:"15px",width:"40px",textAlign:"center",position:"relative",marginLeft:o.gte(n(10))?"30px":"10px"},children:t.icon}),e.jsx("div",{style:{flex:1},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1.1rem",color:"var(--text-color)"},children:t.name}),e.jsx("span",{style:{fontSize:"1.8rem",fontWeight:"bold",color:"var(--accent-color)"},children:h(o,r.numberFormat)})]})}),e.jsxs("div",{style:{marginLeft:"12px",minWidth:"70px",textAlign:"right"},children:[e.jsxs("div",{style:{color:"var(--accent-color)",fontWeight:"bold"},children:["+",h(P,r.numberFormat)]}),e.jsxs("div",{style:{fontSize:"0.7rem",color:"var(--text-secondary)"},children:["for ",h(a,r.numberFormat)]})]})]},t.id)}let l=n(0),x=n(0);u.equals(n(-1))?(l=Q(t.baseCost,o,r.gold.div(v)),l.eq(n(0))?(l=n(1),x=ae(t.baseCost,o).times(v).floor()):x=q(t.baseCost,o,l).times(v).floor()):(l=u,x=q(t.baseCost,o,l).times(v).floor());const p=r.gold.gte(x),j=u.equals(n(-1))&&Q(t.baseCost,o,r.gold.div(v)).eq(n(0));let g=l,f=x,B=p;return u.equals(n(-1))||(g=l.times(H),f=q(t.baseCost,o,g).times(v).floor(),B=r.gold.gte(f)),e.jsxs("div",{style:ee(B&&!j,!1,!c),onClick:()=>{if(!(B&&!j))return;const a=u.equals(n(-1))?l:g;i(t.id,a.toNumber())},onMouseEnter:a=>U(a,t),onMouseLeave:I,children:[e.jsxs("div",{style:{fontSize:"2rem",marginRight:"15px",width:"40px",textAlign:"center",position:"relative",marginLeft:o.gte(n(10))?"30px":"10px"},children:[t.icon,o.gte(n(10))&&e.jsx("div",{style:{position:"absolute",left:"-27px",top:"50%",transform:"translateY(-50%)",width:"28px",height:"28px",cursor:"pointer",pointerEvents:"auto",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},onClick:a=>{a.stopPropagation(),V(t.id)},onMouseEnter:a=>J(a,t.id),onMouseLeave:K,children:e.jsx("svg",{width:"26",height:"26",viewBox:"0 0 12 12",style:{fill:z(t.id,o),filter:z(t.id,o)==="#00e676"?"drop-shadow(0 0 8px rgba(0, 230, 118, 0.6))":z(t.id,o)==="var(--gold-color)"?"drop-shadow(0 0 8px rgba(255, 215, 0, 0.6))":"drop-shadow(0 0 4px rgba(0, 0, 0, 0.3))"},children:e.jsx("path",{d:"M6 1 L10 8 L7 8 L7 11 L5 11 L5 8 L2 8 Z"})})})]}),e.jsx("div",{style:{flex:1},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1.1rem",color:"var(--text-color)"},children:t.name}),e.jsx("span",{style:{fontSize:"1.8rem",fontWeight:"bold",color:"var(--accent-color)"},children:h(o,r.numberFormat)})]})}),e.jsxs("div",{style:{marginLeft:"12px",minWidth:"70px",textAlign:"right"},children:[e.jsx("div",{style:{color:"var(--accent-color)",fontWeight:"bold"},children:h(u.equals(n(-1))?x:f,r.numberFormat)}),e.jsxs("div",{style:{fontSize:"0.7rem",color:"var(--text-secondary)"},children:["for ",h(u.equals(n(-1))?l:g,r.numberFormat)]})]})]},t.id)}),e.jsx(xe,{gameState:r,building:y.building,x:y.x,y:y.y,visible:y.visible,onHide:I}),m.visible&&m.buildingId&&e.jsx("div",{style:{position:"fixed",left:m.x,top:m.y-50,zIndex:1e3,pointerEvents:"none"},children:re(m.buildingId,r.buildings[m.buildingId]||n(0))}),A.visible&&A.building&&e.jsx(ue,{building:A.building,gameState:r,onClose:()=>te({visible:!1,building:null})})]})};export{ye as B};
