var kt=Object.defineProperty,Lt=Object.defineProperties;var Ct=Object.getOwnPropertyDescriptors;var $e=Object.getOwnPropertySymbols;var jt=Object.prototype.hasOwnProperty,Mt=Object.prototype.propertyIsEnumerable;var He=(e,c,w)=>c in e?kt(e,c,{enumerable:!0,configurable:!0,writable:!0,value:w}):e[c]=w,i=(e,c)=>{for(var w in c||(c={}))jt.call(c,w)&&He(e,w,c[w]);if($e)for(var w of $e(c))Mt.call(c,w)&&He(e,w,c[w]);return e},a=(e,c)=>Lt(e,Ct(c));var Et=(e,c)=>()=>(c||e((c={exports:{}}).exports,c),c.exports);var se=(e,c,w)=>new Promise((G,v)=>{var P=k=>{try{E(w.next(k))}catch(B){v(B)}},C=k=>{try{E(w.throw(k))}catch(B){v(B)}},E=k=>k.done?G(k.value):Promise.resolve(k.value).then(P,C);E((w=w.apply(e,c)).next())});import{r as y,j as l,a as It,R as Gt}from"./vendor-react-CUeQczFW.js";import{n as Bt,o as et,t,p as ae,a as tt,f as F,T as Ke,e as Je,B as X,P as Dt,q as be,A as Ot,m as ye,k as ve,l as xe,h as Xe,d as Ut,c as Nt,M as Rt,b as At,r as _t,g as zt}from"./core-C6hXvPHv.js";import{a as Ve,G as Ft}from"./components-ui-DNltbFR6.js";import{B as qe}from"./components-store-CJuVZDk8.js";import{M as Ye}from"./components-main-HPSbm32r.js";import{s as Qe,a as ie,O as Wt,E as $t,T as Ht,b as Kt,S as Jt,c as Xt,d as Vt,e as qt,R as Yt,L as Qt,f as Zt,u as eo}from"./components-modals-CTpAcMQr.js";import{P as to}from"./components-services-IDmCsBj4.js";import"./vendor-DdgGw12P.js";import"./components-achievements-DxxPQpbS.js";import"./vendor-firebase-IMiYFFvY.js";var lo=Et(de=>{(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const v of document.querySelectorAll('link[rel="modulepreload"]'))G(v);new MutationObserver(v=>{for(const P of v)if(P.type==="childList")for(const C of P.addedNodes)C.tagName==="LINK"&&C.rel==="modulepreload"&&G(C)}).observe(document,{childList:!0,subtree:!0});function w(v){const P={};return v.integrity&&(P.integrity=v.integrity),v.referrerPolicy&&(P.referrerPolicy=v.referrerPolicy),v.crossOrigin==="use-credentials"?P.credentials="include":v.crossOrigin==="anonymous"?P.credentials="omit":P.credentials="same-origin",P}function G(v){if(v.ep)return;v.ep=!0;const P=w(v);fetch(v.href,P)}})();const Ze=({gameState:e,onBuyTowerFloor:c})=>{const[w,G]=y.useState(0),v=Bt(e.totalGold);y.useEffect(()=>{const M=setInterval(()=>{G(N=>(N+1)%360)},50);return()=>clearInterval(M)},[]),et(e.totalGold);const P=e.darkMatterGold||t(0),C=e.infiniteTowerLevel||0;e.portalProgress;const E=ae(C),k=P.gte(E),U=tt(C).minus(t(1)).times(t(100)),$=(()=>{if(v)return 100;if(e.totalGold.lt(t(1e15)))return 0;const M=Math.log10(1e15),N=Math.log10(1e18),ee=Math.log10(e.totalGold.toNumber()),te=(Math.max(M,Math.min(N,ee))-M)/(N-M)*100;return Math.floor(te)})();return l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"var(--gap-size)",height:"100%",minHeight:"600px",overflow:"hidden"},children:l.jsxs("div",{style:{flex:1,overflowY:"auto",overflowX:"hidden",padding:"var(--panel-padding)",WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:[l.jsxs("div",{style:{textAlign:"center",padding:"20px",background:"var(--panel-bg)",border:v?"2px solid #673ab7":"2px dashed var(--border-color)",borderRadius:"8px",position:"relative",overflow:"hidden",marginBottom:"20px"},children:[l.jsx("div",{style:{width:"120px",height:"120px",margin:"0 auto 15px",borderRadius:"50%",background:v?`radial-gradient(circle, rgba(103, 58, 183, ${.3+Math.sin(w*Math.PI/180)*.2}), rgba(103, 58, 183, 0.1))`:"radial-gradient(circle, rgba(128, 128, 128, 0.2), rgba(128, 128, 128, 0.05))",border:v?`3px solid rgba(103, 58, 183, ${.5+Math.sin(w*Math.PI/180)*.3})`:"3px solid rgba(128, 128, 128, 0.3)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"3rem",animation:v?"pulse 2s infinite":"none",transform:`rotate(${w}deg)`,transition:"all 0.3s ease"},children:v?"ðŸŒ€":"ðŸ”’"}),l.jsx("h3",{style:{fontSize:"1.3rem",color:"#ba68c8",marginBottom:"10px",fontWeight:"bold",textShadow:"0 0 10px rgba(186, 104, 200, 0.5)"},children:v?"Portal to Another Dimension":"Portal Construction"}),!v&&l.jsxs("div",{style:{marginBottom:"15px"},children:[l.jsxs("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",marginBottom:"8px"},children:["Progress: ",$,"%"]}),l.jsx("div",{style:{width:"100%",height:"8px",background:"rgba(0,0,0,0.1)",borderRadius:"4px",overflow:"hidden"},children:l.jsx("div",{style:{width:`${$}%`,height:"100%",background:"linear-gradient(90deg, #673ab7, #9575cd)",transition:"width 0.3s ease"}})}),l.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginTop:"5px"}})]}),v&&l.jsx("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)"},children:"The portal shimmers with infinite possibilities..."})]}),v&&l.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(103, 58, 183, 0.1), rgba(103, 58, 183, 0.05))",padding:"15px",borderRadius:"8px",border:"1px solid #673ab7",marginBottom:"20px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[l.jsx("div",{style:{display:"flex",alignItems:"center"},children:l.jsx("span",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#ba68c8",textShadow:"0 0 8px rgba(186, 104, 200, 0.4)"},children:"âš« Dark Matter Gold"})}),l.jsx("div",{style:{display:"flex",alignItems:"center"},children:l.jsx("span",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"#ce93d8",textShadow:"0 0 8px rgba(206, 147, 216, 0.4)"},children:F(P,e.numberFormat)})})]}),v&&l.jsxs("div",{style:{background:"var(--panel-bg)",padding:"1px 19px 19px 19px",borderRadius:"px",border:"2px solid #ff9800",marginBottom:"20px"},children:[l.jsx("h4",{style:{fontSize:"1.1rem",color:"#ff9800",marginBottom:"10px",fontWeight:"bold"},children:"ðŸ—ï¸ Infinite Tower of Time & Space"}),l.jsxs("div",{style:{marginBottom:"15px"},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[l.jsx("span",{style:{fontSize:"0.9rem",color:"var(--text-color)"},children:"Current Level"}),l.jsx("span",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#ff9800",textShadow:"0 0 8px rgba(255, 152, 0, 0.4)"},children:C})]}),l.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",marginBottom:"10px"},children:["Income Bonus: +",F(U,e.numberFormat),"%"]}),l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[l.jsx("span",{style:{fontSize:"0.9rem",color:"var(--text-color)"},children:"Next Floor Cost"}),l.jsxs("span",{style:{fontSize:"1rem",fontWeight:"bold",color:k?"#673ab7":"var(--text-secondary)"},children:[F(E,e.numberFormat)," âš«"]})]})]}),l.jsx("button",{className:"btn",onClick:c,disabled:!k,style:{width:"100%",background:k?"#ff9800":"var(--panel-bg)",color:k?"var(--text-on-accent)":"var(--text-color)",border:"2px solid #ff9800",padding:"10px",fontSize:"1rem",fontWeight:"bold",opacity:k?1:.6,cursor:k?"pointer":"default"},children:k?"Build Next Floor":"Not Enough Dark Matter Gold"})]}),l.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(103, 58, 183, 0.1), rgba(103, 58, 183, 0.05))",padding:"15px",borderRadius:"8px",border:"1px solid rgba(103, 58, 183, 0.2)",fontSize:"0.9rem",color:"var(--text-secondary)",lineHeight:"1.6",fontStyle:"italic",marginBottom:"20px"},children:[l.jsx("div",{style:{fontWeight:"bold",marginBottom:"10px",color:"#ba68c8",fontStyle:"normal",textAlign:"center",fontSize:"1rem",textShadow:"0 0 8px rgba(186, 104, 200, 0.3)"},children:"ðŸŒŒ The Infinite Mystery"}),l.jsx("p",{style:{margin:"0 0 10px 0",textAlign:"center"},children:"When a kingdom's treasures transcend mortal comprehension, the very fabric of reality begins to unravel, revealing hidden passages to worlds beyond imagination."}),l.jsx("p",{style:{margin:"0 0 10px 0",textAlign:"center"},children:"Through this gateway flows dark matter - the concentrated essence of time and space itself, capable of rewriting the fundamental laws of creation and transforming the nature of existence."}),l.jsx("p",{style:{margin:"0",textAlign:"center",fontWeight:"bold"},children:"Each floor of the Infinite Tower amplifies the flow's power, creating cascades of limitless possibilities in the eternal dance of universes..."})]})]})})},oo=({gameState:e})=>{const{weather:c,buildings:w,totalGold:G}=e,v=$=>{var M;return((M=w[$])==null?void 0:M.toNumber())||0};let P="wilderness";v("palace")>0?P="empire":v("castle")>0||v("market")>0?P="city":(v("peasant")>20||v("field")>10||G.gt(t(500)))&&(P="hamlet");let C="",E="";switch(P){case"wilderness":C="linear-gradient(to bottom, #87CEEB 0%, #87CEEB 60%, #556B2F 60%, #556B2F 100%)",E="ðŸŒ² ðŸŒ³ ðŸŒ² ðŸ¦Œ ðŸŒ² ðŸŒ¿";break;case"hamlet":C="linear-gradient(to bottom, #87CEEB 0%, #87CEEB 65%, #8B4513 65%, #228B22 80%)",E="ðŸ¡ ðŸŒ¾ ðŸ„ ðŸ¡ ðŸŒ¾ ðŸšœ";break;case"city":C="linear-gradient(to bottom, #B0C4DE 0%, #B0C4DE 60%, #696969 60%, #808080 100%)",E="ðŸ° ðŸ  âš’ï¸ ðŸ  âš–ï¸ ðŸ ";break;case"empire":C="linear-gradient(to bottom, #191970 0%, #4B0082 50%, #FFD700 100%)",E="ðŸ¯ ðŸ’‚ ðŸ›ï¸ ðŸ‰ ðŸ›ï¸ ðŸ’‚";break}const k=c.current;let B="none",U="",W=0;return k==="rainy"?(B="linear-gradient(to bottom, rgba(0,0,50,0.3), rgba(0,0,100,0.3))",U="ðŸŒ§ï¸ ðŸŒ§ï¸ ðŸŒ§ï¸ ðŸŒ§ï¸ ðŸŒ§ï¸",W=1):k==="stormy"?(B="linear-gradient(to bottom, rgba(0,0,0,0.6), rgba(50,50,50,0.6))",U="âš¡ â›ˆï¸ âš¡ â›ˆï¸ âš¡",W=1):k==="sunny"?(B="radial-gradient(circle at top right, rgba(255,255,0,0.3), transparent)",U="â˜€ï¸",W=.6):k==="windy"&&(U="ðŸƒ ðŸƒ ðŸƒ",W=.8),l.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:C,display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"center",paddingBottom:"20vh",zIndex:0,overflow:"hidden",transition:"background 2s ease"},children:[l.jsx("div",{style:{position:"absolute",top:"10%",width:"100%",textAlign:"center",fontSize:"5rem",opacity:W,animation:k==="windy"?"float 3s infinite ease-in-out":"none"},children:U}),B!=="none"&&l.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:B,pointerEvents:"none"}}),l.jsx("div",{style:{fontSize:"4rem",textAlign:"center",zIndex:1,textShadow:"0 4px 4px rgba(0,0,0,0.3)",whiteSpace:"nowrap"},children:E}),l.jsx("div",{style:{marginTop:"20px",fontSize:"1.5rem",color:"#fff",textShadow:"2px 2px 4px #000",fontStyle:"italic",zIndex:2,background:"rgba(0,0,0,0.5)",padding:"5px 15px",borderRadius:"15px"},children:"The Kingdom sleeps..."}),l.jsx("style",{children:`
            @keyframes float {
                0% { transform: translateX(0px); }
                50% { transform: translateX(20px); }
                100% { transform: translateX(0px); }
            }
        `})]})},z={density:"normal",showFloatingText:!0,showWeatherWidget:!0,lastBuyAmount:t(1),layout:{left:t(1),center:t(1),right:t(1)},borderWidth:t(4),customColors:{enabled:!1,bg:"#e8dcc5",panel:"#fdf6e3",text:"#3e2723",secondaryText:"#5d4037",accent:"#8d6e63",accentHover:"#6d4c41",gold:"#bf9000",border:"#a1887f",success:"#2e7d32",danger:"#c62828"}},A={gold:t(0),totalGold:t(0),totalRenownEarned:t(0),startTime:t(Date.now()),lastSaveTime:t(Date.now()),buildings:{},achievements:[],renown:t(0),prestigeCount:0,darkMatterGold:t(0),infiniteTowerLevel:0,portalProgress:0,nationalProjects:{},clickUpgradeLevel:0,offlineUpgradeLevel:0,weather:{current:"clear",timeLeft:t(120)},event:null,theme:"default",numberFormat:"standard",idleModeEnabled:!1,interface:z,stats:{totalClicks:t(0),currentPrestigeClicks:t(0),dragonsKilled:t(0),tavernGamesPlayed:t(0),prestigeCount:0,infiniteTowerLevel:0,darkMatterGold:t(0),portalProgress:0,clickUpgradeLevel:0,offlineUpgradeLevel:0,totalBuildingsPurchased:t(0),totalGoldSpent:t(0)},playerProfile:null,isDeveloperWifeBlessingObtained:!1,globalIncomeMultiplier:1,isBetaTesterBlessingObtained:!1,betaTesterIncomeMultiplier:1},V=e=>{if(e==null||typeof e=="string"||typeof e=="number"||typeof e=="boolean")return e;if(Array.isArray(e))return e.map(V);if(typeof e=="object"&&e.toString&&typeof e.toString=="function"&&(e.hasOwnProperty("mantissa")||e.hasOwnProperty("exponent")))return e.toString();if(typeof e=="object"){const c={};for(const w in e)e.hasOwnProperty(w)&&(c[w]=V(e[w]));return c}return e},ro=()=>{var Be,De;const[e,c]=y.useState(()=>{var r,n,s,u,f,m,p,S,h,L,x,D,O,_,j,I,H,ne,Oe,Ue,Ne,Re,Ae,_e,ze,Fe;const o=localStorage.getItem("kingdom_save");if(o)try{const d=JSON.parse(o);if((r=d.playerProfile)!=null&&r.id){const g=localStorage.getItem(`playerProfile_${d.playerProfile.id}`);g&&(d.playerProfile=JSON.parse(g))}const K=d.interface||{},We=a(i(i({},z),K),{lastBuyAmount:t((n=K.lastBuyAmount)!=null?n:1),layout:{left:t((u=(s=K.layout)==null?void 0:s.left)!=null?u:z.layout.left),center:t((m=(f=K.layout)==null?void 0:f.center)!=null?m:z.layout.center),right:t((S=(p=K.layout)==null?void 0:p.right)!=null?S:z.layout.right)},borderWidth:t((h=K.borderWidth)!=null?h:z.borderWidth),customColors:i(i({},z.customColors),K.customColors||{})});return a(i(i({},A),d),{renown:t(d.renown||0),totalRenownEarned:t(d.totalRenownEarned||0),prestigeCount:d.prestigeCount||0,gold:t(d.gold||0),totalGold:t(d.totalGold||0),startTime:t(d.startTime||Date.now()),lastSaveTime:t(d.lastSaveTime||Date.now()),darkMatterGold:t(d.darkMatterGold||0),infiniteTowerLevel:d.infiniteTowerLevel||0,portalProgress:d.portalProgress||0,buildings:Object.keys(d.buildings||{}).reduce((g,T)=>(g[T]=t(d.buildings[T]),g),{}),stats:a(i(i({},A.stats),d.stats||{}),{totalClicks:t(((L=d.stats)==null?void 0:L.totalClicks)||0),currentPrestigeClicks:t(((x=d.stats)==null?void 0:x.currentPrestigeClicks)||0),dragonsKilled:t(((D=d.stats)==null?void 0:D.dragonsKilled)||0),tavernGamesPlayed:t(((O=d.stats)==null?void 0:O.tavernGamesPlayed)||0),prestigeCount:((_=d.stats)==null?void 0:_.prestigeCount)||0,infiniteTowerLevel:((j=d.stats)==null?void 0:j.infiniteTowerLevel)||0,darkMatterGold:t(((I=d.stats)==null?void 0:I.darkMatterGold)||0),portalProgress:((H=d.stats)==null?void 0:H.portalProgress)||0,clickUpgradeLevel:((ne=d.stats)==null?void 0:ne.clickUpgradeLevel)||0,offlineUpgradeLevel:((Oe=d.stats)==null?void 0:Oe.offlineUpgradeLevel)||0,totalBuildingsPurchased:t(((Ue=d.stats)==null?void 0:Ue.totalBuildingsPurchased)||0),totalGoldSpent:t(((Ne=d.stats)==null?void 0:Ne.totalGoldSpent)||0)}),nationalProjects:d.nationalProjects||{},clickUpgradeLevel:d.clickUpgradeLevel||0,offlineUpgradeLevel:d.offlineUpgradeLevel||0,interface:We,playerProfile:d.playerProfile?a(i({},d.playerProfile),{lastLeaderboardSubmit:d.playerProfile.lastLeaderboardSubmit||0}):null,globalIncomeMultiplier:d.globalIncomeMultiplier||1,isDeveloperWifeBlessingObtained:d.isDeveloperWifeBlessingObtained||!1,betaTesterIncomeMultiplier:d.betaTesterIncomeMultiplier||1,isBetaTesterBlessingObtained:d.isBetaTesterBlessingObtained||!1})}catch(d){console.error("Save load failed",d)}return A}),w=y.useRef(e);y.useEffect(()=>{w.current=e},[e]);const G=y.useRef("");y.useEffect(()=>{const o=r=>{G.current=(G.current+r.key).slice(-20);const n=G.current.toLowerCase();n.endsWith("godon")?(c(s=>a(i({},s),{godMode:!0})),b("God Mode Enabled: +99999s per click","success"),G.current=""):n.endsWith("godoff")&&(c(s=>a(i({},s),{godMode:!1})),b("God Mode Disabled","info"),G.current="")};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[]);const v=()=>{N(null);const o=localStorage.getItem("kingdom_last_save_time"),r=Date.now();if(o){const n=r-parseInt(o),s=t(n/1e3);if(s.gte(t(60))){const u=e.offlineUpgradeLevel||0,{efficiency:f,duration:m}=Je(u),p=t(m),S=s.lt(p)?s:p,L=q(e).times(t(f)).times(S).floor();L.gt(t(0))&&(N({gained:L,effectiveTime:S,totalTime:s,efficiency:f,completedProjects:[],currentLevel:u,maxDuration:m}),c(x=>a(i({},x),{gold:x.gold.plus(L),totalGold:x.totalGold.plus(L)})))}}localStorage.setItem("kingdom_last_save_time",r.toString())},[P,C]=y.useState(!1);y.useEffect(()=>{let o;const r=()=>{C(!1),clearTimeout(o),e.idleModeEnabled&&(o=setTimeout(()=>{C(!0)},2e4))};r();const n=["mousemove","mousedown","keydown","touchstart","scroll"];return n.forEach(s=>window.addEventListener(s,r)),()=>{clearTimeout(o),n.forEach(s=>window.removeEventListener(s,r))}},[e.idleModeEnabled]),y.useEffect(()=>{e.event&&C(!1)},[e.event]),y.useEffect(()=>{const o=F(e.gold);document.title=`Gold: ${o} - Kingdom Clicker`},[e.gold]),y.useEffect(()=>{const o=document.documentElement,r=e.interface||z,n=e.theme||"default",s=Ke[n]||Ke.default;s&&Object.entries(s.colors).forEach(([m,p])=>{o.style.setProperty(m,p)});const u={compact:"8px",normal:"12px",spacious:"20px"},f={compact:"6px",normal:"12px",spacious:"16px"};o.style.setProperty("--panel-padding",u[r.density]),o.style.setProperty("--gap-size",f[r.density]),o.style.setProperty("--col-left",String(r.layout.left)),o.style.setProperty("--col-center",String(r.layout.center)),o.style.setProperty("--col-right",String(r.layout.right)),r.reduceMotion?document.body.classList.add("no-motion"):document.body.classList.remove("no-motion")},[e.theme,e.interface]);const[E,k]=y.useState(!1);y.useEffect(()=>{var o;e.gold.gte(t(1e7))&&!((o=e.playerProfile)!=null&&o.hasChosenName)&&!E&&Se(!0)},[e.gold,e.playerProfile,E]);const[B,U]=y.useState(null),[W,$]=y.useState([]),[M,N]=y.useState(null),[ee,we]=y.useState("buildings"),[te,rt]=y.useState("army"),[oe,nt]=y.useState(!1),[R,ce]=y.useState("throne");y.useEffect(()=>{const o=()=>{nt(window.innerWidth<768)};return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]);const[lt,ue]=y.useState(!1),[st,re]=y.useState(!1),[it,J]=y.useState(!1),[at,dt]=y.useState(!1),[ct,fe]=y.useState(!1),[ut,ge]=y.useState(!1),[Pe,Se]=y.useState(!1),[Te,me]=y.useState(!1),[ft,ke]=y.useState(!1),[Le,gt]=y.useState(!1),b=(o,r="info")=>{const n=Date.now().toString()+Math.random();$(s=>[...s,{id:n,message:o,type:r}]),setTimeout(()=>{$(s=>s.filter(u=>u.id!==n))},3e3)};y.useEffect(()=>{const o=Date.now();if(e.lastSaveTime&&t(o).minus(e.lastSaveTime).gt(t(6e4))){const r=t(o).minus(e.lastSaveTime).dividedBy(t(1e3)),{efficiency:n,duration:s}=Je(e.offlineUpgradeLevel||0),u=t(s),f=r.lt(u)?r:u,p=q(e).times(t(n)).times(f).floor(),S=[];let h=i({},e.nationalProjects),L=!1;Object.keys(h).forEach(x=>{var O;const D=h[x];if(D.active&&D.endTime&&o>=D.endTime){h[x]=a(i({},D),{active:!1,level:D.level+1,startTime:0,endTime:0});const _=(O=X.find(j=>j.id===x))==null?void 0:O.name;_&&S.push(`${_} Infrastructure (Lvl ${D.level+1})`),L=!0}}),(p.gt(t(0))||S.length>0)&&(N(x=>x||{gained:p,effectiveTime:f,totalTime:r,efficiency:n,completedProjects:S,currentLevel:e.offlineUpgradeLevel||0,maxDuration:s}),c(x=>a(i({},x),{gold:x.gold.plus(p),totalGold:x.totalGold.plus(p),nationalProjects:L?h:x.nationalProjects})))}},[]),y.useEffect(()=>{const o=setInterval(()=>{Date.now()%3e4<1e3&&c(r=>{const n=a(i({},r),{lastSaveTime:t(Date.now())}),s=V(n);return localStorage.setItem("kingdom_save",JSON.stringify(s)),n})},1e3);return()=>clearInterval(o)},[]),y.useEffect(()=>{const o=()=>{const n=w.current,s=V(n);localStorage.setItem("kingdom_save",JSON.stringify(s)),localStorage.setItem("kingdom_last_save_time",Date.now().toString())};window.addEventListener("beforeunload",o);const r=()=>{document.visibilityState==="hidden"?o():document.visibilityState==="visible"&&v()};return document.addEventListener("visibilitychange",r),()=>{window.removeEventListener("beforeunload",o),document.removeEventListener("visibilitychange",r)}},[]),y.useEffect(()=>{var n;if(!((n=e.playerProfile)!=null&&n.hasChosenName))return;(()=>{var m;const s=Date.now(),u=((m=e.playerProfile)==null?void 0:m.lastLeaderboardSubmit)||0,f=3600*1e3;if(s-u>=f){const p={rulerName:e.playerProfile.rulerName,rulerId:e.playerProfile.rulerId,gold:e.totalGold,renown:e.totalRenownEarned,achievements:e.achievements.length,totalClicks:e.stats.totalClicks};Promise.all([ie(a(i({},p),{period:"alltime"})),ie(a(i({},p),{period:"weekly"})),Qe(e,e.playerProfile.rulerId,e.playerProfile.rulerName)]).then(()=>{c(S=>a(i({},S),{playerProfile:a(i({},S.playerProfile),{lastLeaderboardSubmit:Date.now()})})),b("Leaderboard data synced on load!","success")}).catch(S=>{console.error("Initial leaderboard submission failed:",S)})}})();const r=setInterval(()=>{var p;const s=w.current,u=Date.now(),f=((p=s.playerProfile)==null?void 0:p.lastLeaderboardSubmit)||0,m=3600*1e3;if(u-f>=m){Qe(s,s.playerProfile.rulerId,s.playerProfile.rulerName).catch(h=>{console.error("Failed to save player stats:",h)});const S={rulerName:s.playerProfile.rulerName,rulerId:s.playerProfile.rulerId,gold:s.totalGold,renown:s.totalRenownEarned,achievements:s.achievements.length,totalClicks:s.stats.totalClicks};Promise.all([ie(a(i({},S),{period:"alltime"})),ie(a(i({},S),{period:"weekly"}))]).then(()=>{c(h=>a(i({},h),{playerProfile:a(i({},h.playerProfile),{lastLeaderboardSubmit:Date.now()})})),b("Leaderboard data submitted successfully!","success")}).catch(h=>{console.error("Auto leaderboard submission failed:",h)})}},6e4);return()=>clearInterval(r)},[(Be=e.playerProfile)==null?void 0:Be.hasChosenName]),y.useEffect(()=>{const o=setInterval(()=>{if(!e.event&&Math.random()<.05){const s=["dragon","merchant","jester"],u=s[Math.floor(Math.random()*s.length)],f=u==="dragon"?6e5:3e4,m={id:Date.now().toString(),type:u,expiresAt:t(Date.now()).plus(t(f)),hp:u==="dragon"?t(10):void 0,maxHp:u==="dragon"?t(10):void 0,reward:t(0),startTime:u==="dragon"?Date.now():void 0};c(p=>a(i({},p),{event:m}))}},1e4);return()=>clearInterval(o)},[e.event]);const q=o=>{var S;let r=t(0);const n=((S=o.weather)==null?void 0:S.current)||"clear";X.forEach(h=>{const L=o.buildings[h.id]||t(0);let x=h.baseProduction;r=r.plus(L.times(x))});const s=Ve(o.totalRenownEarned);s.gt(t(1))&&(r=r.times(s));let u=0;o.nationalProjects&&Object.values(o.nationalProjects).forEach(h=>{u+=h.level||0});const f=t(1).plus(t(u*Dt));r=r.times(f);const m=tt(o.infiniteTowerLevel||0);r=r.times(m),t(1),X.forEach(h=>{const L=o.buildings[h.id]||t(0);if(L.gt(0)){let x=t(1);n==="sunny"?(h.id==="peasant"||h.id==="field"||h.id==="stable"||h.id==="cathedral")&&(x=t(1.2)):n==="rainy"?(h.id==="silver_mine"||h.id==="alchemist"||h.id==="market"||h.id==="tavern")&&(x=t(1.2)):n==="stormy"?((h.id==="blacksmith"||h.id==="void_portal")&&(x=t(1.3)),(h.id==="field"||h.id==="stable")&&(x=t(.8))):n==="windy"&&(h.id==="market"||h.id==="castle"||h.id==="time_chamber")&&(x=t(1.15));const D=L.times(h.baseProduction);if(s.gt(t(1))){const O=D.times(s).times(f).times(x.minus(t(1)));r=r.plus(O)}else{const O=D.times(f).times(x.minus(t(1)));r=r.plus(O)}}});const p=t(1).plus(t(o.achievements.length*.02));if(r=r.times(p),o.globalIncomeMultiplier&&(r=r.times(t(o.globalIncomeMultiplier))),o.betaTesterIncomeMultiplier&&(r=r.times(t(o.betaTesterIncomeMultiplier))),o.event&&o.event.type==="dragon"&&o.event.startTime){const h=Math.floor((Date.now()-o.event.startTime)/1e3),x=1-Math.min(99,h)/100;r=r.times(t(x))}return r},Y=q(e),Q=y.useRef(Y);Q.current=Y,y.useEffect(()=>{const o=setInterval(()=>{c(r=>{const n=Date.now(),s=Q.current.times(t(be)).dividedBy(t(1e3));let u=r.totalGold.plus(s),f=r.gold.plus(s),m=i({},r.weather);const p=t(be/1e3);if(m.timeLeft=t(m.timeLeft||0).minus(p),m.timeLeft.lte(t(0))){const j=["clear","sunny","rainy","stormy","windy"],I=j[Math.floor(Math.random()*j.length)],H=t(Math.floor(Math.random()*120)+60);m={current:I,timeLeft:H}}let S=r.event;S&&S.expiresAt&&t(S.expiresAt).lt(t(n))&&(S=null);let h=i({},r.nationalProjects||{});Object.keys(h).forEach(j=>{var H;const I=h[j];I.active&&I.endTime&&n>=I.endTime&&(h[j]=a(i({},I),{active:!1,level:I.level+1,startTime:0,endTime:0}),b(`Project Completed: ${(H=X.find(ne=>ne.id===j))==null?void 0:H.name} Infrastructure Level ${I.level+1}!`,"success"))});const L=[...r.achievements];let x=null;Ot.forEach(j=>{L.includes(j.id)||j.condition(a(i({},r),{totalGold:u,gold:f}),Q.current)&&(L.push(j.id),x=j)}),x&&(U(x),setTimeout(()=>U(null),3e3));const D=et(u),O=(r.infiniteTowerLevel||0)>0?Array.from({length:r.infiniteTowerLevel},(j,I)=>ae(I)).reduce((j,I)=>j.plus(I),t(0)):t(0),_=D.minus(O);return a(i({},r),{gold:f,totalGold:u,darkMatterGold:_,achievements:L,event:S,weather:m,nationalProjects:h,stats:a(i({},r.stats),{darkMatterGold:_})})})},be);return()=>clearInterval(o)},[]);const Z=(o="light")=>{if("vibrate"in navigator&&oe)switch(o){case"light":navigator.vibrate(10);break;case"medium":navigator.vibrate(20);break;case"heavy":navigator.vibrate([30,10,30]);break}},Ce=(o=!1)=>{if(o||Z("light"),!o&&!e.isDeveloperWifeBlessingObtained&&e.totalGold.gte(t(1e12))&&Math.random()<1e-6){c(s=>a(i({},s),{globalIncomeMultiplier:(s.globalIncomeMultiplier||1)+1.073,isDeveloperWifeBlessingObtained:!0,achievements:[...new Set([...s.achievements,"developer_wife_blessing"])]})),b("ðŸ’ Developer Wife Blessing received! +107.3% global income!","success");return}const r=mt(w.current);c(n=>a(i({},n),{gold:n.gold.plus(r),totalGold:n.totalGold.plus(r),stats:a(i({},n.stats),{totalClicks:n.stats.totalClicks.plus(t(1)),currentPrestigeClicks:n.stats.currentPrestigeClicks.plus(t(1)),prestigeCount:n.stats.prestigeCount,infiniteTowerLevel:n.stats.infiniteTowerLevel,darkMatterGold:n.stats.darkMatterGold,portalProgress:n.stats.portalProgress,clickUpgradeLevel:n.stats.clickUpgradeLevel,offlineUpgradeLevel:n.stats.offlineUpgradeLevel,totalBuildingsPurchased:n.stats.totalBuildingsPurchased,totalGoldSpent:n.stats.totalGoldSpent,dragonsKilled:n.stats.dragonsKilled,tavernGamesPlayed:n.stats.tavernGamesPlayed})}))},mt=o=>{const r=t(1),n=o.clickUpgradeLevel||0,s=Math.min(n,15),u=t(2).pow(s),f=r.times(u),m=Ve(o.totalRenownEarned);let p=f;m.gt(t(1))&&(p=f.times(m)),o.infiniteTowerLevel&&o.infiniteTowerLevel>0&&(p=p.times(t(1).plus(t(o.infiniteTowerLevel*.01))));const S=zt(n);if(S>0){const x=q(o).times(S);p=p.plus(x)}const h=t(1).plus(t(o.achievements.length*.02));if(p=p.times(h),o.globalIncomeMultiplier&&(p=p.times(t(o.globalIncomeMultiplier))),o.betaTesterIncomeMultiplier&&(p=p.times(t(o.betaTesterIncomeMultiplier))),o.godMode){const x=q(o).times(t(99999));p=p.plus(x)}return p},pe=()=>{const o=e.clickUpgradeLevel||0;if(o>=Rt){b("Maximum Royal Scepter level reached!","warning");return}const r=At(o+1);if(e.gold.lt(r)){b("Not enough gold!","error");return}c(n=>a(i({},n),{gold:n.gold.minus(r),clickUpgradeLevel:n.clickUpgradeLevel+1,stats:a(i({},n.stats),{clickUpgradeLevel:n.clickUpgradeLevel+1,totalGoldSpent:n.stats.totalGoldSpent.plus(r)})})),b(`Royal Scepter upgraded to level ${o+1}!`,"success")},he=()=>{const o=e.offlineUpgradeLevel||0;if(o>=Ut){b("Maximum Passive Income level reached!","warning");return}const r=Nt(o+1);if(e.renown.lt(r)){b("Not enough Renown!","error");return}c(n=>a(i({},n),{renown:n.renown.minus(r),offlineUpgradeLevel:n.offlineUpgradeLevel+1,stats:a(i({},n.stats),{offlineUpgradeLevel:n.offlineUpgradeLevel+1})})),b(`Passive Income upgraded to level ${o+1}!`,"success")},je=(o,r)=>{const n=X.find(f=>f.id===o);if(!n||r<=0)return;const s=e.buildings[o]||t(0),u=Xe(n.baseCost,s,t(r)).floor();e.gold.gte(u)&&(Z("medium"),c(f=>a(i({},f),{gold:f.gold.minus(u),buildings:a(i({},f.buildings),{[o]:(f.buildings[o]||t(0)).plus(t(r))}),stats:a(i({},f.stats),{totalBuildingsPurchased:f.stats.totalBuildingsPurchased.plus(t(r)),totalGoldSpent:f.stats.totalGoldSpent.plus(u)})})),e.isBetaTesterBlessingObtained||Math.random()<1e-4&&(c(m=>a(i({},m),{betaTesterIncomeMultiplier:(m.betaTesterIncomeMultiplier||1)+1.3,isBetaTesterBlessingObtained:!0,achievements:[...new Set([...m.achievements,"beta_tester_blessing"])]})),b("ðŸ§ª Beta-Tester Legendary blessing received! +130% global income!","success")))},Me=(o,r)=>{const n=X.find(m=>m.id===o);if(!n||r<=0)return;const s=e.buildings[o]||t(0),u=t(Math.min(r,s.toNumber()));if(u.lte(t(0)))return;const f=Xe(n.baseCost,s.minus(u),u).times(t(.25)).floor();c(m=>a(i({},m),{gold:m.gold.plus(f),buildings:a(i({},m.buildings),{[o]:s.minus(u)})}))},Ee=o=>{if(o.type==="merchant"){const r=Q.current.times(t(10));c(n=>a(i({},n),{gold:n.gold.plus(r),totalGold:n.totalGold.plus(r),event:null})),b(`The merchant gifted you ${F(r.floor(),e.numberFormat)} gold!`,"success")}else if(o.type==="jester"){const r=e.gold.times(t(.1)),n=Math.random()>.5;c(s=>a(i({},s),{gold:n?s.gold.plus(r):s.gold.minus(r),totalGold:n?s.totalGold.plus(r):s.totalGold,event:null})),n?b(`Jester pays out! +${F(r.floor(),e.numberFormat)}`,"success"):b(`Jester tricked you! -${F(r.floor(),e.numberFormat)}`,"warning")}else if(o.type==="dragon")try{let r=!1;c(n=>{if(!n.event||n.event.type!=="dragon")return n;const u=t(n.event.hp||10).minus(t(1));if(u.lte(0)){const f=Q.current.times(t(30));return r=!0,a(i({},n),{gold:n.gold.plus(f),totalGold:n.totalGold.plus(f),event:null,stats:a(i({},n.stats),{dragonsKilled:n.stats.dragonsKilled.plus(t(1))})})}return a(i({},n),{event:a(i({},n.event),{hp:u})})}),r&&b("Dragon Slain! +Treasury Boost","success")}catch(r){console.error("Error handling dragon interaction:",r),b("Error interacting with dragon","error")}},pt=()=>{const o=t(1),r=t(1e12),n=e.totalGold;if(n.lt(r))return;const s=n.dividedBy(r),f=t(Math.floor(Math.pow(s.toNumber(),.33))).times(o).minus(e.renown);if(f.lte(0))return;const m=i({},e.nationalProjects);Object.keys(m).forEach(p=>{m[p].active&&(m[p]=a(i({},m[p]),{active:!1,startTime:0,endTime:0}))}),c(a(i({},A),{renown:e.renown.plus(f),totalRenownEarned:e.totalRenownEarned.plus(f),prestigeCount:e.prestigeCount+1,totalGold:e.totalGold,achievements:e.achievements,nationalProjects:m,offlineUpgradeLevel:e.offlineUpgradeLevel,darkMatterGold:e.darkMatterGold,infiniteTowerLevel:e.infiniteTowerLevel,playerProfile:e.playerProfile,startTime:t(Date.now()),lastSaveTime:t(Date.now()),theme:e.theme,idleModeEnabled:e.idleModeEnabled,interface:e.interface,stats:a(i({},A.stats),{totalClicks:e.stats.totalClicks,prestigeCount:e.prestigeCount+1,currentPrestigeClicks:t(0),infiniteTowerLevel:e.infiniteTowerLevel,darkMatterGold:e.darkMatterGold,clickUpgradeLevel:e.clickUpgradeLevel,offlineUpgradeLevel:e.offlineUpgradeLevel})})),re(!1),b("Abdication Successful. Long live the new King!","success")},ht=()=>{localStorage.removeItem("kingdom_save"),c(a(i({},A),{startTime:t(Date.now())})),J(!1),b("Game Reset","warning")},bt=()=>{const o=e.interface,r=e.theme,n=e.numberFormat,s=e.idleModeEnabled;c(a(i({},A),{startTime:t(Date.now()),interface:o,theme:r,numberFormat:n,idleModeEnabled:s})),J(!1),b("Progress Reset - Settings Preserved","warning")},yt=()=>{const r=V(e);localStorage.setItem("kingdom_save",JSON.stringify(r)),b("Game Saved","info")},vt=()=>{c(o=>{const r=i({},o.nationalProjects);return Object.keys(r).forEach(n=>{r[n].active&&(r[n]=a(i({},r[n]),{endTime:Date.now()+5e3}))}),a(i({},o),{nationalProjects:r})}),b("Projects sped up to 5 seconds!","success")};window.speedUpProjects=vt;const xt=o=>{c(r=>a(i({},r),{playerProfile:o})),localStorage.setItem(`playerProfile_${o.id}`,JSON.stringify(o)),b(`Welcome, ${o.rulerName} ${o.rulerId}!`,"success"),k(!1)},wt=()=>se(null,null,function*(){pt()}),Pt=o=>se(null,null,function*(){var r;if(!((r=e.playerProfile)!=null&&r.id)){b("Error: Player profile not found","error");return}try{yield eo(e.playerProfile.id,o);const n=a(i({},e.playerProfile),{rulerName:o});c(f=>a(i({},f),{playerProfile:n}));const s=a(i({},e),{playerProfile:n}),u=V(s);localStorage.setItem("kingdom_save",JSON.stringify(u)),b(`Name successfully changed to "${o}"!`,"success")}catch(n){console.error("Error changing name:",n),b("Failed to change name. Please try again.","error")}}),St=o=>se(null,null,function*(){var s;const r=((s=e.playerProfile)==null?void 0:s.id)||"default_player",n=yield to.redeemPromoCode(r,o);if(!n){b("Invalid or expired promo code!","error");return}switch(n.type){case"gold":c(u=>a(i({},u),{gold:u.gold.plus(t(n.value)),totalGold:u.totalGold.plus(t(n.value))})),b(`Received ${F(t(n.value))} gold!`,"success");break;case"betaTester":c(u=>{const f=u.playerProfile?a(i({},u.playerProfile),{usedPromoCodes:[...u.playerProfile.usedPromoCodes||[],"beta_tester"],specialIcon:n.icon||"ðŸ§ª",specialTitle:n.title||"Beta Tester",isBetaTester:!0}):null;return f&&localStorage.setItem(`playerProfile_${r}`,JSON.stringify(f)),a(i({},u),{playerProfile:f})}),b("Beta Tester rewards unlocked! ðŸ§ª","success");break;case"icon":c(u=>{const f=u.playerProfile?a(i({},u.playerProfile),{usedPromoCodes:[...u.playerProfile.usedPromoCodes||[],o],specialIcon:n.icon||"â­",specialTitle:n.title||"Special"}):null;return f&&localStorage.setItem(`playerProfile_${r}`,JSON.stringify(f)),a(i({},u),{playerProfile:f})}),b(`Special icon unlocked: ${n.icon}!`,"success");break;case"title":c(u=>{const f=u.playerProfile?a(i({},u.playerProfile),{usedPromoCodes:[...u.playerProfile.usedPromoCodes||[],o],specialTitle:n.title||"Special"}):null;return f&&localStorage.setItem(`playerProfile_${r}`,JSON.stringify(f)),a(i({},u),{playerProfile:f})}),b(`Special title unlocked: ${n.title}!`,"success");break;default:b("Promo code redeemed!","success")}}),Ie=o=>{c(r=>a(i({},r),{interface:a(i({},r.interface),{lastBuyAmount:o})}))},Ge=o=>({flex:o==="left"?"var(--col-left)":"var(--col-right)",display:"flex",flexDirection:"column",borderRight:o==="left"?"var(--custom-border-width) double var(--border-color)":"none",borderLeft:o==="right"?"var(--custom-border-width) double var(--border-color)":"none",background:"var(--panel-bg)",minWidth:0,transition:"transform 0.8s ease-in-out",transform:P&&e.idleModeEnabled?o==="left"?"translateX(-120%)":"translateX(120%)":"translateX(0)",zIndex:10});return l.jsxs("div",{style:{display:"flex",height:"100dvh",width:"100vw",backgroundColor:"var(--bg-color)",overflow:"hidden",position:"relative",flexDirection:oe?"column":"row"},children:[l.jsx(Ft,{}),P&&e.idleModeEnabled&&l.jsx(oo,{gameState:e}),!oe&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:Ge("left"),children:[l.jsx("div",{style:{display:"flex",borderBottom:"var(--custom-border-width) solid var(--border-color)"},children:l.jsx("button",{className:`tab-btn ${ee==="buildings"?"active":""}`,onClick:()=>we("buildings"),children:"Estates"})}),l.jsx("div",{style:{flex:1,overflowY:"auto",overflowX:"hidden"},children:ee==="buildings"&&l.jsx(qe,{gameState:e,onBuyBuilding:je,onSellBuilding:Me,onSetBuyAmount:Ie,setGameState:c,onStartProject:o=>{var f;const r=((f=e.nationalProjects[o])==null?void 0:f.level)||0;if(r>=ye)return;const n=ve(o,r+1),s=e.buildings[o]||t(0);if(s.lt(10))return;const u=xe[r+1]||0;s.lt(u)||e.gold.lt(n.gold)||(c(m=>a(i({},m),{gold:m.gold.minus(n.gold),nationalProjects:a(i({},m.nationalProjects),{[o]:{level:r+1,active:!1,startTime:0,endTime:0}})})),b("Project upgraded!","success"))}})})]}),l.jsx("div",{style:{flex:"var(--col-center)",display:"flex",flexDirection:"column",position:"relative",borderRight:P&&e.idleModeEnabled?"none":"var(--custom-border-width) double var(--border-color)",minWidth:0,zIndex:5,transition:"border 0.8s"},children:l.jsx(Ye,{gameState:e,gps:Y,onClick:()=>Ce(!1),onEventInteract:Ee,onOpenTavern:()=>ue(!0),onOpenPrestige:()=>re(!0),onOpenSettings:()=>J(!0),onOpenStatistics:()=>fe(!0),onOpenLeaderboard:()=>{me(!0)},onOpenEmpire:()=>ge(!0),onUpgradeClickPower:pe,onUpgradeOffline:he,isIdle:P&&e.idleModeEnabled})}),l.jsxs("div",{style:Ge("right"),children:[l.jsx("div",{style:{display:"flex",borderBottom:"var(--custom-border-width) solid var(--border-color)"},children:l.jsx("button",{className:`tab-btn ${te==="army"?"active":""}`,onClick:()=>rt("army"),children:"Future"})}),l.jsx("div",{style:{flex:1,overflowY:"auto",overflowX:"hidden",WebkitOverflowScrolling:"touch",touchAction:"pan-y",scrollbarWidth:"thin",scrollbarColor:"var(--accent-color) transparent"},children:te==="army"&&l.jsx(Ze,{gameState:e,onBuyTowerFloor:()=>{const o=ae(e.infiniteTowerLevel||0);e.darkMatterGold.gte(o)&&(c(r=>a(i({},r),{darkMatterGold:r.darkMatterGold.minus(o),infiniteTowerLevel:(r.infiniteTowerLevel||0)+1,stats:a(i({},r.stats),{infiniteTowerLevel:(r.infiniteTowerLevel||0)+1,darkMatterGold:r.darkMatterGold.minus(o)})})),b("Built another floor of the Infinite Tower! +100% income bonus","success"))}})})]})]}),oe&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",position:"relative",minHeight:0,height:"100%"},children:[R==="buildings"&&l.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:0},children:[l.jsx("div",{style:{display:"flex",borderBottom:"var(--custom-border-width) solid var(--border-color)",flexShrink:0},children:l.jsx("button",{className:"tab-btn active",onClick:()=>{},children:"Estates"})}),l.jsx("div",{className:"scrollable-content",style:{flex:1,overflowY:"auto",overflowX:"hidden",minHeight:0,WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:l.jsx(qe,{gameState:e,onBuyBuilding:je,onSellBuilding:Me,onSetBuyAmount:Ie,setGameState:c,onStartProject:o=>{var f;const r=((f=e.nationalProjects[o])==null?void 0:f.level)||0;if(r>=ye)return;const n=ve(o,r+1),s=e.buildings[o]||t(0);if(s.lt(10))return;const u=xe[r+1]||0;s.lt(u)||e.gold.lt(n.gold)||(c(m=>a(i({},m),{gold:m.gold.minus(n.gold),nationalProjects:a(i({},m.nationalProjects),{[o]:{level:r+1,active:!1,startTime:0,endTime:0}})})),b("Project upgraded!","success"))}})})]}),R==="throne"&&l.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0,height:"100%"},children:l.jsx(Ye,{gameState:e,gps:Y,onClick:()=>Ce(!1),onEventInteract:Ee,onOpenTavern:()=>ue(!0),onOpenPrestige:()=>re(!0),onOpenSettings:()=>J(!0),onOpenStatistics:()=>fe(!0),onOpenLeaderboard:()=>me(!0),onOpenEmpire:()=>ge(!0),onUpgradeClickPower:pe,onUpgradeOffline:he,isIdle:P&&e.idleModeEnabled})}),R==="army"&&l.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",height:"100%",minHeight:0},children:[l.jsx("div",{style:{display:"flex",borderBottom:"var(--custom-border-width) solid var(--border-color)",flexShrink:0},children:l.jsx("button",{className:"tab-btn active",children:"Future"})}),l.jsx("div",{className:"scrollable-content",style:{flex:1,overflowY:"auto",overflowX:"hidden",minHeight:0,WebkitOverflowScrolling:"touch",touchAction:"pan-y"},children:l.jsx(Ze,{gameState:e,onBuyTowerFloor:()=>{const o=ae(e.infiniteTowerLevel||0);e.darkMatterGold.gte(o)&&(c(r=>a(i({},r),{darkMatterGold:r.darkMatterGold.minus(o),infiniteTowerLevel:(r.infiniteTowerLevel||0)+1,stats:a(i({},r.stats),{infiniteTowerLevel:(r.infiniteTowerLevel||0)+1,darkMatterGold:r.darkMatterGold.minus(o)})})),b("Built another floor of the Infinite Tower! +100% income bonus","success"))}})})]})]}),l.jsxs("div",{style:{display:"flex",justifyContent:"space-around",alignItems:"center",height:"60px",backgroundColor:"var(--panel-bg)",borderTop:"var(--custom-border-width) solid var(--border-color)",flexShrink:0},children:[l.jsxs("button",{className:`mobile-nav-btn ${R==="buildings"?"active":""}`,onClick:()=>{Z("light"),ce("buildings")},style:{flex:1,height:"100%",border:"none",backgroundColor:"transparent",fontSize:"12px",color:R==="buildings"?"var(--accent-color)":"var(--text-color)",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"4px",cursor:"pointer"},children:[l.jsx("div",{style:{fontSize:"20px"},children:"ðŸ˜ï¸"}),l.jsx("div",{children:"Estates"})]}),l.jsxs("button",{className:`mobile-nav-btn ${R==="throne"?"active":""}`,onClick:()=>{Z("light"),ce("throne")},style:{flex:1,height:"100%",border:"none",backgroundColor:"transparent",fontSize:"12px",color:R==="throne"?"var(--accent-color)":"var(--text-color)",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"4px",cursor:"pointer"},children:[l.jsx("div",{style:{fontSize:"20px"},children:"ðŸ‘‘"}),l.jsx("div",{children:"Throne"})]}),l.jsxs("button",{className:`mobile-nav-btn ${R==="army"?"active":""}`,onClick:()=>{Z("light"),ce("army")},style:{flex:1,height:"100%",border:"none",backgroundColor:"transparent",fontSize:"12px",color:R==="army"?"var(--accent-color)":"var(--text-color)",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"4px",cursor:"pointer"},children:[l.jsx("div",{style:{fontSize:"20px"},children:"ðŸ‘·"}),l.jsx("div",{children:"Future"})]})]})]}),!(P&&e.idleModeEnabled)&&B&&l.jsxs("div",{className:"achievement-popup",children:[l.jsx("div",{style:{fontSize:"2rem"},children:B.icon}),l.jsxs("div",{children:[l.jsx("div",{style:{fontWeight:"bold",color:"var(--text-color)"},children:"Achievement Unlocked!"}),l.jsx("div",{style:{color:"var(--accent-color)"},children:B.name})]})]}),M&&l.jsx(Wt,{gained:M.gained,effectiveTime:M.effectiveTime,totalTime:M.totalTime,efficiency:M.efficiency,completedProjects:M.completedProjects,currentLevel:M.currentLevel,maxDuration:M.maxDuration,numberFormat:e.numberFormat,onClose:()=>N(null)}),ut&&l.jsx($t,{gameState:e,onClose:()=>ge(!1),onStartProject:o=>{var m;const r=((m=e.nationalProjects[o])==null?void 0:m.level)||0;if(r>=ye)return;const n=ve(o,r+1),s=e.buildings[o]||t(0);if(s.lt(10))return;const u=xe[r+1]||0;if(s.lt(u)||e.gold.lt(n.gold))return;const f=_t();c(p=>a(i({},p),{gold:p.gold.minus(n.gold),nationalProjects:a(i({},p.nationalProjects),{[o]:{level:r,active:!0,startTime:Date.now(),endTime:Date.now()+f*1e3}})})),b("Construction started!","info")},onUpgradeClickPower:pe,onUpgradeOffline:he}),lt&&l.jsx(Ht,{gameState:e,onGamble:(o,r)=>{const n=t(o);c(s=>a(i({},s),{gold:r?s.gold.plus(n):s.gold.minus(n).max(0),stats:a(i({},s.stats),{tavernGamesPlayed:s.stats.tavernGamesPlayed.plus(t(1))})}))},onClose:()=>ue(!1)}),st&&l.jsx(Kt,{gameState:e,onPrestige:wt,onClose:()=>re(!1)}),it&&l.jsx(Jt,{gameState:e,onClose:()=>J(!1),onHardReset:ht,onProgressReset:bt,onSave:yt,onSetTheme:o=>c(r=>a(i({},r),{theme:o})),onSetNumberFormat:o=>c(r=>a(i({},r),{numberFormat:o})),onToggleIdleMode:()=>c(o=>a(i({},o),{idleModeEnabled:!o.idleModeEnabled})),onUpdateInterface:o=>c(r=>a(i({},r),{interface:i(i({},r.interface),o)}))}),ft&&l.jsx(Xt,{gameState:e,onClose:()=>ke(!1),onRedeemPromoCode:St,onBackToSettings:()=>{ke(!1),J(!0)}}),ct&&l.jsx(Vt,{gameState:e,currentGps:Y,currentTotalClicks:e.stats.totalClicks,currentPrestigeClicks:e.stats.currentPrestigeClicks,onClose:()=>fe(!1)}),at&&l.jsx(qt,{onClose:()=>dt(!1)}),Pe&&l.jsx(Yt,{isOpen:Pe,onClose:()=>{Se(!1),k(!0)},onConfirm:xt,gameState:e}),Te&&l.jsx(Qt,{isOpen:Te,onClose:()=>me(!1),playerProfile:e.playerProfile,gameState:e,addToast:b}),Le&&l.jsx(Zt,{isOpen:Le,onClose:()=>gt(!1),onConfirm:Pt,currentName:((De=e.playerProfile)==null?void 0:De.rulerName)||""})]})},ot=document.getElementById("root");if(!ot)throw new Error("Could not find root element to mount to");const no=It.createRoot(ot);no.render(l.jsx(Gt.StrictMode,{children:l.jsx(ro,{})}))});export default lo();
